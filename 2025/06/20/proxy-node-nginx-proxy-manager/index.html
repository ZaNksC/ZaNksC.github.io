<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>【网络】Proxy节点：反代网关 | 乱话三千</title>
<meta name="start-time" content="2025-01-01 00:00:00"><meta name="home-page-content" content="琐碎的日常、肤浅的思考与并不精湛的技术">

<link rel="shortcut icon" href="" type="image/x-icon">
<link rel="icon" href="" type="image/x-icon"><meta name="twikoo-env-id" content="https://zanks-twikoo.netlify.app/.netlify/functions/twikoo">

<link rel="stylesheet" href="/css/about.min.12190c71e56e33e190a889d51bd5b097146d1b0a3ad2bf7586b46b19f497b24e.css" integrity="sha256-EhkMceVuM&#43;GQqInVG9WwlxRtGwo60r91hrRrGfSXsk4=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/announcement.min.4aa56228e8aaec652528ee567a608c64629a0eb2d9de7403daec6ea5e97aa9cc.css" integrity="sha256-SqViKOiq7GUlKO5WemCMZGKaDrLZ3nQD2uxupel6qcw=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/author-info.min.dc87bcd3f028c2dde3ea16d085e5717eeafcd00682a5fcfcc21169e64afe527a.css" integrity="sha256-3Ie80/Aowt3j6hbQheVxfur80AaCpfz8whFp5kr&#43;Uno=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/authors.min.ea4efdff1158f97241ec30e87f98e5c8772e40d1f596ac9c2b9203ad6848ef2c.css" integrity="sha256-6k79/xFY&#43;XJB7DDof5jlyHcuQNH1lqycK5IDrWhI7yw=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/basic.min.70864b4bc207cd7936044034cbd060324a5bd1769be6f781e412fba938a96452.css" integrity="sha256-cIZLS8IHzXk2BEA0y9BgMkpb0Xab5veB5BL7qTipZFI=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/chirp.min.314185ce937fdc2ac73b2371ad3043871b66d141b84ca190826ae17afbce299c.css" integrity="sha256-MUGFzpN/3CrHOyNxrTBDhxtm0UG4TKGQgmrhevvOKZw=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/comments.min.e4171beb72736744a3f6c50c2b4fdfeef88e2a56c8a4b8ef3615e98ef2e23dc6.css" integrity="sha256-5Bcb63JzZ0Sj9sUMK0/f7viOKlbIpLjvNhXpjvLiPcY=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/copyright.min.cc055a71e31b212da911bb0f8acdcab692717a022a831e57e3027a2736425459.css" integrity="sha256-zAVaceMbIS2pEbsPis3KtpJxegIqgx5X4wJ6JzZCVFk=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/friends.min.86e876c797fe282e0dcac6cefcc90599f5280368e3310615fa98622e587d58be.css" integrity="sha256-huh2x5f&#43;KC4NysbO/MkFmfUoA2jjMQYV&#43;phiLlh9WL4=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/goto-next.min.21d9b5d78d24a69c6f8bd2ca32bb0013392be06c27a077386c4906a515b1fb90.css" integrity="sha256-Idm1140kppxvi9LKMrsAEzkr4GwnoHc4bEkGpRWx&#43;5A=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/header.min.f5db73278da983c7a2115f617aa37c62bcea954189500dd97c03196296fd3968.css" integrity="sha256-9dtzJ42pg8eiEV9heqN8YrzqlUGJUA3ZfAMZYpb9OWg=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/home.min.199221816490e0948ddacd2bb28fd264331abc8fc80781ed3855a80b781f6cfc.css" integrity="sha256-GZIhgWSQ4JSN2s0rso/SZDMavI/IB4HtOFWoC3gfbPw=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/last-update.min.d1b9fb9c3f03856abc897283724600e0ae25d4fdd9e87081befb3b8b5b7bf8b7.css" integrity="sha256-0bn7nD8DhWq8iXKDckYA4K4l1P3Z6HCBvvs7i1t7&#43;Lc=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/list-post.min.369fcddcc2fda2b18ce670202e78a3a3fe0d158fff89a7d128842ff9bd36af39.css" integrity="sha256-Np/N3ML9orGM5nAgLnijo/4NFY//iafRKIQv&#43;b02rzk=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/list.min.ba6eece6ea29ba755d3d4989c14ff1c730c9a68122468f841675efd689ad72f7.css" integrity="sha256-um7s5uopunVdPUmJwU/xxzDJpoEiRo&#43;EFnXv1omtcvc=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/main.min.22aa6a071c63e010d1cd98165743c8f42a80a24fb0fc48bb9104b54f29e6a3db.css" integrity="sha256-IqpqBxxj4BDRzZgWV0PI9CqAok&#43;w/Ei7kQS1Tynmo9s=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/md.min.0e3575794d5fa5e3232de59e26050171a86cece8310668ab3836f12010826b17.css" integrity="sha256-DjV1eU1fpeMjLeWeJgUBcahs7OgxBmirODbxIBCCaxc=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/menu.min.f38cd69111b7a83bdbca2c301f67c54bc7847378e4f524d091025ff147f29146.css" integrity="sha256-84zWkRG3qDvbyiwwH2fFS8eEc3jk9STQkQJf8UfykUY=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/page.min.327faf4b56f53f360d59c9ec4ebc3e459780d6081f93e8d2632a521705b75684.css" integrity="sha256-Mn&#43;vS1b1PzYNWcnsTrw&#43;RZeA1ggfk&#43;jSYypSFwW3VoQ=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/post-meta.min.dec6e55761a93b5cb004630e45bf1f35f3cbd5bf1be9627f2300be018b79d7f2.css" integrity="sha256-3sblV2GpO1ywBGMORb8fNfPL1b8b6WJ/IwC&#43;AYt51/I=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/single.min.59933d741011074641c3278b0e021e880d703e9906ed81463edb7c34e3b06023.css" integrity="sha256-WZM9dBARB0ZBwyeLDgIeiA1wPpkG7YFGPtt8NOOwYCM=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/site-info.min.99f7ea72487d21367994413cf28009c799038172b9fa27de1e78d6bc025a1baa.css" integrity="sha256-mffqckh9ITZ5lEE88oAJx5kDgXK5&#43;ifeHnjWvAJaG6o=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/square-stamp.min.052f66f4444fd26d1d4f65b608c278bab47207595010a6d51b0d5cfc318009a3.css" integrity="sha256-BS9m9ERP0m0dT2W2CMJ4urRyB1lQEKbVGw1c/DGACaM=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/tags.min.01948be497fb7f68e7327070ba65a644286938095ca3199e4079a649e96f87f4.css" integrity="sha256-AZSL5Jf7f2jnMnBwumWmRChpOAlcoxmeQHmmSelvh/Q=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/terms-tags.min.330c7f245c68d21a893b6a4e9cb468f37bc9cc8495224e89a38c384e545aa25d.css" integrity="sha256-Mwx/JFxo0hqJO2pOnLRo83vJzISVIk6Jo4w4TlRaol0=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/theme-default.min.e5b67e6744721c1a4c5c500a49c71ce7ea1b67d6c46fa4afd7e5d483e5a4af77.css" integrity="sha256-5bZ&#43;Z0RyHBpMXFAKSccc5&#43;obZ9bEb6Sv1&#43;XUg&#43;Wkr3c=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/toc.min.97935001d1c901f611b9a21cb1e0b103af62ffd1c8dca20518900dacb2af7968.css" integrity="sha256-l5NQAdHJAfYRuaIcseCxA69i/9HI3KIFGJANrLKveWg=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/third-party/swiper-bundle.min.min.5983c13a687fefa51ed8c90899af9d232c7cf661ce4b8227d98b68044c7b43d5.css" integrity="sha256-WYPBOmh/76Ue2MkIma&#43;dIyx89mHOS4In2YtoBEx7Q9U=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/shortcode/admonition.min.f4a992ecbdf33356f956629da0ed1e6a1c3700c23e901f83fd25070b58ed62ad.css" integrity="sha256-9KmS7L3zM1b5VmKdoO0eahw3AMI&#43;kB&#43;D/SUHC1jtYq0=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/shortcode/card-list.min.d048865f3bf7e4ff9ef02b02bf00eaa9f452e4344b9ed9a76b8da30f346cffc7.css" integrity="sha256-0EiGXzv35P&#43;e8CsCvwDqqfRS5DRLntmna42jDzRs/8c=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/shortcode/cat-food.min.937b857e1e174f486230b88c24ce68adae93fe5b7100f9ef094f56630f8ae269.css" integrity="sha256-k3uFfh4XT0hiMLiMJM5ora6T/ltxAPnvCU9WYw&#43;K4mk=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/shortcode/creditcard.min.68d27bb753acf07f32d5e78b500b9be38c2996551cc64f64c5733249d4f02e95.css" integrity="sha256-aNJ7t1Os8H8y1eeLUAub44wpllUcxk9kxXMySdTwLpU=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/shortcode/device.min.9133cc45f7642818223058db18b500a37c8207f6e01cc359a17e0c0fcb9eb7b6.css" integrity="sha256-kTPMRfdkKBgiMFjbGLUAo3yCB/bgHMNZoX4MD8uet7Y=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/shortcode/git.min.250fa59fcc440a058ca2862e8d3e4eebfdcb7e7de571b796d8d87b6b7637d992.css" integrity="sha256-JQ&#43;ln8xECgWMooYujT5O6/3Lfn3lcbeW2Nh7a3Y32ZI=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/shortcode/link.min.6fdde88b1fa21ebc3f83181eb89afaa3c63bc61806c0aae2c28edfc6eaab4f2e.css" integrity="sha256-b93oix&#43;iHrw/gxgeuJr6o8Y7xhgGwKriwo7fxuqrTy4=" crossorigin="anonymous"><link rel="preload" href="/css/theme/github.min.1bebd3859a97fa10cb230aa9eba85751895a0c2221711d299dd7d9807c546d65.css" as="style">
<link rel="preload" href="/css/theme/github-dark.min.a2843de5d40c4736eecaaad3cc67aa464147149e3051f1fb8328d98364348a33.css" as="style">
<link rel="preload" href="/css/theme/twikoo-github.min.fb310c5b466f7eede3bb7899dd4070b393ffe16e70ba9eb3ccf7af3818b50b6f.css" as="style">
<link rel="preload" href="/css/theme/twikoo-github-dark.min.16f26cba66c515e1b0052f72653bdd21499881d8d792db895cb914dd99992ecb.css" as="style">

<link rel="stylesheet" href="/css/theme/github.min.1bebd3859a97fa10cb230aa9eba85751895a0c2221711d299dd7d9807c546d65.css" id="hl-github-css" media="all">
<link rel="stylesheet" href="/css/theme/github-dark.min.a2843de5d40c4736eecaaad3cc67aa464147149e3051f1fb8328d98364348a33.css" id="hl-github-dark-css" media="all" disabled>
<link rel="stylesheet" href="/css/theme/twikoo-github.min.fb310c5b466f7eede3bb7899dd4070b393ffe16e70ba9eb3ccf7af3818b50b6f.css" id="twikoo-github-css" media="all">
<link rel="stylesheet" href="/css/theme/twikoo-github-dark.min.16f26cba66c515e1b0052f72653bdd21499881d8d792db895cb914dd99992ecb.css" id="twikoo-github-dark-css" media="all" disabled>




<script src="/js/bundle.82b80aadc8fc135a902b9ab3a87c07ac78d195c61ca975dd7357706c8abbb0ff.js" integrity="sha256-grgKrcj8E1qQK5qzqHwHrHjRlcYcqXXdc1dwbIq7sP8=" crossorigin="anonymous"></script>












<link rel="stylesheet" href="/css/third-party/swiper-bundle.min.css" />
<script src="/js/third-party/swiper-bundle.min.js"></script>


<script src="https://cdn.jsdelivr.net/npm/typeit@6.1.1/dist/typeit.min.js"></script>


<script src="https://d3js.org/d3.v7.min.js"></script>
<script src="https://unpkg.com/cal-heatmap/dist/cal-heatmap.min.js"></script>
<link rel="stylesheet" href="https://unpkg.com/cal-heatmap/dist/cal-heatmap.css" />


<script src="/js/third-party/wordcloud2.js"></script>


<script src="https://kit.fontawesome.com/4f00e1f6e6.js" crossorigin="anonymous"></script>



<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/twikoo@1.6.40/dist/twikoo.all.min.js"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-420MPRSEER"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-420MPRSEER');
</script>

</head>
<body>
  <header>
    <div class="header-container">
    <div class="header-title-container" >
        <a class="site-title-container" href="/">
            <div class="header-icon">
                <img class="header-icon" src="/assets/favicon.ico">
            </div>
            <div class="header-title">乱话三千</div>
        </a>
        
        <div class="toggle" id="toggle-button">
            <div id="light-mode-icon" class="toggle-icon active"><span class="inline-svg" ><?xml version="1.0" encoding="UTF-8"?><svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill="currentColor" d="M28.0527 4.41085C22.5828 5.83695 18.5455 10.8106 18.5455 16.7273C18.5455 23.7564 24.2436 29.4545 31.2727 29.4545C37.1894 29.4545 42.1631 25.4172 43.5891 19.9473C43.8585 21.256 44 22.6115 44 24C44 35.0457 35.0457 44 24 44C12.9543 44 4 35.0457 4 24C4 12.9543 12.9543 4 24 4C25.3885 4 26.744 4.14149 28.0527 4.41085Z" fill="none" stroke="#333" stroke-width="4" stroke-linejoin="round"/></svg>
</span></div>
            <div id="dark-mode-icon" class="toggle-icon"><span class="inline-svg" ><?xml version="1.0" encoding="UTF-8"?><svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill="currentColor" d="M24 37C31.1797 37 37 31.1797 37 24C37 16.8203 31.1797 11 24 11C16.8203 11 11 16.8203 11 24C11 31.1797 16.8203 37 24 37Z" fill="none" stroke="#333" stroke-width="4" stroke-linejoin="round"/><path fill="currentColor" d="M24 6C25.3807 6 26.5 4.88071 26.5 3.5C26.5 2.11929 25.3807 1 24 1C22.6193 1 21.5 2.11929 21.5 3.5C21.5 4.88071 22.6193 6 24 6Z" fill="#333"/><path fill="currentColor" d="M38.5 12C39.8807 12 41 10.8807 41 9.5C41 8.11929 39.8807 7 38.5 7C37.1193 7 36 8.11929 36 9.5C36 10.8807 37.1193 12 38.5 12Z" fill="#333"/><path fill="currentColor" d="M44.5 26.5C45.8807 26.5 47 25.3807 47 24C47 22.6193 45.8807 21.5 44.5 21.5C43.1193 21.5 42 22.6193 42 24C42 25.3807 43.1193 26.5 44.5 26.5Z" fill="#333"/><path fill="currentColor" d="M38.5 41C39.8807 41 41 39.8807 41 38.5C41 37.1193 39.8807 36 38.5 36C37.1193 36 36 37.1193 36 38.5C36 39.8807 37.1193 41 38.5 41Z" fill="#333"/><path fill="currentColor" d="M24 47C25.3807 47 26.5 45.8807 26.5 44.5C26.5 43.1193 25.3807 42 24 42C22.6193 42 21.5 43.1193 21.5 44.5C21.5 45.8807 22.6193 47 24 47Z" fill="#333"/><path fill="currentColor" d="M9.5 41C10.8807 41 12 39.8807 12 38.5C12 37.1193 10.8807 36 9.5 36C8.11929 36 7 37.1193 7 38.5C7 39.8807 8.11929 41 9.5 41Z" fill="#333"/><path fill="currentColor" d="M3.5 26.5C4.88071 26.5 6 25.3807 6 24C6 22.6193 4.88071 21.5 3.5 21.5C2.11929 21.5 1 22.6193 1 24C1 25.3807 2.11929 26.5 3.5 26.5Z" fill="#333"/><path fill="currentColor" d="M9.5 12C10.8807 12 12 10.8807 12 9.5C12 8.11929 10.8807 7 9.5 7C8.11929 7 7 8.11929 7 9.5C7 10.8807 8.11929 12 9.5 12Z" fill="#333"/></svg>
</span></div>
        </div>
    </div>
    <div class="header-center-container">
        <div class="header-center-board">
            <span id="header-center-text"></span>
        </div>
        <div class="header-center-typeit-board">
            <span id="header-type-it"></span>
        </div>
    </div>
    <div class="mobile-menu-btn" aria-label="导航菜单">☰</div>
    <div class="nav-container">
        
  <nav>
    <ul>
    
    <li>
      <a href="/posts/">📖 文章</a>
        <ul>
    <li>
      <a href="/tags/">🏷️ 标签</a>
    </li>
    <li>
      <a href="/categories/">🔖 分类</a>
    </li>
        </ul>
    </li>
    <li>
      <a href="/friends/">🤝 友链</a>
    </li>
    <li>
      <a href="/chirp/">💬 碎碎念</a>
    </li>
    <li>
      <a href="/about/">😾 关于</a>
    </li>
    </ul>
  </nav>

    </div>
</div>

  </header>
  <main>
    






<div class="single-container fund-padding-top">
    
    <div class="single-cover-bg" style="
        background:
        linear-gradient(to bottom, var(--backgroud--mask-alpha80), var(--backgroud--mask-alpha20)),
        url(https://zanks1996-1256221076.cos.ap-shanghai.myqcloud.com//piclistTemp/cover.webp);
        background-repeat: no-repeat;
        background-size: 100% 100%, cover;
        background-position: center, center;">
    </div>
    <div class="post-header">
        <div class="over-title-container">

            
            <div class="square-stamp" style="background-image: url('/images/default/square-stamp.webp');">
    <span>📝 原创</span>
</div>
        </div>
        <div class="title">
            【网络】Proxy节点：反代网关
        </div>
        <div class="meta fund-secondary">
            <div class="meta-info">
                
<div class="post-meta-item" id="publish-date">
    <div class="post-meta-item-header" id="update-date"><span class="inline-svg" ><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 48 48"><path fill="currentColor" stroke-linejoin="round" stroke-width="4" stroke="#333" d="M5 19h38v21a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V19ZM5 9a2 2 0 0 1 2-2h34a2 2 0 0 1 2 2v10H5V9Z" data-follow-stroke="#333"/><path fill="currentColor" stroke-linejoin="round" stroke-linecap="round" stroke-width="4" stroke="#333" d="M16 4v8M32 4v8M28 34h6M14 34h6M28 26h6M14 26h6" data-follow-stroke="#333"/></svg>
</span>发布于:
    </div>
    <span>
        2025-06-20
    </span>
</div>

<div class="post-meta-item">
    <div class="post-meta-item-header"><span class="inline-svg" ><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 48 48"><path fill="currentColor" stroke-linejoin="round" stroke-linecap="round" stroke-width="4" stroke="#333" d="M24 44c11.046 0 20-8.954 20-20S35.046 4 24 4 4 12.954 4 24s8.954 20 20 20Z" data-follow-stroke="#333"/><path fill="currentColor" stroke-linejoin="round" stroke-linecap="round" stroke-width="4" stroke="#333" d="M33.542 27c-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7v6M33.542 15v6c-1.274-4.057-5.064-7-9.542-7-4.477 0-8.268 2.943-9.542 7" data-follow-stroke="#333"/></svg>
</span>更新于:
    </div><span>
        2025-06-20
    </span>
</div>



            </div>
            
<div class="authors">
    <span><span class="inline-svg" ><?xml version="1.0" encoding="UTF-8"?><svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#icon-6ffb2852696ccc)"><path fill="currentColor" d="M30.9995 8.99902L38.9995 16.999" stroke="#333" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/><path fill="currentColor" d="M7.99953 31.999L35.9994 4L43.9995 11.999L15.9995 39.999L5.99951 41.999L7.99953 31.999Z" stroke="#333" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/><path fill="currentColor" d="M30.9995 8.99902L38.9995 16.999" stroke="#333" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/><path fill="currentColor" d="M8.99951 31.999L15.9995 38.999" stroke="#333" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/><path fill="currentColor" d="M12.9995 34.999L34.9995 12.999" stroke="#333" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/></g><defs><clipPath id="icon-6ffb2852696ccc"><rect width="48" height="48" fill="#333"/></clipPath></defs></svg>
</span>作者: </span>
    <div>
        
        <span>Za_Nks</span>
    </div>
</div>

            <div class="meta-info">
                
                <a href="/tags/homelab">#Homelab</a>
                
                <a href="/tags/istoreos">#Istoreos</a>
                
                <a href="/tags/nginx">#Nginx</a>
                
                <a href="/tags/%E7%BD%91%E7%BB%9C">#网络</a>
                
            </div>
        </div>
    </div>
    <div class="main-container">
        <div class="left-container fund-border">
            <div class="post-container" id="md-container">
                <div class="post-content">

                    <h2 id="前言">前言</h2>
<p>由于自己家里部署的服务越来越多，即便是曾经凭借记忆就可以随意出入各种服务的我，也逐渐感觉到了压力倍增，所以就再次动了搭建一个统一反向代理的心思。至于为什么是再次，因为曾经动手搭建过，失败了。然后在网上闲逛看到了某大佬分享自家的Homelab架构，我又觉得我行了。重要参考文档：<a href="https://www.tangyuecan.com/2024/12/20/%E6%88%91%E4%BB%AC%E4%B8%8D%E6%90%9Enas-%E6%88%91%E4%BB%AC%E6%90%9Ehomelab">我们不搞NAS，我们搞HomeLab！</a></p>
<h2 id="需求">需求</h2>
<p>首先，明确一下改造的目的。最核心也是最原始的需求，我需要的是一个统一的反向代理服务以便我可以通过更利于人类记忆的方式来访问家中的服务。由此延伸出一个用户体验相关的需求，我希望在内外网具有一致性的访问体验。还有一些安全上的需求，比如只开放高位端口且全链路支持Https。</p>
<p>以上的描述角度，更多的是站在用户角度去描述了一下本次的目标。那么现在整理一下需求，用更偏向技术的角度来梳理一下（在我的习惯中，我在思考到这一步时，会粗略的给出一些技术解决方案，以便我快速判断是否具有可行性）：</p>
<ul>
<li>统一的反向代理服务：Nginx，使用Nginx Proxy Manager提升运维管理体验</li>
<li>内外网一致性的访问体验： 使用域名访问</li>
<li>全自动Https证书管理： <code>acme.sh</code> 自动续签</li>
</ul>
<h2 id="方案">方案</h2>
<p>基本上想清楚怎么做之后，审视一下家里目前的设备与网络构造，用于确定如何改造，改造过程中是否有其他衍生需求。在我目前的家庭网络环境中，家里是有一台iStoreOs作为旁路由（虽然被大佬狠狠抨击，但是我依然用了旁路由），上面部署了一些服务来支持当前的诉求。在iStoreOs这台设备中，我常用的服务包括:</p>
<ul>
<li>TailScale: 用于虚拟组网，带有子网，提供外网访问的统一入口</li>
<li>Lucky： DDNS与端口转发，目前用处不大，已经被TailScale取代</li>
<li>🐱： 懂的都懂，不过我现在还是客户端居多，没有实际用起来，所以本次暂时不考虑了</li>
</ul>
<p>下面就是基于Nginx Proxy Manager作为统一反向代理中心的设计方案。</p>
<div class="details admonition info open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-info-circle fa-fw"></i>一些思考<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">这个方案其实还是没办法满足我的完整需求，原先在我的设想中，某些服务我只想开放给内网坏境，但是这种部署模式下，所有请求过了docker的网桥，导致IP都变为了网桥的IP，无法按IP控制访问了。后来我尝试了裸机直接部署Nginx来限制内网IP访问，但是由于我IPv6提供的服务，在家里也是直接解析出v6地址，用公网IP直连的。其实是可以考虑将v6前缀作为限制条件写入配置中的，家里向运营商要了固定的公网v6前缀。但是考虑到后续迁移的维护，和未来不一定有固定前缀的场景，就放弃了。实际上，我的数据都做了备份，而且攻击的成本也很高，我自己的个人数据价值对于他人来说也非常的低，远没有我想象的那么危险，设定好一个比较复杂的密码就可以了。在某大厂工作后留下这种思维定式，不知道算好还是坏，做事情前总是过度设计和考虑非必要的极端场景，也许对于大型项目而言是优秀的架构思维，但是对于需要快速实践的项目反而成为了掣肘。</div>
        </div>
    </div>
<p>我设想了一个初步方案。只需要在iStoreOs中部署 Nginx Proxy Manager（包含了自动证书更新）。至于统一的内外网体验，通过域名方案解决，在内网设置一个dns解析记录，将内网服务的域名都解析到iStoreOs的节点IP上，外网则通过DDNS发布动态域名解析。</p>
<p>由于家用带宽的入站问题，nginx直接使用高位端口提供服务，端口转发可以关闭大部分的转发通道。最终的方案如下：</p>
<p><div class="post-img-view">
    <a data-fancybox="gallery" href="https://zanks1996-1256221076.cos.ap-shanghai.myqcloud.com//piclistTemp/design.webp">
        <img src="https://zanks1996-1256221076.cos.ap-shanghai.myqcloud.com//piclistTemp/design.webp" alt="design|700x492"  />
    </a>
</div></p>
<ul>
<li>IPv4的访问链路
<ul>
<li>内网： 在内网中，设置一个内网DNS服务器，将 泛域名 解析到ProxyNode上，内网的IPv4就会直接用内网ip进行访问</li>
<li>外网： 我实际使用时外网是不提供IPv4的访问途径的。如果要提供会比较复杂（其实我也还没太搞明白），需要在TailScale的MagicDNS上设置SplitDNS，将某些域名的解析发送到ProxyNode的DNS服务器上，解析出内网IP进行访问（访问链路走的是TailScale，如果是直连模式应该还是v6访问，意义不大；如果是转发模式可能走的是v4，但是很卡，意义也不大）</li>
</ul>
</li>
<li>IPv6的访问链路：IPv6的链路就很直接，内外网是统一的方式，直接中公网的DNS解析到ProxyNode的公网IPv6地址，然后直连</li>
</ul>
<p>IPv6的统一，一度让我想把IPv4的服务关掉，毕竟我大部分时间也确实都在用IPv6。</p>
<h2 id="实施">实施</h2>
<p>本来是打算把iStoreOS全部铲掉重新装其他系统的，毕竟上面有很多存储类的东西我不用。但是考虑到用docker-compse安装NPM（其实这个我反而更希望裸机部署），我就把他保留了下来，并且DDNS之类的都可以直接复用，就不重新搭建了。</p>
<h3 id="nginx-proxy-manager">Nginx Proxy Manager</h3>
<h4 id="docker-compose安装">Docker Compose安装</h4>
<p>登录iStoreOs的命令行界面，执行以下命令安装Docker Compose</p>



<div class="fund-code-container">
    <div class="fund-code-header">
        <div class="fund-code-header-left-container">
            <svg id="code-lights" xmlns="http://www.w3.org/2000/svg" version="1.1"  x="0px" y="0px" viewBox="0 0 450 130">
                <ellipse cx="65" cy="65" rx="50" ry="52" stroke="rgb(220,60,54)" stroke-width="2" fill="rgb(237,108,96)"/>
                <ellipse cx="225" cy="65" rx="50" ry="52"  stroke="rgb(218,151,33)" stroke-width="2" fill="rgb(247,193,81)"/>
                <ellipse cx="385" cy="65" rx="50" ry="52"  stroke="rgb(27,161,37)" stroke-width="2" fill="rgb(100,200,86)"/>
            </svg>
        </div>
        <div class="fund-code-header-mid-container">
            
            [ text ]
        </div>
        <div class="fund-code-header-right-container">
            <div class="fold-btn open">
                <span class="inline-svg" ><?xml version="1.0" encoding="UTF-8"?><svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill="currentColor" d="M19 12L31 24L19 36" stroke="#333" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/></svg>
</span>
            </div>

            <div class="copy-btn">
                <span class="inline-svg" ><?xml version="1.0" encoding="UTF-8"?><svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill="currentColor" d="M13 12.4316V7.8125C13 6.2592 14.2592 5 15.8125 5H40.1875C41.7408 5 43 6.2592 43 7.8125V32.1875C43 33.7408 41.7408 35 40.1875 35H35.5163" stroke="#333" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/><path fill="currentColor" d="M32.1875 13H7.8125C6.2592 13 5 14.2592 5 15.8125V40.1875C5 41.7408 6.2592 43 7.8125 43H32.1875C33.7408 43 35 41.7408 35 40.1875V15.8125C35 14.2592 33.7408 13 32.1875 13Z" fill="none" stroke="#333" stroke-width="4" stroke-linejoin="round"/></svg>
</span>
            </div>
        </div>
    </div>
    <div class="fund-code-content">
        <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="ln">1</span><span class="cl">mkdir -p ~/.docker/cli-plugins
</span></span><span class="line"><span class="ln">2</span><span class="cl">curl -SL https://github.com/docker/compose/releases/download/v2.24.5/docker-compose-linux-x86_64 -o ~/.docker/cli-plugins/docker-compose
</span></span><span class="line"><span class="ln">3</span><span class="cl">chmod +x ~/.docker/cli-plugins/docker-compose
</span></span><span class="line"><span class="ln">4</span><span class="cl"># 版本验证
</span></span><span class="line"><span class="ln">5</span><span class="cl">docker compose version
</span></span><span class="line"><span class="ln">6</span><span class="cl"># 输出: Docker Compose version v2.24.5</span></span></code></pre></div>
    </div>
</div><h4 id="npm安装">NPM安装</h4>
<p>使用docker-compose安装npm，创建docker-compose文件，输入以下内容。</p>
<div class="details admonition warning open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-exclamation-triangle fa-fw"></i>重要提示<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">注意端口，不要设置为80，会和iStoreOs的界面有冲突</div>
        </div>
    </div>



<div class="fund-code-container">
    <div class="fund-code-header">
        <div class="fund-code-header-left-container">
            <svg id="code-lights" xmlns="http://www.w3.org/2000/svg" version="1.1"  x="0px" y="0px" viewBox="0 0 450 130">
                <ellipse cx="65" cy="65" rx="50" ry="52" stroke="rgb(220,60,54)" stroke-width="2" fill="rgb(237,108,96)"/>
                <ellipse cx="225" cy="65" rx="50" ry="52"  stroke="rgb(218,151,33)" stroke-width="2" fill="rgb(247,193,81)"/>
                <ellipse cx="385" cy="65" rx="50" ry="52"  stroke="rgb(27,161,37)" stroke-width="2" fill="rgb(100,200,86)"/>
            </svg>
        </div>
        <div class="fund-code-header-mid-container">
            
            [ text ]
        </div>
        <div class="fund-code-header-right-container">
            <div class="fold-btn open">
                <span class="inline-svg" ><?xml version="1.0" encoding="UTF-8"?><svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill="currentColor" d="M19 12L31 24L19 36" stroke="#333" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/></svg>
</span>
            </div>

            <div class="copy-btn">
                <span class="inline-svg" ><?xml version="1.0" encoding="UTF-8"?><svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill="currentColor" d="M13 12.4316V7.8125C13 6.2592 14.2592 5 15.8125 5H40.1875C41.7408 5 43 6.2592 43 7.8125V32.1875C43 33.7408 41.7408 35 40.1875 35H35.5163" stroke="#333" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/><path fill="currentColor" d="M32.1875 13H7.8125C6.2592 13 5 14.2592 5 15.8125V40.1875C5 41.7408 6.2592 43 7.8125 43H32.1875C33.7408 43 35 41.7408 35 40.1875V15.8125C35 14.2592 33.7408 13 32.1875 13Z" fill="none" stroke="#333" stroke-width="4" stroke-linejoin="round"/></svg>
</span>
            </div>
        </div>
    </div>
    <div class="fund-code-content">
        <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="ln"> 1</span><span class="cl">version: &#34;3&#34;
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">services:
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">  npm:
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    image: jc21/nginx-proxy-manager:2.12.3
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    container_name: nginx-proxy-manager
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    restart: unless-stopped
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    ports:
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">      - &#34;8080:80&#34;       # HTTP 端口，供自动签发证书的验证使用，也可反代 HTTP 服务
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">      - &#34;8443:443&#34;     # HTTPS 端口，提供安全访问
</span></span><span class="line"><span class="ln">10</span><span class="cl">      - &#34;81:81&#34;       # NPM Web UI 管理端口
</span></span><span class="line"><span class="ln">11</span><span class="cl">    volumes:
</span></span><span class="line"><span class="ln">12</span><span class="cl">      - /root/docker/nginx-proxy-manager/data:/data                  # 配置文件和数据库持久化
</span></span><span class="line"><span class="ln">13</span><span class="cl">      - /root/docker/nginx-proxy-manager/letsencrypt:/etc/letsencrypt </span></span></code></pre></div>
    </div>
</div><p>保存后在目录中执行 <code>docker compose up -d</code> 启动容器，可以在iStoreOs的界面中看到有一个容器在运行，也说明启动成功。</p>
<h4 id="npm配置">NPM配置</h4>
<p>在浏览器中数据iStoreOs的ip+81端口，进入npm的管理界面。首次登录使用默认的邮箱和密码，注册账号修改为自己的信息就可以开始配置了。</p>
<p>添加SSL证书，使用对应的域名服务商的API即可。</p>
<div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw"></i>友情提示<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">出现Inactive状态先不要慌，这只是未使用而已。</div>
        </div>
    </div>
<p>然后就是愉快反代服务，按需添加即可。一般我都会勾选上强制Https。</p>
<div class="copyright">
    <hr>
    <blockquote>
        <p>本文为原创内容，版权归作者所有。如需转载，请在文章中声明本文标题及链接。</p>
        <p>文章标题：【网络】Proxy节点：反代网关 —— [Za_Nks]</p>
        <p>文章链接：<a href="https://www.zanks.link/2025/06/20/proxy-node-nginx-proxy-manager/" target="_blank">https://www.zanks.link/2025/06/20/proxy-node-nginx-proxy-manager/</a></p>
        <p>许可协议：<a href="https://creativecommons.org/licenses/by-nc/4.0/deed.zh-hans" target="_blank">CC BY-NC 4.0</a></p>
    </blockquote>
</div></div>
                <div class="post-footer">
                    <div class="fund-divider fund-title pn-text">
                        <span>看看其他文章</span>
                    </div>
                    <div class="post-nav">
                        
                        <a class="nav-block prev" href="/2025/06/15/ungree-dxp4800/">
                            <span class="arrow">《 </span>
                            <div class="pn-content-container">
                                <span>绿联DXP4800开箱体验</span>
                            </div>
                        </a>
                        

                        
                        <a class="nav-block next" href="/2025/07/01/hugo-shortcode-exp/">
                            <div class="pn-content-container">
                                <span>【Hugo】本站已实现ShortCode展示及用法</span>
                            </div>
                            <span class="arrow"> 》</span>
                        </a>
                        
                    </div>



                    <div class="comments">
                            
                            
<div class="comments-title" id="comments-title">
    <div class="fund-divider fund-title">
        <span>欢迎来到评论区</span>
    </div>
    <p>感谢您的耐心阅读！如需交流，请留个评论吧！ </p>
</div>

<div>
    <div id="tcomment"></div>
</div>

                    </div>
                </div>
            </div>
        </div>

        <div class="right-container">
            <div class="author-info-container">
    <div class="author-info fund-border">
    <div class="swiper" id="author-info-swiper">
        <div class="swiper-wrapper">
            <div class="swiper-slide">
                        <div class="one-author-container">
                            <a class="avatar" href="/about">
                                <img  src="/images/default/avatar.jpg">
                            </a>
                            <div class="author-name fund-title">Za_Nks</div>
                            <div class="author-summary">剥龙虾大王、剥柚子也还可以</div>
                            
                        </div>
                    </div>
            
        </div>
        
        <div class="swiper-pagination"></div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        new Swiper('#author-info-swiper', {
            direction: 'horizontal',
            loop: true,
            pagination: {
                el: '.swiper-pagination',
                clickable: true,
            },
            autoplay: {
                delay: 3000, 
            },
            observer: true, 
            observeParents: true, 
            on: {
                touchEnd: function () {
                    setTimeout(() => {
                        this.autoplay.start();
                    }, 500);
                },
            },
        });
    });
</script>
</div>
<div class="announcements-container">
    <div class="fund-block fund-border">
    <div class="fund-title block-title">
        <div class="fund-divider">
            <span>📢 公告</span>
        </div>
    </div>
    <div class="swiper announcement" id="announcement-swiper">
        <div class="swiper-wrapper"><div class="swiper-slide">
                <div class="announcement-content-container">
                    <div class="announcement-time fund-secondary">
                        <span class="inline-svg" ><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 48 48"><path fill="currentColor" stroke-linejoin="round" stroke-width="4" stroke="#333" d="M5 19h38v21a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V19ZM5 9a2 2 0 0 1 2-2h34a2 2 0 0 1 2 2v10H5V9Z" data-follow-stroke="#333"/><path fill="currentColor" stroke-linejoin="round" stroke-linecap="round" stroke-width="4" stroke="#333" d="M16 4v8M32 4v8M28 34h6M14 34h6M28 26h6M14 26h6" data-follow-stroke="#333"/></svg>
</span>
                        <span>
                            发布于 2025-05-20 00:00:00
                        </span>
                    </div>
                    <div class="announcement-content">
                        本站已加入《开往》与《异次元之旅》，如需访问其他联盟成员，可以通过 【不期而遇】 板块进行穿梭
                    </div>
                </div>
            </div><div class="swiper-slide">
                <div class="announcement-content-container">
                    <div class="announcement-time fund-secondary">
                        <span class="inline-svg" ><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 48 48"><path fill="currentColor" stroke-linejoin="round" stroke-width="4" stroke="#333" d="M5 19h38v21a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V19ZM5 9a2 2 0 0 1 2-2h34a2 2 0 0 1 2 2v10H5V9Z" data-follow-stroke="#333"/><path fill="currentColor" stroke-linejoin="round" stroke-linecap="round" stroke-width="4" stroke="#333" d="M16 4v8M32 4v8M28 34h6M14 34h6M28 26h6M14 26h6" data-follow-stroke="#333"/></svg>
</span>
                        <span>
                            发布于 2025-04-17 00:00:00
                        </span>
                    </div>
                    <div class="announcement-content">
                        已切换至国内服务器，完成ICP及公安网备案，后续将考虑通过CDN等技术加速访问效率核IPv6支持，目前IPv6由Github Pages支持
                    </div>
                </div>
            </div><div class="swiper-slide">
                <div class="announcement-content-container">
                    <div class="announcement-time fund-secondary">
                        <span class="inline-svg" ><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 48 48"><path fill="currentColor" stroke-linejoin="round" stroke-width="4" stroke="#333" d="M5 19h38v21a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V19ZM5 9a2 2 0 0 1 2-2h34a2 2 0 0 1 2 2v10H5V9Z" data-follow-stroke="#333"/><path fill="currentColor" stroke-linejoin="round" stroke-linecap="round" stroke-width="4" stroke="#333" d="M16 4v8M32 4v8M28 34h6M14 34h6M28 26h6M14 26h6" data-follow-stroke="#333"/></svg>
</span>
                        <span>
                            发布于 2025-02-25 00:00:00
                        </span>
                    </div>
                    <div class="announcement-content">
                        近期将进行备案，可能会停止服务一段时间，为期15-30天
                    </div>
                </div>
            </div>
        </div>
        
        <div class="swiper-pagination"></div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        new Swiper('#announcement-swiper', {
            direction: 'horizontal',
            loop: true,
            pagination: {
                el: '.swiper-pagination',
                clickable: true,
            },
            autoplay: {
                delay: 5000, 
            },
            observer: true, 
            observeParents: true, 
            on: {
                touchEnd: function () {
                    setTimeout(() => {
                        this.autoplay.start();
                    }, 500);
                },
            },
        });
    });
</script>
</div>

<div class="fund-block fund-border" id="site-info">
    <div class="site-info-title">
        <div class="fund-divider fund-title">
            
            <span>🎲 不期而遇</span>
        </div>
    </div>
    <div class="goto-next-grid">
        <a href="https://www.foreverblog.cn/go.html" target="_blank">
            <img src="https://img.foreverblog.cn/wormhole_1.gif" alt="" style="width:auto;height: auto" title="穿梭虫洞-随机访问十年之约友链博客">
        </a>
        <a style="text-decoration:none;" href="https://travel.moe/go.html" title="异次元之旅-跃迁-我们一起去萌站成员的星球旅行吧！" target="_blank">
            <img src="https://travel.moe/images/icon/icon64.png" style="width:24px;height:24px">异次元之旅</a>
        <a href="https://www.travellings.cn/go.html" target="_blank" rel="noopener" title="开往-友链接力">
            <img src="https://www.travellings.cn/assets/logo.gif" alt="开往-友链接力" width="120">
        </a>
    </div>
</div>

    <div class="toc-container pinned">
        <div class="toc fund-block fund-border">
    <div class="fund-title block-title">
        <div class="fund-divider">
            <span>📑 目录</span>
        </div>
    </div>
    <div class="toc-content shadow-a">
        <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#前言">前言</a></li>
        <li><a href="#需求">需求</a></li>
        <li><a href="#方案">方案</a></li>
        <li><a href="#实施">实施</a>
          <ul>
            <li><a href="#nginx-proxy-manager">Nginx Proxy Manager</a>
              <ul>
                <li><a href="#docker-compose安装">Docker Compose安装</a></li>
                <li><a href="#npm安装">NPM安装</a></li>
                <li><a href="#npm配置">NPM配置</a></li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>
    </div>
        </div>
    </div>

</div>


  </main>
  <footer>
    <p>Copyright 2025 - 2025. All rights reserved. Powered By Hugo.Designed By <a href="https://github.com/ZaNksC/hugo-theme-fund/tree/main">Fund</a></p>
<div style="margin-top: 0.2rem">
    <a href="https://icp.gov.moe/?keyword=20250574" target="_blank">
        <img src="https://img.shields.io/badge/萌ICP-萌ICP备20250574号-red" alt="萌ICP">
    </a>
    <img src="https://img.shields.io/badge/ICP备案-浙ICP备2025162460号-blue" alt="ICP">
    <img src="https://img.shields.io/badge/公安备案-浙公网安备33020502001229号-blue" alt="公安网备案">
</div>
  </footer>
</body>
</html>
