<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Hugo搭建个人博客&amp;Github自托管-基本配置 | 乱话三千</title>
<meta name="keywords" content="建站, hugo, PaperMod">
<meta name="description" content="本文将介绍利用Hugo和PaperMod主题进行个人建站，并通过Github进行静态页面自托管，实现源文件管理、自动构建、自动部署。本文介绍案例不需要自己的域名即可实现。">
<meta name="author" content="Zanks">
<link rel="canonical" href="https://zanksc.github.io/posts/hugo-build-1/">

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <meta name="referrer" content="no-referrer-when-downgrade">
<link crossorigin="anonymous" href="/assets/css/stylesheet.fa329e1dd2ec5d5b1b2d32d23fb94ab65a33f42f5bd66aed5458567a7df4bbed.css" integrity="sha256-&#43;jKeHdLsXVsbLTLSP7lKtloz9C9b1mrtVFhWen30u&#43;0=" rel="preload stylesheet" as="style">
<script src="https://kit.fontawesome.com/4f00e1f6e6.js" crossorigin="anonymous"></script>
<link rel="icon" href="https://zanksc.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://zanksc.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://zanksc.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://zanksc.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://zanksc.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh" href="https://zanksc.github.io/posts/hugo-build-1/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="https://zanksc.github.io/posts/hugo-build-1/">
  <meta property="og:site_name" content="乱话三千">
  <meta property="og:title" content="Hugo搭建个人博客&Github自托管-基本配置">
  <meta property="og:description" content="本文将介绍利用Hugo和PaperMod主题进行个人建站，并通过Github进行静态页面自托管，实现源文件管理、自动构建、自动部署。本文介绍案例不需要自己的域名即可实现。">
  <meta property="og:locale" content="zh-cn">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-12-09T17:32:49+08:00">
    <meta property="article:modified_time" content="2024-12-10T21:08:25+08:00">
    <meta property="article:tag" content="建站">
    <meta property="article:tag" content="Hugo">
    <meta property="article:tag" content="PaperMod">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hugo搭建个人博客&amp;Github自托管-基本配置">
<meta name="twitter:description" content="本文将介绍利用Hugo和PaperMod主题进行个人建站，并通过Github进行静态页面自托管，实现源文件管理、自动构建、自动部署。本文介绍案例不需要自己的域名即可实现。">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "文章",
      "item": "https://zanksc.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Hugo搭建个人博客\u0026Github自托管-基本配置",
      "item": "https://zanksc.github.io/posts/hugo-build-1/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Hugo搭建个人博客\u0026Github自托管-基本配置",
  "name": "Hugo搭建个人博客\u0026Github自托管-基本配置",
  "description": "本文将介绍利用Hugo和PaperMod主题进行个人建站，并通过Github进行静态页面自托管，实现源文件管理、自动构建、自动部署。本文介绍案例不需要自己的域名即可实现。",
  "keywords": [
    "建站", "hugo", "PaperMod"
  ],
  "articleBody": " 虽然个人博客早已被时代淘汰，曾经用技术构建个性标签的个人博主们也年岁见长，忙于对线生活。移动互联网浪潮带来了技术普及，带来的社交平台给了人们无限的个性化标签。实质今日，甚至连“博客”这个词都显得有一些陌生，但不论在什么年代，总有那么一群人认为拥有一个属于自己的博客网站是一件很酷的事。那么希望，这一篇从实践中来的折腾笔记可以帮到你。\n前言 阅读前请审视整体方案\n建站工具： hugo 建站工具皮肤： PaperMod 源代码（原文档）托管平台： Github 站点部署： Github Pages CI/CD(持续集成/持续部署)： Github Actions 整体思路为，在Github中创建两个代码仓，一个用于管理源代码（博主的工作台，建议设置为Private），另一个用于部署静态站点（需要特殊命名，利用Github Pages托管），再利用Github Actions监听源代码仓变动后，自动更新Github Pages页面。\nHugo安装及配置 以下命令均由GitBash终端执行，如使用CMD或PowerShell可以自行替换对应命令\nHugo安装 Hugo的安装比较简单，go的编译产物基本都是一个二进制的可执行文件。从Github的Release页面下载对应操作系统的可执行文件即可。\n我常用的工作、开发机操作系统均为Windows，则以Windows为例，下载 hugo的windows版本文件，将.exe文件解压到任意位置，如D:\\sdk\\hugo。打开环境变量配置，才PATH变量中新增D:\\sdk\\hugo 目录，使得命令行可以直接使用hugo.exe而不需要CD到指定目录。\n下载及配置完之后，打开命令行，输入hugo version 或 hugo.exe version进行验证，如输出版本号则代表安装成功。例如我的输出为：\n$ hugo version hugo v0.139.3-2f6864387cd31b975914e8373d4bf38bddbd47bc+extended+withdeploy windows/amd64 BuildDate=2024-11-29T15:36:56Z VendorInfo=gohugoio 创建站点 使用hugo命令 hugo new site $YOUR_SITE_NAME 来创建站点。该站点后续会被作为原文档仓库托管到Github进行管理\n$ hugo new site zanks-blog Congratulations! Your new Hugo site was created in D:\\03_code\\personal\\zanks-blog. Just a few more steps... 1. Change the current directory to D:\\03_code\\personal\\zanks-blog. 2. Create or install a theme: - Create a new theme with the command \"hugo new theme \" - Or, install a theme from https://themes.gohugo.io/ 3. Edit hugo.toml, setting the \"theme\" property to the theme name. 4. Create new content with the command \"hugo new content \\.\". 5. Start the embedded web server with the command \"hugo server --buildDrafts\". See documentation at https://gohugo.io/. 命令输入完成后，会在当前目录下创建zanks-blog文件夹，这个文件夹会作为原文档仓库。使用tree命令（没有的也可以直接用ll）看一下hugo生成的目录，内容不多。\n$ tree . . |-- archetypes | `-- default.md |-- assets |-- content |-- data |-- hugo.toml |-- i18n |-- layouts |-- static `-- themes 8 directories, 2 files 配置皮肤 在正式启动前，可以给站点安装一个自己喜欢的皮肤（如果不安装，直接进行下一步本地调试，会出现Page Not Found的错误，我已经试过了）\n我使用的皮肤是PaperMode\n首先，使用git init将这个站点目录变为Git仓库，然后使用submodule命令获取皮肤，这边会从Github上下载东西，如果遇到网络问题，需要使用魔法手段解决。\nsubmodule 是一个不太常见的Git命令，通常被用于管理Git仓库中的子模块（submodule）。子模块是指一个Git仓库作为另一个Git仓库的子目录。使用子模块，可以将一个项目嵌入到另一个项目中，同时保持两者的独立性。\n$ git init Initialized empty Git repository in D:/03_code/personal/zanks-blog/.git/ $ git submodule add --depth=1 https://github.com/adityatelange/hugo-PaperMod.git themes/PaperMod Cloning into 'D:/03_code/personal/zanks-blog/themes/PaperMod'... remote: Enumerating objects: 139, done. remote: Counting objects: 100% (139/139), done. remote: Compressing objects: 100% (98/98), done. remote: Total 139 (delta 36), reused 121 (delta 36), pack-reused 0 (from 0) Receiving objects: 100% (139/139), 249.18 KiB | 5.08 MiB/s, done. Resolving deltas: 100% (36/36), done. warning: in the working copy of '.gitmodules', LF will be replaced by CRLF the next time Git touches it 根据PaperMod的官方建议，使用yaml替换toml作为配置文件。安装主题后，备份hugo.toml文件，新增hugo.yml并添加以下内容\nbaseUrl: https://example.org/ languageCode: zh-cn title: 乱话三千 theme: PaperMod 以上配置只能保证站点可以启动，下文中将给出更多高阶配置，需要理解并筛选和更改为适用于自己站点的配置项\nbaseUrl: https://example.org/ languageCode: zh-cn # en-us title: 乱话三千 theme: PaperMod enableRobotsTXT: true # 允许爬虫协议 enableEmoji: true # 允许使用Emoji表情 buildDrafts: false buildFuture: false buildExpired: false params: profileMode: enabled: true subtitle: \"记载着某个人的胡言乱语\" imageUrl: \"/homepage.jpg\" # optional imageWidth: 150 # custom size imageHeight: 150 # custom size buttons: - name: 点击开始 url: \"/posts\" menu: main: - identifier: post name: 文章 url: /posts/ weight: 10 - identifier: tags name: 标签 url: /tags/ weight: 20 - identifier: about name: 关于 url: /about/ weight: 30 这份配置使用了ProfileMode，在首页配置了一个图标和一个按钮，按钮将链接到 /posts 路径。并且在右上角的菜单中添加了三个按钮，分别连接到对应的路径，其中weight表示排序权重，数字越小按钮越靠近左侧。\n创建文章 使用 hugo new $YOUR_ARTICAL命令来创建文章\n$ hugo new posts/test.md Content \"D:\\\\03_code\\\\personal\\\\zanks-blog\\\\content\\\\posts\\\\test.md\" created 该命令在content/posts目录下创建了test.md文件，可以再使用 tree content命令或者 ll content 查看\n$ tree content/ content/ |-- posts | `-- test.md `-- posts.md 1 directory, 2 files 然后再使用cat命令查看自动生成的文件中有什么内容\n$ cat content/posts/test.md +++ date = '2024-12-09T09:25:05+08:00' draft = true title = 'Test' +++ 其中date、titile很好理解，分别为日期和文章的标题。draft 这个查阅了一下官网的解释，大致的意思为表示当前的文章为草案，在构建时除非人为添加参数指定，否则不会打包到最后的静态文件中。以下是官网的原文解释：\ndraft: (`bool`) If `true`, the page will not be rendered unless you pass the `--buildDrafts` flag to the `hugo` command. Access this value from a template using the [`Draft`](https://gohugo.io/methods/page/draft/) method on a `Page` object. 然后，给文件中，添加一些内容。这里不需要修改draft，后续在编译中可以通过参数指定查看到草稿内容。但生产环境需要发布时，将draft的值改为false\n$ cat content/test.md +++ date = '2024-12-09T09:25:05+08:00' draft = true title = 'Test' +++ 这是一篇测试文章 本地调试 本地调试是hugo提供的非常方便的工具，可以让我们在正式发布前看到站点的样子。只需要执行 hugo server 或 hugo serve 即可在本地启动服务端（在调试时可以添加-D参数看到草稿中的文章）。以下是我进行尝试的输出。\n$ hugo serve -D Watching for changes in D:\\03_code\\personal\\zanks-blog\\{archetypes,assets,content,data,i18n,layouts,static,themes} Watching for config changes in D:\\03_code\\personal\\zanks-blog\\hugo.yml Start building sites … hugo v0.139.3-2f6864387cd31b975914e8373d4bf38bddbd47bc+extended+withdeploy windows/amd64 BuildDate=2024-11-29T15:36:56Z VendorInfo=gohugoio | EN -------------------+----- Pages | 11 Paginator pages | 0 Non-page files | 0 Static files | 1 Processed images | 0 Aliases | 0 Cleaned | 0 Built in 64 ms Environment: \"development\" Serving pages from disk Running in Fast Render Mode. For full rebuilds on change: hugo server --disableFastRender Web Server is available at http://localhost:1313/ (bind address 127.0.0.1) Press Ctrl+C to stop 启动后，终端输出了服务器地址，使用浏览器进入就可以预览站点部署后的样子了。不出意外的话，可以看到创建的测文章。\n配置文章模板 在archetypes目录下备份并修改default.md文件来修改新增文章的模板，以下是我根据官方模板进行修改的模板\n--- title: \"{{ replace .File.ContentBaseName \"-\" \" \" | title }}\" date: 2020-09-15T11:30:03+00:00 tags: [\"\"] author: \"Zanks\" draft: true # 默认为草稿模式 weight: #可以用于置顶 showToc: true # 显示目录 TocOpen: false # 打开目录 comments: false # 评论 description: \"\" searchHidden: false # 优化SEO ShowReadingTime: true ShowWordCount: true --- 添加About页面 前面已经配置了About的链接，但是在访问时会出现404，下文中将会配置这个页面。 依然是使用hugo new 命令来创建md文件\n$ hugo new about.md Content \"D:\\\\03_code\\\\personal\\\\zanks-blog\\\\content\\\\about.md\" created 在其中添加一些介绍自己的内容，然后进入页面，点击关于就可以看到新增加到内容了（在发布时，记得将draft更改为false）\n我尝试直接在content目录下创建 about.md 文件，在调试环境中可以看到这个页面，但是实际发布后却没有在public目录找到对应文件，暂时没有找到解决方案。删除并配置了文章模板后，通过命令创建about.md后可以正常工作。\n源代码仓管理 本地仓初始化 执行 git init 命令来初始化目录为git仓 $ git init Initialized empty Git repository in D:/03_code/personal/zanks-blog/.git/ 添加一个.gitignore文件，将public文件夹取消跟踪，该仓将作为源代码仓进行管理，所以构建产物不需要加入跟踪。并将该文件commit（建议通过VSCode等带有图形化管理的操作） $ cat .gitignore /public 为每个空的目录添加.gitkeep文件，来保证源代码仓的完整目录结构（asset、data、i18n、layouts），提交所有改动文件。 完成以上动作之后，本地仓构建完成。后面将在Github上创建代码仓，与该本地仓进行关联。\nGithub代码仓创建 在Github上创建一个空代码仓，使用命令进行关联。在Github页面上会有提示如何关联已有仓库，根据给出的命令直接复制到终端执行即可。\n$ git remote add origin git@github.com:ZaNksC/zanks-blog.git git branch -M main git push -u origin main Enumerating objects: 165, done. Counting objects: 100% (165/165), done. Delta compression using up to 12 threads Compressing objects: 100% (148/148), done. Writing objects: 100% (165/165), 274.80 KiB | 1.01 MiB/s, done. Total 165 (delta 36), reused 0 (delta 0), pack-reused 0 remote: Resolving deltas: 100% (36/36), done. To github.com:ZaNksC/zanks-blog.git * [new branch] main -\u003e main branch 'main' set up to track 'origin/main' 登录Github就可以看到该代码仓中已经有内容了。\n完成这一步后，就可以在任何装有Git和Hugo的机器上对博客进行开发了。\n自动化部署 Github Pages托管 使用Github Pages进行静态站点托管，需要在Github中创建一个名为 username.github.io的特殊项目。 创建之后，就可以用 username.github.io 作为域名直接访问了，当然现在这里是一个空项目，访问之后会出现404。\nGithub Action自动化部署 Github的Action是一套标准的CI系统，通过内置在源代码仓中的.github/workflow目录下的yaml文件来定义流水线的动作。以下是我从Github Workflow的hugo流水线模板修改来的CICD一体化流水线。\n$ cat .github/workflows/hugo.yml # Sample workflow for building and deploying a Hugo site to GitHub Pages name: Deploy Hugo site to Pages on: # Runs on pushes targeting the default branch push: branches: [\"main\"] # Allows you to run this workflow manually from the Actions tab workflow_dispatch: # Sets permissions of the GITHUB_TOKEN to allow deployment to GitHub Pages permissions: contents: read pages: write id-token: write # Allow only one concurrent deployment, skipping runs queued between the run in-progress and latest queued. # However, do NOT cancel in-progress runs as we want to allow these production deployments to complete. concurrency: group: \"pages\" cancel-in-progress: false # Default to bash defaults: run: shell: bash jobs: # Build job build: runs-on: ubuntu-latest env: HUGO_VERSION: 0.139.3 steps: - name: Install Hugo CLI run: | wget -O ${{ runner.temp }}/hugo.deb https://github.com/gohugoio/hugo/releases/download/v${HUGO_VERSION}/hugo_extended_${HUGO_VERSION}_linux-amd64.deb \\ \u0026\u0026 sudo dpkg -i ${{ runner.temp }}/hugo.deb - name: Install Dart Sass run: sudo snap install dart-sass - name: Checkout uses: actions/checkout@v4 with: submodules: recursive - name: Install Node.js dependencies run: \"[[ -f package-lock.json || -f npm-shrinkwrap.json ]] \u0026\u0026 npm ci || true\" - name: Build with Hugo env: HUGO_CACHEDIR: ${{ runner.temp }}/hugo_cache HUGO_ENVIRONMENT: production run: hugo --baseURL=https://zanksc.github.io - name: Deploy Pages uses: peaceiris/actions-gh-pages@v3 with: PERSONAL_TOKEN: ${{ secrets.PERSONAL_TOKEN }} EXTERNAL_REPOSITORY: ZaNksC/ZaNksC.github.io PUBLISH_BRANCH: main PUBLISH_DIR: ./public commit_message: ${{ github.event.head_commit.message }} 需要自行修改 Build With Hugo 步骤中的构建命令，baseURL替换为自己的博客地址，Deploy Pages步骤中的EXTERNAL_REPOSITORY变量，需要替换为自己的GitPage地址。\n需要注意的是，在最后一个步骤Deploy Pages中，有${{ secrets.PERSONAL_TOKEN }}变量，这个变量位于源代码仓-settings-Secrete And variables-Action中。需要在这个目录中创建一个名为PERSONAL_TOKEN的变量。 变量的值则需要在Github（点击头像） - settings-Deploy Settings-Personal access tokens中创建，创建一个经典（classic）的Token，赋予 repo 的所有权限保证可以读写仓库。复制该Token的值（只会出现一次），填入上文提到的 PERSONAL_TOKEN的变量中。\n参考资料 Hugo官方指导手册 PaperMode安装指南 pseudoyu的一站式指导 ",
  "wordCount" : "967",
  "inLanguage": "zh",
  "datePublished": "2024-12-09T17:32:49+08:00",
  "dateModified": "2024-12-10T21:08:25+08:00",
  "author":{
    "@type": "Person",
    "name": "Zanks"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://zanksc.github.io/posts/hugo-build-1/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "乱话三千",
    "logo": {
      "@type": "ImageObject",
      "url": "https://zanksc.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://zanksc.github.io/" accesskey="h" title="乱话三千 (Alt + H)">乱话三千</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://zanksc.github.io/search/" title="搜索 (Alt &#43; /)" accesskey=/>
                    <span>搜索</span>
                </a>
            </li>
            <li>
                <a href="https://zanksc.github.io/posts/" title="文章">
                    <span>文章</span>
                </a>
            </li>
            <li>
                <a href="https://zanksc.github.io/archives/" title="时间轴">
                    <span>时间轴</span>
                </a>
            </li>
            <li>
                <a href="https://zanksc.github.io/tags/" title="标签">
                    <span>标签</span>
                </a>
            </li>
            <li>
                <a href="https://zanksc.github.io/about/" title="关于">
                    <span>关于</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://zanksc.github.io/">主页</a>&nbsp;»&nbsp;<a href="https://zanksc.github.io/posts/">文章</a></div>
    <h1 class="post-title entry-hint-parent">
      Hugo搭建个人博客&amp;Github自托管-基本配置
    </h1>
    <div class="post-description">
      本文将介绍利用Hugo和PaperMod主题进行个人建站，并通过Github进行静态页面自托管，实现源文件管理、自动构建、自动部署。本文介绍案例不需要自己的域名即可实现。
    </div>
    <div class="post-meta"><span title='2024-12-09 17:32:49 +0800 +0800'>2024-12-09</span>&nbsp;·&nbsp;5 分钟&nbsp;·&nbsp;967 字&nbsp;·&nbsp;Zanks


      <div class="meta-item">&nbsp·&nbsp
        <span id="busuanzi_container_page_pv">本文阅读量<span id="busuanzi_value_page_pv"></span>次</span>
      </div>

    </div>
  </header> <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
            <summary accesskey="c" title="(Alt + C)">
                <span class="details">目录</span>
            </summary>

            <div class="inner"><ul>
                    <li>
                        <a href="#%e5%89%8d%e8%a8%80" aria-label="前言">前言</a></li>
                    <li>
                        <a href="#hugo%e5%ae%89%e8%a3%85%e5%8f%8a%e9%85%8d%e7%bd%ae" aria-label="Hugo安装及配置">Hugo安装及配置</a><ul>
                            
                    <li>
                        <a href="#hugo%e5%ae%89%e8%a3%85" aria-label="Hugo安装">Hugo安装</a></li>
                    <li>
                        <a href="#%e5%88%9b%e5%bb%ba%e7%ab%99%e7%82%b9" aria-label="创建站点">创建站点</a></li>
                    <li>
                        <a href="#%e9%85%8d%e7%bd%ae%e7%9a%ae%e8%82%a4" aria-label="配置皮肤">配置皮肤</a></li>
                    <li>
                        <a href="#%e5%88%9b%e5%bb%ba%e6%96%87%e7%ab%a0" aria-label="创建文章">创建文章</a></li>
                    <li>
                        <a href="#%e6%9c%ac%e5%9c%b0%e8%b0%83%e8%af%95" aria-label="本地调试">本地调试</a></li>
                    <li>
                        <a href="#%e9%85%8d%e7%bd%ae%e6%96%87%e7%ab%a0%e6%a8%a1%e6%9d%bf" aria-label="配置文章模板">配置文章模板</a></li>
                    <li>
                        <a href="#%e6%b7%bb%e5%8a%a0about%e9%a1%b5%e9%9d%a2" aria-label="添加About页面">添加About页面</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e6%ba%90%e4%bb%a3%e7%a0%81%e4%bb%93%e7%ae%a1%e7%90%86" aria-label="源代码仓管理">源代码仓管理</a><ul>
                            
                    <li>
                        <a href="#%e6%9c%ac%e5%9c%b0%e4%bb%93%e5%88%9d%e5%a7%8b%e5%8c%96" aria-label="本地仓初始化">本地仓初始化</a></li>
                    <li>
                        <a href="#github%e4%bb%a3%e7%a0%81%e4%bb%93%e5%88%9b%e5%bb%ba" aria-label="Github代码仓创建">Github代码仓创建</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e8%87%aa%e5%8a%a8%e5%8c%96%e9%83%a8%e7%bd%b2" aria-label="自动化部署">自动化部署</a><ul>
                            
                    <li>
                        <a href="#github-pages%e6%89%98%e7%ae%a1" aria-label="Github Pages托管">Github Pages托管</a></li>
                    <li>
                        <a href="#github-action%e8%87%aa%e5%8a%a8%e5%8c%96%e9%83%a8%e7%bd%b2" aria-label="Github Action自动化部署">Github Action自动化部署</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e5%8f%82%e8%80%83%e8%b5%84%e6%96%99" aria-label="参考资料">参考资料</a>
                    </li>
                </ul>
            </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    
    document.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();
    
        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
        if (elements.length > 0) {
            
            activeElement = elements[0];
            const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
            document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
        }
    
        
        const topLink = document.getElementById('top-link');
        if (topLink) {
            topLink.addEventListener('click', (event) => {
                
                event.preventDefault();
    
                
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        }
    }, false);
    
    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);
    
    window.addEventListener('scroll', () => {
        
        const scrollPosition = window.pageYOffset || document.documentElement.scrollTop;
    
        
        if (scrollPosition === 0) {
            return;
        }
    
        
        if (elements && elements.length > 0) {
            
            activeElement = Array.from(elements).find((element) => {
                if ((getOffsetTop(element) - scrollPosition) > 0 && 
                    (getOffsetTop(element) - scrollPosition) < window.innerHeight / 2) {
                    return element;
                }
            }) || activeElement;
    
            elements.forEach(element => {
                const id = encodeURI(element.getAttribute('id')).toLowerCase();
                const tocLink = document.querySelector(`.inner ul li a[href="#${id}"]`);
                if (element === activeElement){
                    tocLink.classList.add('active');
    
                    
                    const tocContainer = document.querySelector('.toc .inner');
                    const linkOffsetTop = tocLink.offsetTop;
                    const containerHeight = tocContainer.clientHeight;
                    const linkHeight = tocLink.clientHeight;
    
                    
                    const scrollPosition = linkOffsetTop - (containerHeight / 2) + (linkHeight / 2);
                    tocContainer.scrollTo({ top: scrollPosition, behavior: 'smooth' });
                } else {
                    tocLink.classList.remove('active');
                }
            });
        }
    }, false);
    
    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);
    
    function checkTocPosition() {
        const width = document.body.scrollWidth;
    
        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }
    
    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;   
    }
    
</script>

  <div class="post-content"><blockquote>
<p>虽然个人博客早已被时代淘汰，曾经用技术构建个性标签的个人博主们也年岁见长，忙于对线生活。移动互联网浪潮带来了技术普及，带来的社交平台给了人们无限的个性化标签。实质今日，甚至连“博客”这个词都显得有一些陌生，但不论在什么年代，总有那么一群人认为拥有一个属于自己的博客网站是一件很酷的事。那么希望，这一篇从实践中来的折腾笔记可以帮到你。</p>
</blockquote>
<h1 id="前言">前言<a hidden class="anchor" aria-hidden="true" href="#前言">#</a></h1>
<p>阅读前请审视整体方案</p>
<ul>
<li>建站工具： hugo</li>
<li>建站工具皮肤： PaperMod</li>
<li>源代码（原文档）托管平台： Github</li>
<li>站点部署： Github Pages</li>
<li>CI/CD(持续集成/持续部署)： Github Actions</li>
</ul>
<p>整体思路为，在Github中创建两个代码仓，一个用于管理源代码（博主的工作台，建议设置为Private），另一个用于部署静态站点（需要特殊命名，利用Github Pages托管），再利用Github Actions监听源代码仓变动后，自动更新Github Pages页面。</p>
<h1 id="hugo安装及配置">Hugo安装及配置<a hidden class="anchor" aria-hidden="true" href="#hugo安装及配置">#</a></h1>
<blockquote>
<p>以下命令均由GitBash终端执行，如使用CMD或PowerShell可以自行替换对应命令</p>
</blockquote>
<h2 id="hugo安装">Hugo安装<a hidden class="anchor" aria-hidden="true" href="#hugo安装">#</a></h2>
<p>Hugo的安装比较简单，go的编译产物基本都是一个二进制的可执行文件。从<a href="https://github.com/gohugoio/hugo/releases">Github的Release页面</a>下载对应操作系统的可执行文件即可。</p>
<p>我常用的工作、开发机操作系统均为Windows，则以Windows为例，下载 hugo的windows版本文件，将.exe文件解压到任意位置，如<code>D:\sdk\hugo</code>。打开环境变量配置，才PATH变量中新增<code>D:\sdk\hugo</code> 目录，使得命令行可以直接使用<code>hugo.exe</code>而不需要CD到指定目录。</p>
<p>下载及配置完之后，打开命令行，输入<code>hugo version</code> 或 <code>hugo.exe version</code>进行验证，如输出版本号则代表安装成功。例如我的输出为：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ hugo version
</span></span><span style="display:flex;"><span>hugo v0.139.3-2f6864387cd31b975914e8373d4bf38bddbd47bc+extended+withdeploy windows/amd64 BuildDate<span style="color:#f92672">=</span>2024-11-29T15:36:56Z VendorInfo<span style="color:#f92672">=</span>gohugoio
</span></span></code></pre></div><h2 id="创建站点">创建站点<a hidden class="anchor" aria-hidden="true" href="#创建站点">#</a></h2>
<p>使用hugo命令 <code>hugo new site $YOUR_SITE_NAME</code> 来创建站点。<strong>该站点后续会被作为原文档仓库托管到Github进行管理</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ hugo new site zanks-blog
</span></span><span style="display:flex;"><span>Congratulations! Your new Hugo site was created in D:<span style="color:#ae81ff">\0</span>3_code<span style="color:#ae81ff">\p</span>ersonal<span style="color:#ae81ff">\z</span>anks-blog.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Just a few more steps...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>1. Change the current directory to D:<span style="color:#ae81ff">\0</span>3_code<span style="color:#ae81ff">\p</span>ersonal<span style="color:#ae81ff">\z</span>anks-blog.
</span></span><span style="display:flex;"><span>2. Create or install a theme:
</span></span><span style="display:flex;"><span>   - Create a new theme with the command <span style="color:#e6db74">&#34;hugo new theme &lt;THEMENAME&gt;&#34;</span>
</span></span><span style="display:flex;"><span>   - Or, install a theme from https://themes.gohugo.io/
</span></span><span style="display:flex;"><span>3. Edit hugo.toml, setting the <span style="color:#e6db74">&#34;theme&#34;</span> property to the theme name.
</span></span><span style="display:flex;"><span>4. Create new content with the command <span style="color:#e6db74">&#34;hugo new content &lt;SECTIONNAME&gt;\&lt;FILENAME&gt;.&lt;FORMAT&gt;&#34;</span>.
</span></span><span style="display:flex;"><span>5. Start the embedded web server with the command <span style="color:#e6db74">&#34;hugo server --buildDrafts&#34;</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>See documentation at https://gohugo.io/.
</span></span></code></pre></div><p>命令输入完成后，会在当前目录下创建zanks-blog文件夹，这个文件夹会作为原文档仓库。使用<code>tree</code>命令（没有的也可以直接用<code>ll</code>）看一下hugo生成的目录，内容不多。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ tree .
</span></span><span style="display:flex;"><span>.
</span></span><span style="display:flex;"><span>|-- archetypes
</span></span><span style="display:flex;"><span>|   <span style="color:#e6db74">`</span>-- default.md
</span></span><span style="display:flex;"><span>|-- assets
</span></span><span style="display:flex;"><span>|-- content
</span></span><span style="display:flex;"><span>|-- data
</span></span><span style="display:flex;"><span>|-- hugo.toml
</span></span><span style="display:flex;"><span>|-- i18n
</span></span><span style="display:flex;"><span>|-- layouts
</span></span><span style="display:flex;"><span>|-- static
</span></span><span style="display:flex;"><span><span style="color:#e6db74">`</span>-- themes
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">8</span> directories, <span style="color:#ae81ff">2</span> files
</span></span></code></pre></div><h2 id="配置皮肤">配置皮肤<a hidden class="anchor" aria-hidden="true" href="#配置皮肤">#</a></h2>
<p>在正式启动前，可以给站点安装一个自己喜欢的皮肤（如果不安装，直接进行下一步本地调试，会出现Page Not Found的错误，我已经试过了）</p>
<p>我使用的皮肤是<a href="https://github.com/adityatelange/hugo-PaperMod">PaperMode</a></p>
<p>首先，使用git init将这个站点目录变为Git仓库，然后使用<code>submodule</code>命令获取皮肤，这边会从Github上下载东西，如果遇到网络问题，需要使用魔法手段解决。</p>
<blockquote>
<p>submodule 是一个不太常见的Git命令，通常被用于管理Git仓库中的子模块（submodule）。子模块是指一个Git仓库作为另一个Git仓库的子目录。使用子模块，可以将一个项目嵌入到另一个项目中，同时保持两者的独立性。</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ git init
</span></span><span style="display:flex;"><span>Initialized empty Git repository in D:/03_code/personal/zanks-blog/.git/
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ git submodule add --depth<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> https://github.com/adityatelange/hugo-PaperMod.git themes/PaperMod
</span></span><span style="display:flex;"><span>Cloning into <span style="color:#e6db74">&#39;D:/03_code/personal/zanks-blog/themes/PaperMod&#39;</span>...
</span></span><span style="display:flex;"><span>remote: Enumerating objects: 139, <span style="color:#66d9ef">done</span>.
</span></span><span style="display:flex;"><span>remote: Counting objects: 100% <span style="color:#f92672">(</span>139/139<span style="color:#f92672">)</span>, <span style="color:#66d9ef">done</span>.
</span></span><span style="display:flex;"><span>remote: Compressing objects: 100% <span style="color:#f92672">(</span>98/98<span style="color:#f92672">)</span>, <span style="color:#66d9ef">done</span>.
</span></span><span style="display:flex;"><span>remote: Total <span style="color:#ae81ff">139</span> <span style="color:#f92672">(</span>delta 36<span style="color:#f92672">)</span>, reused <span style="color:#ae81ff">121</span> <span style="color:#f92672">(</span>delta 36<span style="color:#f92672">)</span>, pack-reused <span style="color:#ae81ff">0</span> <span style="color:#f92672">(</span>from 0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Receiving objects: 100% <span style="color:#f92672">(</span>139/139<span style="color:#f92672">)</span>, 249.18 KiB | 5.08 MiB/s, <span style="color:#66d9ef">done</span>.
</span></span><span style="display:flex;"><span>Resolving deltas: 100% <span style="color:#f92672">(</span>36/36<span style="color:#f92672">)</span>, <span style="color:#66d9ef">done</span>.
</span></span><span style="display:flex;"><span>warning: in the working copy of <span style="color:#e6db74">&#39;.gitmodules&#39;</span>, LF will be replaced by CRLF the next time Git touches it
</span></span></code></pre></div><p>根据PaperMod的官方建议，使用yaml替换toml作为配置文件。安装主题后，备份hugo.toml文件，新增hugo.yml并添加以下内容</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span><span style="color:#f92672">baseUrl</span>: <span style="color:#ae81ff">https://example.org/</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">languageCode</span>: <span style="color:#ae81ff">zh-cn</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">title</span>: <span style="color:#ae81ff">乱话三千</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">theme</span>: <span style="color:#ae81ff">PaperMod</span>
</span></span></code></pre></div><p>以上配置只能保证站点可以启动，下文中将给出更多高阶配置，需要理解并筛选和更改为适用于自己站点的配置项</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">baseUrl</span>: <span style="color:#ae81ff">https://example.org/</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">languageCode</span>: <span style="color:#ae81ff">zh-cn</span> <span style="color:#75715e"># en-us</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">title</span>: <span style="color:#ae81ff">乱话三千</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">theme</span>: <span style="color:#ae81ff">PaperMod</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">enableRobotsTXT</span>: <span style="color:#66d9ef">true</span> <span style="color:#75715e"># 允许爬虫协议</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">enableEmoji</span>: <span style="color:#66d9ef">true</span> <span style="color:#75715e"># 允许使用Emoji表情</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">buildDrafts</span>: <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">buildFuture</span>: <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">buildExpired</span>: <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">params</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">profileMode</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">enabled</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">subtitle</span>: <span style="color:#e6db74">&#34;记载着某个人的胡言乱语&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">imageUrl</span>: <span style="color:#e6db74">&#34;/homepage.jpg&#34;</span> <span style="color:#75715e"># optional</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">imageWidth</span>: <span style="color:#ae81ff">150</span> <span style="color:#75715e"># custom size</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">imageHeight</span>: <span style="color:#ae81ff">150</span> <span style="color:#75715e"># custom size</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">buttons</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">点击开始</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">url</span>: <span style="color:#e6db74">&#34;/posts&#34;</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#f92672">menu</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">main</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">identifier</span>: <span style="color:#ae81ff">post</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">文章</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">url</span>: <span style="color:#ae81ff">/posts/</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">weight</span>: <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">identifier</span>: <span style="color:#ae81ff">tags</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">标签</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">url</span>: <span style="color:#ae81ff">/tags/</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">weight</span>: <span style="color:#ae81ff">20</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">identifier</span>: <span style="color:#ae81ff">about</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">关于</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">url</span>: <span style="color:#ae81ff">/about/</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">weight</span>: <span style="color:#ae81ff">30</span>
</span></span></code></pre></div><p>这份配置使用了ProfileMode，在首页配置了一个图标和一个按钮，按钮将链接到 /posts 路径。并且在右上角的菜单中添加了三个按钮，分别连接到对应的路径，其中weight表示排序权重，数字越小按钮越靠近左侧。</p>
<h2 id="创建文章">创建文章<a hidden class="anchor" aria-hidden="true" href="#创建文章">#</a></h2>
<p>使用 <code>hugo new $YOUR_ARTICAL</code>命令来创建文章</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ hugo new posts/test.md
</span></span><span style="display:flex;"><span>Content <span style="color:#e6db74">&#34;D:\\03_code\\personal\\zanks-blog\\content\\posts\\test.md&#34;</span> created
</span></span></code></pre></div><p>该命令在content/posts目录下创建了<code>test.md</code>文件，可以再使用 <code>tree content</code>命令或者 <code>ll content</code> 查看</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ tree content/
</span></span><span style="display:flex;"><span>content/
</span></span><span style="display:flex;"><span>|-- posts
</span></span><span style="display:flex;"><span>|   <span style="color:#e6db74">`</span>-- test.md
</span></span><span style="display:flex;"><span><span style="color:#e6db74">`</span>-- posts.md
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span> directory, <span style="color:#ae81ff">2</span> files
</span></span></code></pre></div><p>然后再使用<code>cat</code>命令查看自动生成的文件中有什么内容</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cat content/posts/test.md
</span></span><span style="display:flex;"><span>+++
</span></span><span style="display:flex;"><span>date <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;2024-12-09T09:25:05+08:00&#39;</span>
</span></span><span style="display:flex;"><span>draft <span style="color:#f92672">=</span> true
</span></span><span style="display:flex;"><span>title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Test&#39;</span>
</span></span><span style="display:flex;"><span>+++
</span></span></code></pre></div><p>其中date、titile很好理解，分别为日期和文章的标题。<strong>draft</strong> 这个查阅了一下官网的解释，大致的意思为表示当前的文章为草案，在构建时除非人为添加参数指定，否则不会打包到最后的静态文件中。以下是官网的原文解释：</p>
<pre tabindex="0"><code>draft:
(`bool`) If `true`, the page will not be rendered unless you pass the `--buildDrafts` flag to the `hugo` command. Access this value from a template using the [`Draft`](https://gohugo.io/methods/page/draft/) method on a `Page` object.
</code></pre><p>然后，给文件中，添加一些内容。这里不需要修改draft，后续在编译中可以通过参数指定查看到草稿内容。<strong>但生产环境需要发布时，将draft的值改为false</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cat content/test.md
</span></span><span style="display:flex;"><span>+++
</span></span><span style="display:flex;"><span>date <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;2024-12-09T09:25:05+08:00&#39;</span>
</span></span><span style="display:flex;"><span>draft <span style="color:#f92672">=</span> true
</span></span><span style="display:flex;"><span>title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Test&#39;</span>
</span></span><span style="display:flex;"><span>+++
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>这是一篇测试文章
</span></span></code></pre></div><h2 id="本地调试">本地调试<a hidden class="anchor" aria-hidden="true" href="#本地调试">#</a></h2>
<p>本地调试是hugo提供的非常方便的工具，可以让我们在正式发布前看到站点的样子。只需要执行 <code>hugo server</code> 或 <code>hugo serve</code> 即可在本地启动服务端（在调试时可以添加-D参数看到草稿中的文章）。以下是我进行尝试的输出。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ hugo serve -D
</span></span><span style="display:flex;"><span>Watching <span style="color:#66d9ef">for</span> changes in D:<span style="color:#ae81ff">\0</span>3_code<span style="color:#ae81ff">\p</span>ersonal<span style="color:#ae81ff">\z</span>anks-blog<span style="color:#ae81ff">\{</span>archetypes,assets,content,data,i18n,layouts,static,themes<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>Watching <span style="color:#66d9ef">for</span> config changes in D:<span style="color:#ae81ff">\0</span>3_code<span style="color:#ae81ff">\p</span>ersonal<span style="color:#ae81ff">\z</span>anks-blog<span style="color:#ae81ff">\h</span>ugo.yml
</span></span><span style="display:flex;"><span>Start building sites …
</span></span><span style="display:flex;"><span>hugo v0.139.3-2f6864387cd31b975914e8373d4bf38bddbd47bc+extended+withdeploy windows/amd64 BuildDate<span style="color:#f92672">=</span>2024-11-29T15:36:56Z VendorInfo<span style="color:#f92672">=</span>gohugoio
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                   | EN
</span></span><span style="display:flex;"><span>-------------------+-----
</span></span><span style="display:flex;"><span>  Pages            | <span style="color:#ae81ff">11</span>
</span></span><span style="display:flex;"><span>  Paginator pages  |  <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  Non-page files   |  <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  Static files     |  <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>  Processed images |  <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  Aliases          |  <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  Cleaned          |  <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Built in <span style="color:#ae81ff">64</span> ms
</span></span><span style="display:flex;"><span>Environment: <span style="color:#e6db74">&#34;development&#34;</span>
</span></span><span style="display:flex;"><span>Serving pages from disk
</span></span><span style="display:flex;"><span>Running in Fast Render Mode. For full rebuilds on change: hugo server --disableFastRender
</span></span><span style="display:flex;"><span>Web Server is available at http://localhost:1313/ <span style="color:#f92672">(</span>bind address 127.0.0.1<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Press Ctrl+C to stop
</span></span></code></pre></div><p>启动后，终端输出了服务器地址，使用浏览器进入就可以预览站点部署后的样子了。不出意外的话，可以看到创建的测文章。</p>
<h2 id="配置文章模板">配置文章模板<a hidden class="anchor" aria-hidden="true" href="#配置文章模板">#</a></h2>
<p>在archetypes目录下备份并修改default.md文件来修改新增文章的模板，以下是我根据官方模板进行修改的模板</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span><span style="color:#f92672">title</span>: <span style="color:#e6db74">&#34;{{ replace .File.ContentBaseName &#34;</span>-<span style="color:#e6db74">&#34; &#34;</span> <span style="color:#e6db74">&#34; | title }}&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">date</span>: <span style="color:#e6db74">2020-09-15T11:30:03</span><span style="color:#ae81ff">+00</span>:<span style="color:#ae81ff">00</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">tags</span>: [<span style="color:#e6db74">&#34;&#34;</span>]
</span></span><span style="display:flex;"><span><span style="color:#f92672">author</span>: <span style="color:#e6db74">&#34;Zanks&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">draft</span>: <span style="color:#66d9ef">true</span> <span style="color:#75715e"># 默认为草稿模式</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">weight</span>:  <span style="color:#75715e">#可以用于置顶</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">showToc</span>: <span style="color:#66d9ef">true</span> <span style="color:#75715e"># 显示目录</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">TocOpen</span>: <span style="color:#66d9ef">false</span> <span style="color:#75715e"># 打开目录</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">comments</span>: <span style="color:#66d9ef">false</span> <span style="color:#75715e"># 评论</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">description</span>: <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">searchHidden</span>: <span style="color:#66d9ef">false</span> <span style="color:#75715e"># 优化SEO</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">ShowReadingTime</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">ShowWordCount</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>---
</span></span></code></pre></div><h2 id="添加about页面">添加About页面<a hidden class="anchor" aria-hidden="true" href="#添加about页面">#</a></h2>
<p>前面已经配置了About的链接，但是在访问时会出现404，下文中将会配置这个页面。
依然是使用<code>hugo new</code> 命令来创建md文件</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ hugo new about.md
</span></span><span style="display:flex;"><span>Content <span style="color:#e6db74">&#34;D:\\03_code\\personal\\zanks-blog\\content\\about.md&#34;</span> created
</span></span></code></pre></div><p>在其中添加一些介绍自己的内容，然后进入页面，点击关于就可以看到新增加到内容了（在发布时，记得将draft更改为false）</p>
<blockquote>
<p>我尝试直接在content目录下创建 about.md 文件，在调试环境中可以看到这个页面，但是实际发布后却没有在public目录找到对应文件，暂时没有找到解决方案。删除并配置了文章模板后，通过命令创建about.md后可以正常工作。</p>
</blockquote>
<h1 id="源代码仓管理">源代码仓管理<a hidden class="anchor" aria-hidden="true" href="#源代码仓管理">#</a></h1>
<h2 id="本地仓初始化">本地仓初始化<a hidden class="anchor" aria-hidden="true" href="#本地仓初始化">#</a></h2>
<ol>
<li>执行 <code>git init</code> 命令来初始化目录为git仓</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ git init
</span></span><span style="display:flex;"><span>Initialized empty Git repository in D:/03_code/personal/zanks-blog/.git/
</span></span></code></pre></div><ol start="2">
<li>添加一个.gitignore文件，将public文件夹取消跟踪，该仓将作为源代码仓进行管理，所以构建产物不需要加入跟踪。并将该文件commit（建议通过VSCode等带有图形化管理的操作）</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cat .gitignore
</span></span><span style="display:flex;"><span>/public
</span></span></code></pre></div><ol start="3">
<li>为每个空的目录添加.gitkeep文件，来保证源代码仓的完整目录结构（asset、data、i18n、layouts），提交所有改动文件。</li>
</ol>
<p>完成以上动作之后，本地仓构建完成。后面将在Github上创建代码仓，与该本地仓进行关联。</p>
<h2 id="github代码仓创建">Github代码仓创建<a hidden class="anchor" aria-hidden="true" href="#github代码仓创建">#</a></h2>
<p>在Github上创建一个空代码仓，使用命令进行关联。在Github页面上会有提示如何关联已有仓库，根据给出的命令直接复制到终端执行即可。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ git remote add origin git@github.com:ZaNksC/zanks-blog.git
</span></span><span style="display:flex;"><span>git branch -M main
</span></span><span style="display:flex;"><span>git push -u origin main
</span></span><span style="display:flex;"><span>Enumerating objects: 165, <span style="color:#66d9ef">done</span>.
</span></span><span style="display:flex;"><span>Counting objects: 100% <span style="color:#f92672">(</span>165/165<span style="color:#f92672">)</span>, <span style="color:#66d9ef">done</span>.
</span></span><span style="display:flex;"><span>Delta compression using up to <span style="color:#ae81ff">12</span> threads
</span></span><span style="display:flex;"><span>Compressing objects: 100% <span style="color:#f92672">(</span>148/148<span style="color:#f92672">)</span>, <span style="color:#66d9ef">done</span>.
</span></span><span style="display:flex;"><span>Writing objects: 100% <span style="color:#f92672">(</span>165/165<span style="color:#f92672">)</span>, 274.80 KiB | 1.01 MiB/s, <span style="color:#66d9ef">done</span>.
</span></span><span style="display:flex;"><span>Total <span style="color:#ae81ff">165</span> <span style="color:#f92672">(</span>delta 36<span style="color:#f92672">)</span>, reused <span style="color:#ae81ff">0</span> <span style="color:#f92672">(</span>delta 0<span style="color:#f92672">)</span>, pack-reused <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>remote: Resolving deltas: 100% <span style="color:#f92672">(</span>36/36<span style="color:#f92672">)</span>, <span style="color:#66d9ef">done</span>.
</span></span><span style="display:flex;"><span>To github.com:ZaNksC/zanks-blog.git
</span></span><span style="display:flex;"><span> * <span style="color:#f92672">[</span>new branch<span style="color:#f92672">]</span>      main -&gt; main
</span></span><span style="display:flex;"><span>branch <span style="color:#e6db74">&#39;main&#39;</span> set up to track <span style="color:#e6db74">&#39;origin/main&#39;</span>
</span></span></code></pre></div><p>登录Github就可以看到该代码仓中已经有内容了。</p>
<p>完成这一步后，就可以在任何装有Git和Hugo的机器上对博客进行开发了。</p>
<h1 id="自动化部署">自动化部署<a hidden class="anchor" aria-hidden="true" href="#自动化部署">#</a></h1>
<h2 id="github-pages托管">Github Pages托管<a hidden class="anchor" aria-hidden="true" href="#github-pages托管">#</a></h2>
<p>使用Github Pages进行静态站点托管，需要在Github中创建一个名为 <code>username.github.io</code>的特殊项目。
创建之后，就可以用 <code>username.github.io</code> 作为域名直接访问了，当然现在这里是一个空项目，访问之后会出现404。</p>
<h2 id="github-action自动化部署">Github Action自动化部署<a hidden class="anchor" aria-hidden="true" href="#github-action自动化部署">#</a></h2>
<p>Github的Action是一套标准的CI系统，通过内置在源代码仓中的<code>.github/workflow</code>目录下的yaml文件来定义流水线的动作。以下是我从Github Workflow的hugo流水线模板修改来的CICD一体化流水线。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cat .github/workflows/hugo.yml
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Sample workflow for building and deploying a Hugo site to GitHub Pages</span>
</span></span><span style="display:flex;"><span>name: Deploy Hugo site to Pages
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>on:
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># Runs on pushes targeting the default branch</span>
</span></span><span style="display:flex;"><span>  push:
</span></span><span style="display:flex;"><span>    branches: <span style="color:#f92672">[</span><span style="color:#e6db74">&#34;main&#34;</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># Allows you to run this workflow manually from the Actions tab</span>
</span></span><span style="display:flex;"><span>  workflow_dispatch:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Sets permissions of the GITHUB_TOKEN to allow deployment to GitHub Pages</span>
</span></span><span style="display:flex;"><span>permissions:
</span></span><span style="display:flex;"><span>  contents: read
</span></span><span style="display:flex;"><span>  pages: write
</span></span><span style="display:flex;"><span>  id-token: write
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Allow only one concurrent deployment, skipping runs queued between the run in-progress and latest queued.</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># However, do NOT cancel in-progress runs as we want to allow these production deployments to complete.</span>
</span></span><span style="display:flex;"><span>concurrency:
</span></span><span style="display:flex;"><span>  group: <span style="color:#e6db74">&#34;pages&#34;</span>
</span></span><span style="display:flex;"><span>  cancel-in-progress: false
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Default to bash</span>
</span></span><span style="display:flex;"><span>defaults:
</span></span><span style="display:flex;"><span>  run:
</span></span><span style="display:flex;"><span>    shell: bash
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>jobs:
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># Build job</span>
</span></span><span style="display:flex;"><span>  build:
</span></span><span style="display:flex;"><span>    runs-on: ubuntu-latest
</span></span><span style="display:flex;"><span>    env:
</span></span><span style="display:flex;"><span>      HUGO_VERSION: 0.139.3
</span></span><span style="display:flex;"><span>    steps:
</span></span><span style="display:flex;"><span>      - name: Install Hugo CLI
</span></span><span style="display:flex;"><span>        run: |
</span></span><span style="display:flex;"><span>          wget -O <span style="color:#e6db74">${</span>{ runner.temp <span style="color:#e6db74">}</span><span style="color:#f92672">}</span>/hugo.deb https://github.com/gohugoio/hugo/releases/download/v<span style="color:#e6db74">${</span>HUGO_VERSION<span style="color:#e6db74">}</span>/hugo_extended_<span style="color:#e6db74">${</span>HUGO_VERSION<span style="color:#e6db74">}</span>_linux-amd64.deb <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>          <span style="color:#f92672">&amp;&amp;</span> sudo dpkg -i <span style="color:#e6db74">${</span>{ runner.temp <span style="color:#e6db74">}</span><span style="color:#f92672">}</span>/hugo.deb
</span></span><span style="display:flex;"><span>      - name: Install Dart Sass
</span></span><span style="display:flex;"><span>        run: sudo snap install dart-sass
</span></span><span style="display:flex;"><span>      - name: Checkout
</span></span><span style="display:flex;"><span>        uses: actions/checkout@v4
</span></span><span style="display:flex;"><span>        with:
</span></span><span style="display:flex;"><span>          submodules: recursive
</span></span><span style="display:flex;"><span>      - name: Install Node.js dependencies
</span></span><span style="display:flex;"><span>        run: <span style="color:#e6db74">&#34;[[ -f package-lock.json || -f npm-shrinkwrap.json ]] &amp;&amp; npm ci || true&#34;</span>
</span></span><span style="display:flex;"><span>      - name: Build with Hugo
</span></span><span style="display:flex;"><span>        env:
</span></span><span style="display:flex;"><span>          HUGO_CACHEDIR: <span style="color:#e6db74">${</span>{ runner.temp <span style="color:#e6db74">}</span><span style="color:#f92672">}</span>/hugo_cache
</span></span><span style="display:flex;"><span>          HUGO_ENVIRONMENT: production
</span></span><span style="display:flex;"><span>        run:
</span></span><span style="display:flex;"><span>          hugo --baseURL<span style="color:#f92672">=</span>https://zanksc.github.io
</span></span><span style="display:flex;"><span>      - name: Deploy Pages
</span></span><span style="display:flex;"><span>        uses: peaceiris/actions-gh-pages@v3
</span></span><span style="display:flex;"><span>        with:
</span></span><span style="display:flex;"><span>            PERSONAL_TOKEN: <span style="color:#e6db74">${</span>{ secrets.PERSONAL_TOKEN <span style="color:#e6db74">}</span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>            EXTERNAL_REPOSITORY: ZaNksC/ZaNksC.github.io
</span></span><span style="display:flex;"><span>            PUBLISH_BRANCH: main
</span></span><span style="display:flex;"><span>            PUBLISH_DIR: ./public
</span></span><span style="display:flex;"><span>            commit_message: <span style="color:#e6db74">${</span>{ github.event.head_commit.message <span style="color:#e6db74">}</span><span style="color:#f92672">}</span>
</span></span></code></pre></div><p>需要自行修改 Build With Hugo 步骤中的构建命令，baseURL替换为自己的博客地址，Deploy Pages步骤中的EXTERNAL_REPOSITORY变量，需要替换为自己的GitPage地址。</p>
<p>需要注意的是，在最后一个步骤Deploy Pages中，有<code>${{ secrets.PERSONAL_TOKEN }}</code>变量，这个变量位于源代码仓-settings-Secrete And variables-Action中。需要在这个目录中创建一个名为PERSONAL_TOKEN的变量。
变量的值则需要在Github（点击头像） - settings-Deploy Settings-Personal access tokens中创建，创建一个经典（classic）的Token，赋予 repo 的所有权限保证可以读写仓库。复制该Token的值（<strong>只会出现一次</strong>），填入上文提到的
PERSONAL_TOKEN的变量中。</p>
<h1 id="参考资料">参考资料<a hidden class="anchor" aria-hidden="true" href="#参考资料">#</a></h1>
<ul>
<li><a href="https://gohugo.io/getting-started/quick-start/">Hugo官方指导手册</a></li>
<li><a href="https://github.com/adityatelange/hugo-PaperMod">PaperMode安装指南</a></li>
<li><a href="https://sspai.com/post/73512">pseudoyu的一站式指导</a></li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://zanksc.github.io/tags/%E5%BB%BA%E7%AB%99/">建站</a></li>
      <li><a href="https://zanksc.github.io/tags/hugo/">Hugo</a></li>
      <li><a href="https://zanksc.github.io/tags/papermod/">PaperMod</a></li>
    </ul>
  </footer><div class="comments-title" id="tw-comment-title">
    <p class="x-comments-title">欢迎来到评论区</p>
    <p style="font-size: 1rem">感谢您的耐心阅读！如需交流，请留个评论吧！ </p>
</div>
<div id="tw-comment"></div>
<script>
    const getStoredTheme = () => localStorage.getItem("pref-theme") === "dark" ? "dark" : "light";
    const setGiscusTheme = () => {
        const sendMessage = (message) => {
            const iframe = document.querySelector('iframe.giscus-frame');
            if (iframe) {
                iframe.contentWindow.postMessage({giscus: message}, 'https://giscus.app');
            }
        }
        sendMessage({setConfig: {theme: getStoredTheme()}})
    }

    document.addEventListener("DOMContentLoaded", () => {
        const giscusAttributes = {
            "src": "https://giscus.app/client.js",
            "data-repo": "ZaNksC\/ZaNksC.github.io",
            "data-repo-id": "R_kgDONa1lZQ",
            "data-category": "Announcements",
            "data-category-id": "DIC_kwDONa1lZc4ClEBX",
            "data-mapping": "pathname",
            "data-strict": "0",
            "data-reactions-enabled": "1",
            "data-emit-metadata": "0",
            "data-input-position": "bottom",
            "data-theme": getStoredTheme(),
            "data-lang": "zh-CN",
            "data-loading": "lazy",
            "crossorigin": "anonymous",
            "async": "",
        };

        
        const giscusScript = document.createElement("script");
        Object.entries(giscusAttributes).forEach(
                ([key, value]) => giscusScript.setAttribute(key, value));
        document.querySelector("#tw-comment").appendChild(giscusScript);

        
        const themeSwitcher = document.querySelector("#theme-toggle");
        if (themeSwitcher) {
            themeSwitcher.addEventListener("click", setGiscusTheme);
        }
        const themeFloatSwitcher = document.querySelector("#theme-toggle-float");
        if (themeFloatSwitcher) {
            themeFloatSwitcher.addEventListener("click", setGiscusTheme);
        }
    });
</script>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2024 <a href="https://zanksc.github.io/">乱话三千</a></span> · 
    
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = '复制';

        function copyingDone() {
            copybutton.innerHTML = '已复制！';
            setTimeout(() => {
                copybutton.innerHTML = '复制';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script></body>

</html>
