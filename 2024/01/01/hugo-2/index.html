<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>【Hugo】进阶篇：PaperMod主题美化 | 乱话三千</title>
<meta name="keywords" content="Hugo, PaperMod, 建站">
<meta name="description" content="Hugo基本功能扩展（访问量、评论等）&#43; PaperMod主题美化">
<meta name="author" content="Zanks">
<link rel="canonical" href="https://zanksc.github.io/2024/01/01/hugo-2/">

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <meta name="referrer" content="no-referrer-when-downgrade">
<link crossorigin="anonymous" href="/assets/css/stylesheet.dffb32c0572413ff6a2d2fe9665acc700e94f34dfd411de99afb7749ae4b7454.css" integrity="sha256-3/sywFckE/9qLS/pZlrMcA6U8039QR3pmvt3Sa5LdFQ=" rel="preload stylesheet" as="style">
<script src="https://kit.fontawesome.com/4f00e1f6e6.js" crossorigin="anonymous"></script>
<link rel="icon" href="https://zanksc.github.io/assets/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://zanksc.github.io/assets/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://zanksc.github.io/assets/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://zanksc.github.io/assets/apple-touch-icon.png">
<link rel="mask-icon" href="https://zanksc.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh" href="https://zanksc.github.io/2024/01/01/hugo-2/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-420MPRSEER"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-420MPRSEER');
</script><meta property="og:url" content="https://zanksc.github.io/2024/01/01/hugo-2/">
  <meta property="og:site_name" content="乱话三千">
  <meta property="og:title" content="【Hugo】进阶篇：PaperMod主题美化">
  <meta property="og:description" content="Hugo基本功能扩展（访问量、评论等）&#43; PaperMod主题美化">
  <meta property="og:locale" content="zh-cn">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-01-01T02:00:00+08:00">
    <meta property="article:modified_time" content="2024-12-25T15:26:35+08:00">
    <meta property="article:tag" content="Hugo">
    <meta property="article:tag" content="PaperMod">
    <meta property="article:tag" content="建站">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="【Hugo】进阶篇：PaperMod主题美化">
<meta name="twitter:description" content="Hugo基本功能扩展（访问量、评论等）&#43; PaperMod主题美化">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "📖 文章",
      "item": "https://zanksc.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "【Hugo】进阶篇：PaperMod主题美化",
      "item": "https://zanksc.github.io/2024/01/01/hugo-2/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "【Hugo】进阶篇：PaperMod主题美化",
  "name": "【Hugo】进阶篇：PaperMod主题美化",
  "description": "Hugo基本功能扩展（访问量、评论等）+ PaperMod主题美化",
  "keywords": [
    "Hugo", "PaperMod", "建站"
  ],
  "articleBody": " 装修一下旧时代的船，才能开门迎接更多的客人。\n前言 搭建完博客之后，总是会觉得这不满意，然后在搭建过程中，用相同的建站工具和主题搜索，会发现网上有很多大佬已经搭建好的站点，就会这个功能也想要，那个功能也想要。在这里，我记录了一些我搭建过程中进行基础功能拓展和美化的过程。希望可以帮助到有缘人~\n以下教程为进阶版的简略教程，需要你有比较扎实的编程基础（或者不爱思考的脑袋），很多教程来自网上其他大佬，由于看了太多的教程，链接引用不全请见谅，如果有大佬看到了可以联系我加上。\n以下修改html和css的代码都不建议在themes文件夹直接修改，html可以在layout目录下新建同名文件（复制过来改），css可以在assets目录下新建，最终构建都会打包到public中并使用自定义的覆盖主题文件夹中的内容。\n拓展功能 评论 Gisucs 选用Gisucs作为评论服务，最开始我的选择是Gisucs，但是后来我放弃了。Github作为存储虽然是全免费，非常优雅，但是要求评论者拥有一个Github账号对于用于体验实在是不太友好。\nGithub配置 参考链接： https://giscus.app/zh-CN#repository\n在某个Github公开仓库开启discussion功能（settings进入） 在Github安装Gisucs APP 记录生成的配置和代码，需要配置到自己的项目中 Hugo配置 参考链接： https://www.tofuwine.cn/posts/610b75f5/#pe-comments\n添加文件 layouts/partials/comments.html,输入以下内容 \u003cdiv class=\"comments-title\" id=\"tw-comment-title\"\u003e \u003cp class=\"x-comments-title\"\u003e{{- .Param \"giscus.discussionTitle\" }}\u003c/p\u003e \u003cp style=\"font-size: 1rem\"\u003e{{- .Param \"giscus.discussionSubtitle\" }} \u003c/p\u003e \u003c/div\u003e \u003cdiv id=\"tw-comment\"\u003e\u003c/div\u003e \u003cscript\u003e const getStoredTheme = () =\u003e localStorage.getItem(\"pref-theme\") === \"dark\" ? \"{{ .Site.Params.giscus.darkTheme }}\" : \"{{ .Site.Params.giscus.lightTheme }}\"; const setGiscusTheme = () =\u003e { const sendMessage = (message) =\u003e { const iframe = document.querySelector('iframe.giscus-frame'); if (iframe) { iframe.contentWindow.postMessage({giscus: message}, 'https://giscus.app'); } } sendMessage({setConfig: {theme: getStoredTheme()}}) } document.addEventListener(\"DOMContentLoaded\", () =\u003e { const giscusAttributes = { \"src\": \"https://giscus.app/client.js\", \"data-repo\": \"{{ .Site.Params.giscus.repo }}\", \"data-repo-id\": \"{{ .Site.Params.giscus.repoId }}\", \"data-category\": \"{{ .Site.Params.giscus.category }}\", \"data-category-id\": \"{{ .Site.Params.giscus.categoryId }}\", \"data-mapping\": \"{{ .Site.Params.giscus.mapping }}\", \"data-strict\": \"{{ .Site.Params.giscus.strict }}\", \"data-reactions-enabled\": \"{{ .Site.Params.giscus.reactionsEnabled}}\", \"data-emit-metadata\": \"{{ .Site.Params.giscus.emitMetadata }}\", \"data-input-position\": \"{{ .Site.Params.giscus.inputPosition }}\", \"data-theme\": getStoredTheme(), \"data-lang\": \"{{ .Site.Params.giscus.lang }}\", \"data-loading\": \"lazy\", \"crossorigin\": \"anonymous\", \"async\": \"\", }; // 动态创建 giscus script const giscusScript = document.createElement(\"script\"); Object.entries(giscusAttributes).forEach( ([key, value]) =\u003e giscusScript.setAttribute(key, value)); document.querySelector(\"#tw-comment\").appendChild(giscusScript); // 页面主题变更后，变更 giscus 主题 const themeSwitcher = document.querySelector(\"#theme-toggle\"); if (themeSwitcher) { themeSwitcher.addEventListener(\"click\", setGiscusTheme); } const themeFloatSwitcher = document.querySelector(\"#theme-toggle-float\"); if (themeFloatSwitcher) { themeFloatSwitcher.addEventListener(\"click\", setGiscusTheme); } }); \u003c/script\u003e 添加文件 assets/css/extended/comments.css,输入以下内容 /* giscus 评论组件 */ .comments-title { margin-top: 2rem; margin-bottom: 2rem; display: block; text-align: center; } .x-comments-title { display: block; font-size: 1.25em; font-weight: 700; padding: 1.5rem 0 .5rem; } 在 hugo.yaml 中添加内容，其中 {{}} 包裹的需要替换成自己的内容，内容在Gisucs会生成 giscus: repo: \"{{ REPO }}\" repoId: \"{ REPO_ID }\" category: \"Announcements\" categoryId: \"{{ CATEGORYID }}\" mapping: \"pathname\" strict: \"0\" reactionsEnabled: \"1\" emitMetadata: \"0\" inputPosition: \"bottom\" lightTheme: \"light\" darkTheme: \"dark\" lang: \"zh-CN\" discussionTitle: 欢迎来到评论区 discussionSubtitle: 感谢您的耐心阅读！如需交流，请留个评论吧！ 在 archetypes/default.md 中添加配置 comments: true 来开启评论区，已有的博客也需要修改这个来开启 Twikoo Twikoo 官网\n因为Gisucs要求评论者具有Github账号有点使用者不太友好，所以后面更换了一个Twikoo\nTwikoo的整体可以看作是一个CSS的架构，C-Hugo站点的静态JS代码，S-云函数，S-MonogoDB数据库。Twikoo的官方是懂我们这些穷鬼的，提供了很多免费部署的教程。我这边就按照官方推荐度最高的方法进行部署。MonogoDB选择MongoDB Atlas，有500MB的免费额度。Netlify部署云函数，每月 125,000 请求次数和 100 小时函数计算时长，看上去是完全够了。\nMongoDB Atlas 申请资源 MongoDB Atlas\n按照Twikoo官网指导，申请一个账号和500MB空间的MonogoDB数据库。\n注册MongoDB Atlas账号 无脑下一步，创建一个MonogoDB实例，这里创建数据库用户的时候密码记住，后面要用 修改Network Access为 0.0.0.0 允许所有IP访问 在connect中查看代码示例，选Node.js可以看到连接串，把数据库用户密码替换进去，把整个URL复制下来，等部署云函数的时候有用 Netlify 部署云函数 Netlify\n注册Netlify账号，注册的时候需要提供身份验证（有点恶心人了），密码需要设置得复杂一点，不然直接不给登录也不提示，我通过忘记密码改了一个很复杂的~~（时隔三天来校验博客的时候我已经忘记了，但是没关系，浏览器替我记住了）~~ Fork官方的仓到自己的Github，从仓库部署站点，环境变量中填入 MONGODB_URI 值为MonoDB Atlas中复制出来的URL 点xxx.netlify.app进入页面，看到云函数正常运行就是部署成功了 前端部署 需要把前端JS嵌入到Hugo的Html页面中，在 layout/comments.html 文件中添加代码 （如果有其他评论组件请自行删除）\n\u003cdiv id=\"tcomment\"\u003e\u003c/div\u003e \u003cscript src=\"https://cdn.jsdelivr.net/npm/twikoo@1.6.40/dist/twikoo.all.min.js\"\u003e\u003c/script\u003e \u003cscript\u003e twikoo.init({ envId: 'https://xxx.netlify.app/.netlify/functions/twikoo', el: '#tcomment', // 容器元素 }) \u003c/script\u003e 使用配置 进入管理员界面，首次进入配置密码 配置邮箱通知，Hotmail配置了无法测试通过，暂时没找到原因，后来配置了一个163的邮箱（需要填授权码，听说qq更方便一点，gmail没有尝试） 反垃圾配置，使用默认的反垃圾服务 akismet，支付一个0元账单就可以获得一个APPKey，填入配置里面就好 头像服务，默认的 weavatar，注册一个账号，上传一个自己喜欢的头像。但是这边遇到了一个比较奇怪的问题，同时输入昵称和邮箱，头像就会读取失败（但是后来发现生产上好像可以），所以我在通用设置里面把必填字段改成了只填邮箱，因为昵称填QQ号会自动生成qq邮箱。 侧面显示目录 参考资料： https://www.zhouxin.space/logs/introduce-side-toc-and-reading-percentage-to-papermod/\n创建文件 layouts/partials/toc.html 输入以下代码（代码全是抄的，别问我为什么这么写） {{- $headers := findRE \"\u003ch[1-6].*?\u003e(.|\\n])+?\u003c/h[1-6]\u003e\" .Content -}} {{- $has_headers := ge (len $headers) 1 -}} {{- if $has_headers -}} \u003caside id=\"toc-container\" class=\"toc-container wide\"\u003e \u003cdiv class=\"toc\"\u003e \u003cdetails {{if (.Param \"TocOpen\") }} open{{ end }}\u003e \u003csummary accesskey=\"c\" title=\"(Alt + C)\"\u003e \u003cspan class=\"details\"\u003e{{- i18n \"toc\" | default \"Table of Contents\" }}\u003c/span\u003e \u003c/summary\u003e \u003cdiv class=\"inner\"\u003e {{- $largest := 6 -}} {{- range $headers -}} {{- $headerLevel := index (findRE \"[1-6]\" . 1) 0 -}} {{- $headerLevel := len (seq $headerLevel) -}} {{- if lt $headerLevel $largest -}} {{- $largest = $headerLevel -}} {{- end -}} {{- end -}} {{- $firstHeaderLevel := len (seq (index (findRE \"[1-6]\" (index $headers 0) 1) 0)) -}} {{- $.Scratch.Set \"bareul\" slice -}} \u003cul\u003e {{- range seq (sub $firstHeaderLevel $largest) -}} \u003cul\u003e {{- $.Scratch.Add \"bareul\" (sub (add $largest .) 1) -}} {{- end -}} {{- range $i, $header := $headers -}} {{- $headerLevel := index (findRE \"[1-6]\" . 1) 0 -}} {{- $headerLevel := len (seq $headerLevel) -}} {{/* get id=\"xyz\" */}} {{- $id := index (findRE \"(id=\\\"(.*?)\\\")\" $header 9) 0 }} {{- /* strip id=\"\" to leave xyz, no way to get regex capturing groups in hugo */ -}} {{- $cleanedID := replace (replace $id \"id=\\\"\" \"\") \"\\\"\" \"\" }} {{- $header := replaceRE \"\u003ch[1-6].*?\u003e((.|\\n])+?)\u003c/h[1-6]\u003e\" \"$1\" $header -}} {{- if ne $i 0 -}} {{- $prevHeaderLevel := index (findRE \"[1-6]\" (index $headers (sub $i 1)) 1) 0 -}} {{- $prevHeaderLevel := len (seq $prevHeaderLevel) -}} {{- if gt $headerLevel $prevHeaderLevel -}} {{- range seq $prevHeaderLevel (sub $headerLevel 1) -}} \u003cul\u003e {{/* the first should not be recorded */}} {{- if ne $prevHeaderLevel . -}} {{- $.Scratch.Add \"bareul\" . -}} {{- end -}} {{- end -}} {{- else -}} \u003c/li\u003e {{- if lt $headerLevel $prevHeaderLevel -}} {{- range seq (sub $prevHeaderLevel 1) -1 $headerLevel -}} {{- if in ($.Scratch.Get \"bareul\") . -}} \u003c/ul\u003e {{/* manually do pop item */}} {{- $tmp := $.Scratch.Get \"bareul\" -}} {{- $.Scratch.Delete \"bareul\" -}} {{- $.Scratch.Set \"bareul\" slice}} {{- range seq (sub (len $tmp) 1) -}} {{- $.Scratch.Add \"bareul\" (index $tmp (sub . 1)) -}} {{- end -}} {{- else -}} \u003c/ul\u003e \u003c/li\u003e {{- end -}} {{- end -}} {{- end -}} {{- end }} \u003cli\u003e \u003ca href=\"#{{- $cleanedID -}}\" aria-label=\"{{- $header | plainify -}}\"\u003e{{- $header | safeHTML -}}\u003c/a\u003e {{- else }} \u003cli\u003e \u003ca href=\"#{{- $cleanedID -}}\" aria-label=\"{{- $header | plainify -}}\"\u003e{{- $header | safeHTML -}}\u003c/a\u003e {{- end -}} {{- end -}} {{- $firstHeaderLevel := $largest }} {{- $lastHeaderLevel := len (seq (index (findRE \"[1-6]\" (index $headers (sub (len $headers) 1)) 1) 0)) }} \u003c/li\u003e {{- range seq (sub $lastHeaderLevel $firstHeaderLevel) -}} {{- if in ($.Scratch.Get \"bareul\") (add . $firstHeaderLevel) }} \u003c/ul\u003e {{- else }} \u003c/ul\u003e \u003c/li\u003e {{- end -}} {{- end }} \u003c/ul\u003e \u003c/div\u003e \u003c/details\u003e \u003c/div\u003e \u003c/aside\u003e \u003cscript\u003e let activeElement; let elements; document.addEventListener('DOMContentLoaded', function (event) { checkTocPosition(); elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]'); if (elements.length \u003e 0) { // Make the first header active activeElement = elements[0]; const id = encodeURI(activeElement.getAttribute('id')).toLowerCase(); document.querySelector(`.inner ul li a[href=\"#${id}\"]`).classList.add('active'); } // Add event listener for the \"back to top\" link const topLink = document.getElementById('top-link'); if (topLink) { topLink.addEventListener('click', (event) =\u003e { // Prevent the default action event.preventDefault(); // Smooth scroll to the top window.scrollTo({ top: 0, behavior: 'smooth' }); }); } }, false); window.addEventListener('resize', function(event) { checkTocPosition(); }, false); window.addEventListener('scroll', () =\u003e { // Get the current scroll position const scrollPosition = window.pageYOffset || document.documentElement.scrollTop; // Check if the scroll position is at the top of the page if (scrollPosition === 0) { return; } // Ensure elements is a valid NodeList if (elements \u0026\u0026 elements.length \u003e 0) { // Check if there is an object in the top half of the screen or keep the last item active activeElement = Array.from(elements).find((element) =\u003e { if ((getOffsetTop(element) - scrollPosition) \u003e 0 \u0026\u0026 (getOffsetTop(element) - scrollPosition) \u003c window.innerHeight / 2) { return element; } }) || activeElement; elements.forEach(element =\u003e { const id = encodeURI(element.getAttribute('id')).toLowerCase(); const tocLink = document.querySelector(`.inner ul li a[href=\"#${id}\"]`); if (element === activeElement){ tocLink.classList.add('active'); // Ensure the active element is in view within the .inner container const tocContainer = document.querySelector('.toc .inner'); const linkOffsetTop = tocLink.offsetTop; const containerHeight = tocContainer.clientHeight; const linkHeight = tocLink.clientHeight; // Calculate the scroll position to center the active link const scrollPosition = linkOffsetTop - (containerHeight / 2) + (linkHeight / 2); tocContainer.scrollTo({ top: scrollPosition, behavior: 'smooth' }); } else { tocLink.classList.remove('active'); } }); } }, false); const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10); const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10); const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10); function checkTocPosition() { const width = document.body.scrollWidth; if (width - main - (toc * 2) - (gap * 4) \u003e 0) { document.getElementById(\"toc-container\").classList.add(\"wide\"); } else { document.getElementById(\"toc-container\").classList.remove(\"wide\"); } } function getOffsetTop(element) { if (!element.getClientRects().length) { return 0; } let rect = element.getBoundingClientRect(); let win = element.ownerDocument.defaultView; return rect.top + win.pageYOffset; } \u003c/script\u003e {{- end }} 创建 assets/css/extended/toc.css 文件，并输入以下内容（也是抄的，感谢大佬，赞美大佬） :root { --nav-width: 1380px; --article-width: 650px; --toc-width: 300px; } .toc { margin: 0 2px 40px 2px; border: 1px solid var(--border); background: var(--entry); border-radius: var(--radius); padding: 0.4em; } .toc-container.wide { position: absolute; height: 100%; border-right: 1px solid var(--border); left: calc((var(--toc-width) + var(--gap)) * -1); top: calc(var(--gap) * 2); width: var(--toc-width); } .wide .toc { position: sticky; top: var(--gap); border: unset; background: unset; border-radius: unset; width: 100%; margin: 0 2px 40px 2px; } .toc details summary { cursor: zoom-in; margin-inline-start: 20px; padding: 12px 0; } .toc details[open] summary { font-weight: 500; } .toc-container.wide .toc .inner { margin: 0; } .active { font-size: 110%; font-weight: 600; } .toc ul { list-style-type: circle; } .toc .inner { margin: 0 0 0 20px; padding: 0px 15px 15px 20px; font-size: 16px; /*目录显示高度*/ max-height: 83vh; overflow-y: auto; } .toc .inner::-webkit-scrollbar-thumb { /*滚动条*/ background: var(--border); border: 7px solid var(--theme); border-radius: var(--radius); } .toc li ul { margin-inline-start: calc(var(--gap) * 0.5); list-style-type: none; } .toc li { list-style: none; font-size: 0.95rem; padding-bottom: 5px; } .toc li a:hover { color: var(--secondary); } 同时在archetypes\\default.yml中添加参数 showToc: true # 显示目录 TocOpen: true # 打开目录 PV/UV 不蒜子Busuanzi 使用不蒜子Busuanzi进行站点访问统计。 参考链接： https://blog.kanikig.xyz/hugo-busuanzi/\n添加文件 layouts\\parials\\head.html 从主题文件夹 themes\\layouts\\parials\\head.html 中拷贝内容并修改，在Styles上方添加一个if块 ... {{- if site.Params.analytics.naver.SiteVerificationTag }} \u003cmeta name=\"naver-site-verification\" content=\"{{ site.Params.analytics.naver.SiteVerificationTag }}\"\u003e {{- end }} {{- if .Site.Params.busuanzi.enable -}} \u003cscript async src=\"//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js\"\u003e\u003c/script\u003e \u003cmeta name=\"referrer\" content=\"no-referrer-when-downgrade\"\u003e {{- end -}} {{- /* Styles */}} ... 添加文件 layouts\\parials\\footer.html 从主题文件夹 themes\\layouts\\parials\\footer.html 中拷贝内容并修改，在footer标签内添加一个if块 ... {{- if not (.Param \"hideFooter\") }} \u003cfooter class=\"footer\"\u003e {{- if not site.Params.footer.hideCopyright }} {{- if site.Copyright }} \u003cspan\u003e{{ site.Copyright | markdownify }}\u003c/span\u003e {{- else }} \u003cspan\u003e\u0026copy; {{ now.Year }} \u003ca href=\"{{ \"\" | absLangURL }}\"\u003e{{ site.Title }}\u003c/a\u003e\u003c/span\u003e {{- end }} {{- print \" · \"}} {{- end }} {{- with site.Params.footer.text }} {{ . | markdownify }} {{- print \" · \"}} {{- end }} {{ if .Site.Params.busuanzi.enable -}} \u003cdiv class=\"busuanzi-footer\"\u003e \u003cspan id=\"busuanzi_container_site_pv\"\u003e 本站总访问量\u003cspan id=\"busuanzi_value_site_pv\"\u003e\u003c/span\u003e次 \u003c/span\u003e \u003cspan id=\"busuanzi_container_site_uv\"\u003e 本站访客数\u003cspan id=\"busuanzi_value_site_uv\"\u003e\u003c/span\u003e人次 \u003c/span\u003e \u003c/div\u003e {{- end -}} \u003cspan\u003e Powered by \u003ca href=\"https://gohugo.io/\" rel=\"noopener noreferrer\" target=\"_blank\"\u003eHugo\u003c/a\u003e \u0026 \u003ca href=\"https://github.com/adityatelange/hugo-PaperMod/\" rel=\"noopener\" target=\"_blank\"\u003ePaperMod\u003c/a\u003e \u003c/span\u003e \u003c/footer\u003e ... {{- end }} 添加文件 layouts\\_defaults\\single.html 从主题文件夹 themes\\layouts\\_defaults\\single.html 中拷贝内容并修改，在post-meta内添加一个if块 ... \u003cdiv class=\"post-meta\"\u003e {{- partial \"post_meta.html\" . -}} {{- partial \"translation_list.html\" . -}} {{- partial \"edit_post.html\" . -}} {{- partial \"post_canonical.html\" . -}} {{ if .Site.Params.busuanzi.enable -}} \u003cdiv class=\"meta-item\"\u003e\u0026nbsp·\u0026nbsp \u003cspan id=\"busuanzi_container_page_pv\"\u003e本文阅读量\u003cspan id=\"busuanzi_value_page_pv\"\u003e\u003c/span\u003e次\u003c/span\u003e \u003c/div\u003e {{- end }} \u003c/div\u003e ... 在hugo.html文件中的param节点中添加开关 params: busuanzi: enable: true Google Analyze 只需要在 hugo.yaml 中添加以下代码即可，id更换为自己在Google Analytic中申请的跟踪ID\nservices: googleAnalytics: id: \"G-XXXXXXXXXX\" 时间线 添加一个根据时间线排列的归档页面，写的多写的久才有质感。多写写吧！\n添加 content\\archive.md 文件，输入以下内容 --- title: \"\" layout: \"archives\" url: \"/archives/\" summary: archives --- 在 hugo.html 中添加按钮，在 menu.main 节点下新增以下内容 - identifier: archive name: 时间轴 url: /archives/ weight: 11 留言板 利用评论系统，新增一个Layout来构建一个留言板页面。\n创建 layouts\\message.html 文件输入一下代码（代码从 single.html 中删除了很多东西，简化得到，顺便做了一下标题居中，这回是自己写的了）： {{- define \"main\" }} \u003carticle class=\"post-single\"\u003e \u003cheader class=\"post-header\"\u003e \u003ch1 class=\"post-title entry-hint-parent\"\u003e \u003cdiv style=\"margin-left: auto;margin-right: auto;\"\u003e {{ .Title }} \u003c/div\u003e \u003c/h1\u003e \u003c/header\u003e {{- if .Content }} \u003cdiv class=\"post-content\"\u003e {{ .Content }} \u003c/div\u003e {{- end }} \u003cfooter class=\"post-footer\"\u003e \u003cdiv id=\"tcomment\"\u003e\u003c/div\u003e \u003cscript src=\"https://cdn.jsdelivr.net/npm/twikoo@1.6.40/dist/twikoo.all.min.js\"\u003e\u003c/script\u003e \u003cscript\u003e twikoo.init({ envId: 'xxx', el: '#tcomment', }) \u003c/script\u003e \u003c/footer\u003e \u003c/article\u003e {{- end }} 在命令行中创建一个新的md文件(不要直接新建文件，我试了，编译的时候不会生成文件，会导致404)，输入 hugo new message.md，并在其中输入以下代码 --- title: \"💬 留言板\" date: '2024-12-13T21:14:22+08:00' draft: false # 默认为草稿模式 layout: \"message\" comments: true # 评论 --- 在 hugo.yaml 中新增首页目录，添加以下代码 - identifier: message name: 💬 留言板 url: /message/ weight: 21 添加最近修改时间 复制主题中的 post_meta.html 到 layout/post_meta.html 新增最近修改时间的内容，并修改发布时间的内容和国际化，\n在 layout/post_meta.html 输入以下代码 {{- $scratch := newScratch }} {{- if not .Date.IsZero -}} {{- $dateStr := .Date.Format (default \"January 2, 2006\" site.Params.DateFormat) -}} {{- $translatedPublished := i18n \"published\" -}} {{- $dateHTML := printf \"\u003cspan title='%s'\u003e%s\u003c/span\u003e\" (.Date) $dateStr -}} {{- $scratch.Add \"meta\" (slice (printf \"%s %s\" $translatedPublished $dateHTML)) }} {{- end }} {{- if not .Lastmod.IsZero -}} {{- $lastmodStr := .Lastmod.Format (default \"January 2, 2006\" site.Params.DateFormat) -}} {{- $translatedLastModified := i18n \"last_modified\" -}} {{- $lastmodHTML := printf \"\u003cspan title='%s'\u003e%s\u003c/span\u003e\" (.Lastmod) $lastmodStr -}} {{- $scratch.Add \"meta\" (slice (printf \"%s %s\" $translatedLastModified $lastmodHTML)) }} {{- end }} {{- if (.Param \"ShowReadingTime\") -}} {{- $scratch.Add \"meta\" (slice (i18n \"read_time\" .ReadingTime | default (printf \"%d min\" .ReadingTime))) }} {{- end }} {{- if (.Param \"ShowWordCount\") -}} {{- $scratch.Add \"meta\" (slice (i18n \"words\" .WordCount | default (printf \"%d words\" .WordCount))) }} {{- end }} {{- if not (.Param \"hideAuthor\") -}} {{- with (partial \"author.html\" .) }} {{- $scratch.Add \"meta\" (slice .) }} {{- end }} {{- end }} {{- with ($scratch.Get \"meta\") }} {{- delimit . \"\u0026nbsp;·\u0026nbsp;\" | safeHTML -}} {{- end -}} 在i18n文件夹的对应目录添加翻译 在 hugo.yaml 中新增配置 frontmatte.lastmod: ['lastmod', ':git', 'date', 'publishDate'] 用于指定lastmod变量的赋值顺序 自定义域名 首先需要有一个域名，在对应的域名服务商添加一条解析记录，解析类型：CNAME，解析值为 xxx.github.io (xxx替换为自己的Github用户名)\n再添加文件 static\\CNAME ,文件的内容为自定义的域名。没有这个文件，访问域名会出现404。\n界面显示优化 配置默认语言为中文 在 hugo.html 文件中添加配置 defaultContentLanguage: zh 可以汉化大部分主题的内容\n日期格式显示优化 在 hugo.html 文件中的Param节点下添加配置 DateFormat: \"2006-01-02\" (go的时间配置必须要用这个日期，yyyy-MM-dd不行)\n标签页添加词云 参考资料： https://blog.xlap.top/post/tech/wordcloud4hugo/#%E9%A1%B9%E7%9B%AE%E5%9C%B0%E5%9D%80 感谢开源作者和大佬代码，我直接抄了\n下载 wordcloud2.js 拷贝到 static/js/ 目录下，下载地址 修改 head.html 引入js文件，新增以下代码： {{- if eq .Section \"tags\"}} {{/* 标签云 */}} \u003clink rel=\"stylesheet\" href=\"/css/word-cloud.css\"\\\u003e \u003cscript src=\"/js/wordcloud2.js\"\u003e\u003c/script\u003e {{- end }} 创建 staic/css/word-cloud.css 文件输入以下代码： .word-color:nth-child(7n + 1) { color: rgb(202, 110, 255); } .word-color:nth-child(7n + 2) { color: rgb(83, 110, 255); } .word-color:nth-child(7n + 3) { color: rgb(143, 253, 241); } .word-color:nth-child(7n + 4) { color: rgb(183, 255, 112); } .word-color:nth-child(7n + 5) { color: rgb(255, 212, 126); } .word-color:nth-child(7n + 6) { color: rgb(248, 140, 131); } .word-color:nth-child(7n + 7) { color: rgb(104, 160, 255); } @keyframes word { 0% { opacity: 0.5; } 3% { opacity: 1; } 9% { opacity: 1; } 12% { opacity: 0.5; } 100% { opacity: 0.5; } } .word-animate { animation-name: word; animation-duration: 20s; animation-iteration-count: infinite; will-change: opacity; opacity: 0.5; } .word-animate:nth-child(7n + 1) { animation-delay: 0s; } .word-animate:nth-child(7n + 2) { animation-delay: 3s; } .word-animate:nth-child(7n + 3) { animation-delay: 6s; } .word-animate:nth-child(7n + 4) { animation-delay: 9s; } .word-animate:nth-child(7n + 5) { animation-delay: 12s; } .word-animate:nth-child(7n + 6) { animation-delay: 15s; } .word-animate:nth-child(7n + 7) { animation-delay: 18s; } 创建 layouts/_default/terms.html 输入以下代码 {{- define \"main\" }} {{- if .Title }} \u003cheader class=\"page-header\"\u003e \u003ch1\u003e{{ .Title }}\u003c/h1\u003e {{- if .Description }} \u003cdiv class=\"post-description\"\u003e {{ .Description }} \u003c/div\u003e {{- end }} \u003c/header\u003e {{- end }} \u003cul class=\"terms-tags\"\u003e \u003cdiv id=\"sourrounding_div\" style=\"width:100%;height:100%;min-height: 500px;\"\u003e \u003cdiv id=\"tag-canvas\"\u003e\u003c/div\u003e \u003c/div\u003e \u003cscript src=\"/js/wordcloud2.js\"\u003e\u003c/script\u003e {{- range $key, $value := .Data.Terms.Alphabetical }} {{ if eq \"\" ($.Scratch.Get \"tagsMap\") }} {{ $.Scratch.Set \"tagsMap\" (slice (dict .Name .Count)) }} {{ else }} {{ $.Scratch.Add \"tagsMap\" (slice (dict .Name .Count)) }} {{ end }} {{- end }} {{ $result := ($.Scratch.Get \"tagsMap\")}} \u003cspan id=\"tag-temp\" style=\"display:none\"\u003e{{$result | jsonify }}\u003c/span\u003e \u003cscript\u003e //因为前期每个标签值比较小，帮X一个系数 var XISHU = 20; //为了动态宽度 var div = document.querySelector(\"#sourrounding_div\"); var canvas = document.querySelector(\"#tag-canvas\"); canvas.style.width = div.offsetWidth + 'px'; canvas.style.height = div.offsetHeight + 'px'; var wordFreqData = document.querySelector(\"#tag-temp\").innerHTML; var jsonObj = JSON.parse(wordFreqData); var arr = [] jsonObj.forEach(element =\u003e { var key = Object.keys(element); var itemArr = [key[0], element[key] * XISHU]; arr.push(itemArr); }); //获取当前是暗色还是浅色 var isDark = document.body.className.includes(\"dark\"); WordCloud(canvas, { \"list\": arr,//或者[['各位观众',45],['词云', 21],['来啦!!!',13]],只要格式满足这样都可以 \"shape\": \"cardioid\", //形状 circle (default), cardioid (心型), diamond, square, triangle-forward, triangle, pentagon, and star. \"gridSize\": 20, // 密集程度 数字越小越密集 \"weightFactor\": 1, // 字体大小=原始大小*weightFactor \"fontWeight\": 'normal', //字体粗细 \"fontFamily\": 'Times, serif', // 字体 \"color\": isDark ? 'random-light' : 'random-dark', // 字体颜色 'random-dark' 或者 'random-light' \"backgroundColor\": 'none', // 背景颜色 \"classes\": \"tag-cloud-item word-color\", //用于点击事件 }); canvas.addEventListener('wordcloudstop', function (e) { //动画 setTimeout(() =\u003e { var els = document.querySelectorAll(\".word-color\"); Array.from(els).forEach((el) =\u003e { console.log('动画', el) el.classList.add(\"word-animate\") }) }, 2000); //点击 document.querySelectorAll('.tag-cloud-item').forEach(function (element) { const text = element.innerHTML; element.innerHTML = `",
  "wordCount" : "2468",
  "inLanguage": "zh",
  "datePublished": "2024-01-01T02:00:00+08:00",
  "dateModified": "2024-12-25T15:26:35+08:00",
  "author":{
    "@type": "Person",
    "name": "Zanks"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://zanksc.github.io/2024/01/01/hugo-2/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "乱话三千",
    "logo": {
      "@type": "ImageObject",
      "url": "https://zanksc.github.io/assets/favicon.ico"
    }
  }
}
</script>

</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://zanksc.github.io/" accesskey="h" title="乱话三千 (Alt + H)">乱话三千</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://zanksc.github.io/search/" title="🔍 搜索 (Alt &#43; /)" accesskey=/>
                    <span>🔍 搜索</span>
                </a>
            </li>
            <li>
                <a href="https://zanksc.github.io/posts/" title="📖 文章">
                    <span>📖 文章</span>
                </a>
            </li>
            <li>
                <a href="https://zanksc.github.io/archives/" title="⌛ 时间轴">
                    <span>⌛ 时间轴</span>
                </a>
            </li>
            <li>
                <a href="https://zanksc.github.io/tags/" title="🏷️ 标签">
                    <span>🏷️ 标签</span>
                </a>
            </li>
            <li>
                <a href="https://zanksc.github.io/message/" title="💬 留言板">
                    <span>💬 留言板</span>
                </a>
            </li>
            <li>
                <a href="https://zanksc.github.io/about/" title="😾 关于">
                    <span>😾 关于</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://zanksc.github.io/">主页</a>&nbsp;»&nbsp;<a href="https://zanksc.github.io/posts/">📖 文章</a></div>
    <h1 class="post-title entry-hint-parent">
      【Hugo】进阶篇：PaperMod主题美化
    </h1>
    <div class="post-description">
      Hugo基本功能扩展（访问量、评论等）&#43; PaperMod主题美化
    </div>
    <div class="post-meta">发布于: <no value> <span title='2024-01-01 02:00:00 +0800 +0800'>2024-01-01</span>&nbsp;·&nbsp;最后修改于: <no value> <span title='2024-12-25 15:26:35 +0800 +0800'>2024-12-25</span>&nbsp;·&nbsp;12 分钟&nbsp;·&nbsp;2468 字&nbsp;·&nbsp;Zanks

</div>

    
  </header> <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
            <summary accesskey="c" title="(Alt + C)">
                <span class="details">目录</span>
            </summary>

            <div class="inner"><ul>
                    <li>
                        <a href="#%e5%89%8d%e8%a8%80" aria-label="前言">前言</a></li>
                    <li>
                        <a href="#%e6%8b%93%e5%b1%95%e5%8a%9f%e8%83%bd" aria-label="拓展功能">拓展功能</a><ul>
                            
                    <li>
                        <a href="#%e8%af%84%e8%ae%ba" aria-label="评论">评论</a><ul>
                            
                    <li>
                        <a href="#gisucs" aria-label="Gisucs">Gisucs</a><ul>
                            
                    <li>
                        <a href="#github%e9%85%8d%e7%bd%ae" aria-label="Github配置">Github配置</a></li>
                    <li>
                        <a href="#hugo%e9%85%8d%e7%bd%ae" aria-label="Hugo配置">Hugo配置</a></li></ul>
                    </li>
                    <li>
                        <a href="#twikoo" aria-label="Twikoo">Twikoo</a><ul>
                            
                    <li>
                        <a href="#mongodb-atlas-%e7%94%b3%e8%af%b7%e8%b5%84%e6%ba%90" aria-label="MongoDB Atlas 申请资源">MongoDB Atlas 申请资源</a></li>
                    <li>
                        <a href="#netlify-%e9%83%a8%e7%bd%b2%e4%ba%91%e5%87%bd%e6%95%b0" aria-label="Netlify 部署云函数">Netlify 部署云函数</a></li>
                    <li>
                        <a href="#%e5%89%8d%e7%ab%af%e9%83%a8%e7%bd%b2" aria-label="前端部署">前端部署</a></li>
                    <li>
                        <a href="#%e4%bd%bf%e7%94%a8%e9%85%8d%e7%bd%ae" aria-label="使用配置">使用配置</a></li></ul>
                    </li></ul>
                    </li>
                    <li>
                        <a href="#%e4%be%a7%e9%9d%a2%e6%98%be%e7%a4%ba%e7%9b%ae%e5%bd%95" aria-label="侧面显示目录">侧面显示目录</a></li>
                    <li>
                        <a href="#pvuv" aria-label="PV/UV">PV/UV</a><ul>
                            
                    <li>
                        <a href="#%e4%b8%8d%e8%92%9c%e5%ad%90busuanzi" aria-label="不蒜子Busuanzi">不蒜子Busuanzi</a></li>
                    <li>
                        <a href="#google-analyze" aria-label="Google Analyze">Google Analyze</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e6%97%b6%e9%97%b4%e7%ba%bf" aria-label="时间线">时间线</a></li>
                    <li>
                        <a href="#%e7%95%99%e8%a8%80%e6%9d%bf" aria-label="留言板">留言板</a></li>
                    <li>
                        <a href="#%e6%b7%bb%e5%8a%a0%e6%9c%80%e8%bf%91%e4%bf%ae%e6%94%b9%e6%97%b6%e9%97%b4" aria-label="添加最近修改时间">添加最近修改时间</a></li>
                    <li>
                        <a href="#%e8%87%aa%e5%ae%9a%e4%b9%89%e5%9f%9f%e5%90%8d" aria-label="自定义域名">自定义域名</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e7%95%8c%e9%9d%a2%e6%98%be%e7%a4%ba%e4%bc%98%e5%8c%96" aria-label="界面显示优化">界面显示优化</a><ul>
                            
                    <li>
                        <a href="#%e9%85%8d%e7%bd%ae%e9%bb%98%e8%ae%a4%e8%af%ad%e8%a8%80%e4%b8%ba%e4%b8%ad%e6%96%87" aria-label="配置默认语言为中文">配置默认语言为中文</a></li>
                    <li>
                        <a href="#%e6%97%a5%e6%9c%9f%e6%a0%bc%e5%bc%8f%e6%98%be%e7%a4%ba%e4%bc%98%e5%8c%96" aria-label="日期格式显示优化">日期格式显示优化</a></li>
                    <li>
                        <a href="#%e6%a0%87%e7%ad%be%e9%a1%b5%e6%b7%bb%e5%8a%a0%e8%af%8d%e4%ba%91" aria-label="标签页添加词云">标签页添加词云</a></li>
                    <li>
                        <a href="#url%e7%ae%a1%e7%90%86" aria-label="url管理">url管理</a></li>
                    <li>
                        <a href="#%e4%b8%ba%e6%96%87%e7%ab%a0%e6%b7%bb%e5%8a%a0%e8%bf%87%e6%9c%9f%e6%8f%90%e7%a4%ba" aria-label="为文章添加过期提示">为文章添加过期提示</a>
                    </li>
                </ul>
                </li>
                </ul>
            </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    
    document.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();
    
        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
        if (elements.length > 0) {
            
            activeElement = elements[0];
            const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
            document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
        }
    
        
        const topLink = document.getElementById('top-link');
        if (topLink) {
            topLink.addEventListener('click', (event) => {
                
                event.preventDefault();
    
                
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        }
    }, false);
    
    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);
    
    window.addEventListener('scroll', () => {
        
        const scrollPosition = window.pageYOffset || document.documentElement.scrollTop;
    
        
        if (scrollPosition === 0) {
            return;
        }
    
        
        if (elements && elements.length > 0) {
            
            activeElement = Array.from(elements).find((element) => {
                if ((getOffsetTop(element) - scrollPosition) > 0 && 
                    (getOffsetTop(element) - scrollPosition) < window.innerHeight / 2) {
                    return element;
                }
            }) || activeElement;
    
            elements.forEach(element => {
                const id = encodeURI(element.getAttribute('id')).toLowerCase();
                const tocLink = document.querySelector(`.inner ul li a[href="#${id}"]`);
                if (element === activeElement){
                    tocLink.classList.add('active');
    
                    
                    const tocContainer = document.querySelector('.toc .inner');
                    const linkOffsetTop = tocLink.offsetTop;
                    const containerHeight = tocContainer.clientHeight;
                    const linkHeight = tocLink.clientHeight;
    
                    
                    const scrollPosition = linkOffsetTop - (containerHeight / 2) + (linkHeight / 2);
                    tocContainer.scrollTo({ top: scrollPosition, behavior: 'smooth' });
                } else {
                    tocLink.classList.remove('active');
                }
            });
        }
    }, false);
    
    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);
    
    function checkTocPosition() {
        const width = document.body.scrollWidth;
    
        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }
    
    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;   
    }
    
</script>

  <div class="post-content"><blockquote>
<p>装修一下旧时代的船，才能开门迎接更多的客人。</p>
</blockquote>
<h1 id="前言">前言<a hidden class="anchor" aria-hidden="true" href="#前言">#</a></h1>
<p>搭建完博客之后，总是会觉得这不满意，然后在搭建过程中，用相同的建站工具和主题搜索，会发现网上有很多大佬已经搭建好的站点，就会这个功能也想要，那个功能也想要。在这里，我记录了一些我搭建过程中进行基础功能拓展和美化的过程。希望可以帮助到有缘人~</p>
<p>以下教程为进阶版的简略教程，需要你有比较扎实的编程基础（或者不爱思考的脑袋），很多教程来自网上其他大佬，由于看了太多的教程，链接引用不全请见谅，如果有大佬看到了可以联系我加上。</p>
<p>以下修改html和css的代码都不建议在themes文件夹直接修改，html可以在layout目录下新建同名文件（复制过来改），css可以在assets目录下新建，最终构建都会打包到public中并使用自定义的覆盖主题文件夹中的内容。</p>
<h1 id="拓展功能">拓展功能<a hidden class="anchor" aria-hidden="true" href="#拓展功能">#</a></h1>
<h2 id="评论">评论<a hidden class="anchor" aria-hidden="true" href="#评论">#</a></h2>
<h3 id="gisucs">Gisucs<a hidden class="anchor" aria-hidden="true" href="#gisucs">#</a></h3>
<p>选用Gisucs作为评论服务，最开始我的选择是Gisucs，但是后来我放弃了。Github作为存储虽然是全免费，非常优雅，但是要求评论者拥有一个Github账号对于用于体验实在是不太友好。</p>
<h4 id="github配置">Github配置<a hidden class="anchor" aria-hidden="true" href="#github配置">#</a></h4>
<p>参考链接： <a href="https://giscus.app/zh-CN#repository">https://giscus.app/zh-CN#repository</a></p>
<ol>
<li>在某个Github公开仓库开启discussion功能（settings进入）</li>
<li>在Github安装Gisucs APP</li>
<li>记录生成的配置和代码，需要配置到自己的项目中</li>
</ol>
<h4 id="hugo配置">Hugo配置<a hidden class="anchor" aria-hidden="true" href="#hugo配置">#</a></h4>
<p>参考链接： <a href="https://www.tofuwine.cn/posts/610b75f5/#pe-comments">https://www.tofuwine.cn/posts/610b75f5/#pe-comments</a></p>
<ol>
<li>添加文件 <code>layouts/partials/comments.html</code>,输入以下内容</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;comments-title&#34;</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;tw-comment-title&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">p</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;x-comments-title&#34;</span>&gt;{{- .Param &#34;giscus.discussionTitle&#34; }}&lt;/<span style="color:#f92672">p</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">p</span> <span style="color:#a6e22e">style</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;font-size: 1rem&#34;</span>&gt;{{- .Param &#34;giscus.discussionSubtitle&#34; }} &lt;/<span style="color:#f92672">p</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;tw-comment&#34;</span>&gt;&lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">getStoredTheme</span> <span style="color:#f92672">=</span> () =&gt; <span style="color:#a6e22e">localStorage</span>.<span style="color:#a6e22e">getItem</span>(<span style="color:#e6db74">&#34;pref-theme&#34;</span>) <span style="color:#f92672">===</span> <span style="color:#e6db74">&#34;dark&#34;</span> <span style="color:#f92672">?</span> <span style="color:#e6db74">&#34;{{ .Site.Params.giscus.darkTheme }}&#34;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;{{ .Site.Params.giscus.lightTheme }}&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">setGiscusTheme</span> <span style="color:#f92672">=</span> () =&gt; {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sendMessage</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">message</span>) =&gt; {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">iframe</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">querySelector</span>(<span style="color:#e6db74">&#39;iframe.giscus-frame&#39;</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">iframe</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">iframe</span>.<span style="color:#a6e22e">contentWindow</span>.<span style="color:#a6e22e">postMessage</span>({<span style="color:#a6e22e">giscus</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">message</span>}, <span style="color:#e6db74">&#39;https://giscus.app&#39;</span>);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">sendMessage</span>({<span style="color:#a6e22e">setConfig</span><span style="color:#f92672">:</span> {<span style="color:#a6e22e">theme</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">getStoredTheme</span>()}})
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    document.<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#34;DOMContentLoaded&#34;</span>, () =&gt; {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">giscusAttributes</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;src&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;https://giscus.app/client.js&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;data-repo&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;{{ .Site.Params.giscus.repo }}&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;data-repo-id&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;{{ .Site.Params.giscus.repoId }}&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;data-category&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;{{ .Site.Params.giscus.category }}&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;data-category-id&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;{{ .Site.Params.giscus.categoryId }}&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;data-mapping&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;{{ .Site.Params.giscus.mapping  }}&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;data-strict&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;{{ .Site.Params.giscus.strict  }}&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;data-reactions-enabled&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;{{ .Site.Params.giscus.reactionsEnabled}}&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;data-emit-metadata&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;{{ .Site.Params.giscus.emitMetadata  }}&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;data-input-position&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;{{ .Site.Params.giscus.inputPosition }}&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;data-theme&#34;</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">getStoredTheme</span>(),
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;data-lang&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;{{ .Site.Params.giscus.lang }}&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;data-loading&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;lazy&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;crossorigin&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;anonymous&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;async&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// 动态创建 giscus script
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">giscusScript</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">createElement</span>(<span style="color:#e6db74">&#34;script&#34;</span>);
</span></span><span style="display:flex;"><span>        Object.<span style="color:#a6e22e">entries</span>(<span style="color:#a6e22e">giscusAttributes</span>).<span style="color:#a6e22e">forEach</span>(
</span></span><span style="display:flex;"><span>                ([<span style="color:#a6e22e">key</span>, <span style="color:#a6e22e">value</span>]) =&gt; <span style="color:#a6e22e">giscusScript</span>.<span style="color:#a6e22e">setAttribute</span>(<span style="color:#a6e22e">key</span>, <span style="color:#a6e22e">value</span>));
</span></span><span style="display:flex;"><span>        document.<span style="color:#a6e22e">querySelector</span>(<span style="color:#e6db74">&#34;#tw-comment&#34;</span>).<span style="color:#a6e22e">appendChild</span>(<span style="color:#a6e22e">giscusScript</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// 页面主题变更后，变更 giscus 主题
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">themeSwitcher</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">querySelector</span>(<span style="color:#e6db74">&#34;#theme-toggle&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">themeSwitcher</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">themeSwitcher</span>.<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#34;click&#34;</span>, <span style="color:#a6e22e">setGiscusTheme</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">themeFloatSwitcher</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">querySelector</span>(<span style="color:#e6db74">&#34;#theme-toggle-float&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">themeFloatSwitcher</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">themeFloatSwitcher</span>.<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#34;click&#34;</span>, <span style="color:#a6e22e">setGiscusTheme</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">script</span>&gt;
</span></span></code></pre></div><ol start="2">
<li>添加文件 <code>assets/css/extended/comments.css</code>,输入以下内容</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-css" data-lang="css"><span style="display:flex;"><span><span style="color:#75715e">/* giscus 评论组件 */</span>
</span></span><span style="display:flex;"><span>.<span style="color:#a6e22e">comments-title</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">margin-top</span>: <span style="color:#ae81ff">2</span><span style="color:#66d9ef">rem</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">margin-bottom</span>: <span style="color:#ae81ff">2</span><span style="color:#66d9ef">rem</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">display</span>: <span style="color:#66d9ef">block</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">text-align</span>: <span style="color:#66d9ef">center</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>.<span style="color:#a6e22e">x-comments-title</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">display</span>: <span style="color:#66d9ef">block</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">font-size</span>: <span style="color:#ae81ff">1.25</span><span style="color:#66d9ef">em</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">font-weight</span>: <span style="color:#ae81ff">700</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">padding</span>: <span style="color:#ae81ff">1.5</span><span style="color:#66d9ef">rem</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">.5</span><span style="color:#66d9ef">rem</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ol start="3">
<li>在 <code>hugo.yaml</code> 中添加内容，其中 <code>{{}}</code> 包裹的需要替换成自己的内容，内容在Gisucs会生成</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>  <span style="color:#f92672">giscus</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">repo</span>: <span style="color:#e6db74">&#34;{{ REPO }}&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">repoId</span>: <span style="color:#e6db74">&#34;{ REPO_ID }&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">category</span>: <span style="color:#e6db74">&#34;Announcements&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">categoryId</span>: <span style="color:#e6db74">&#34;{{ CATEGORYID }}&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">mapping</span>: <span style="color:#e6db74">&#34;pathname&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">strict</span>: <span style="color:#e6db74">&#34;0&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">reactionsEnabled</span>: <span style="color:#e6db74">&#34;1&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">emitMetadata</span>: <span style="color:#e6db74">&#34;0&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">inputPosition</span>: <span style="color:#e6db74">&#34;bottom&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">lightTheme</span>: <span style="color:#e6db74">&#34;light&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">darkTheme</span>: <span style="color:#e6db74">&#34;dark&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">lang</span>: <span style="color:#e6db74">&#34;zh-CN&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">discussionTitle</span>: <span style="color:#ae81ff">欢迎来到评论区</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">discussionSubtitle</span>: <span style="color:#ae81ff">感谢您的耐心阅读！如需交流，请留个评论吧！</span>
</span></span></code></pre></div><ol start="4">
<li>在 <code>archetypes/default.md</code> 中添加配置 <code>comments: true</code> 来开启评论区，已有的博客也需要修改这个来开启</li>
</ol>
<h3 id="twikoo">Twikoo<a hidden class="anchor" aria-hidden="true" href="#twikoo">#</a></h3>
<p><a href="https://twikoo.js.org/intro.html">Twikoo 官网</a></p>
<p>因为Gisucs要求评论者具有Github账号有点使用者不太友好，所以后面更换了一个Twikoo</p>
<p>Twikoo的整体可以看作是一个CSS的架构，C-Hugo站点的静态JS代码，S-云函数，S-MonogoDB数据库。Twikoo的官方是懂我们这些穷鬼的，提供了很多免费部署的教程。我这边就按照官方推荐度最高的方法进行部署。MonogoDB选择MongoDB Atlas，有500MB的免费额度。Netlify部署云函数，每月 125,000 请求次数和 100 小时函数计算时长，看上去是完全够了。</p>
<h4 id="mongodb-atlas-申请资源">MongoDB Atlas 申请资源<a hidden class="anchor" aria-hidden="true" href="#mongodb-atlas-申请资源">#</a></h4>
<p><a href="https://cloud.mongodb.com">MongoDB Atlas</a></p>
<p>按照Twikoo官网指导，申请一个账号和500MB空间的MonogoDB数据库。</p>
<ol>
<li>注册MongoDB Atlas账号</li>
<li>无脑下一步，创建一个MonogoDB实例，这里创建数据库用户的时候密码记住，后面要用</li>
<li>修改Network Access为 0.0.0.0 允许所有IP访问</li>
<li>在connect中查看代码示例，选Node.js可以看到连接串，把数据库用户密码替换进去，把整个URL复制下来，等部署云函数的时候有用</li>
</ol>
<h4 id="netlify-部署云函数">Netlify 部署云函数<a hidden class="anchor" aria-hidden="true" href="#netlify-部署云函数">#</a></h4>
<p><a href="https://www.netlify.com/">Netlify</a></p>
<ol>
<li>注册Netlify账号，注册的时候需要提供身份验证（有点恶心人了），密码需要设置得复杂一点，不然直接不给登录也不提示，我通过忘记密码改了一个很复杂的~~（时隔三天来校验博客的时候我已经忘记了，但是没关系，浏览器替我记住了）~~</li>
<li>Fork官方的仓到自己的Github，从仓库部署站点，环境变量中填入 <code>MONGODB_URI</code> 值为MonoDB Atlas中复制出来的URL</li>
<li>点xxx.netlify.app进入页面，看到云函数正常运行就是部署成功了</li>
</ol>
<h4 id="前端部署">前端部署<a hidden class="anchor" aria-hidden="true" href="#前端部署">#</a></h4>
<p>需要把前端JS嵌入到Hugo的Html页面中，在 <code>layout/comments.html</code> 文件中添加代码 （如果有其他评论组件请自行删除）</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;tcomment&#34;</span>&gt;&lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">script</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://cdn.jsdelivr.net/npm/twikoo@1.6.40/dist/twikoo.all.min.js&#34;</span>&gt;&lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">twikoo</span>.<span style="color:#a6e22e">init</span>({
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">envId</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;https://xxx.netlify.app/.netlify/functions/twikoo&#39;</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">el</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;#tcomment&#39;</span>, <span style="color:#75715e">// 容器元素
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>})
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">script</span>&gt;
</span></span></code></pre></div><h4 id="使用配置">使用配置<a hidden class="anchor" aria-hidden="true" href="#使用配置">#</a></h4>
<ol>
<li>进入管理员界面，首次进入配置密码</li>
<li>配置邮箱通知，Hotmail配置了无法测试通过，暂时没找到原因，后来配置了一个163的邮箱（需要填授权码，听说qq更方便一点，gmail没有尝试）</li>
<li>反垃圾配置，使用默认的反垃圾服务 <a href="https://akismet.com/">akismet</a>，支付一个0元账单就可以获得一个APPKey，填入配置里面就好</li>
<li>头像服务，默认的 <a href="https://weavatar.com/">weavatar</a>，注册一个账号，上传一个自己喜欢的头像。但是这边遇到了一个比较奇怪的问题，同时输入昵称和邮箱，头像就会读取失败（但是后来发现生产上好像可以），所以我在通用设置里面把必填字段改成了只填邮箱，因为昵称填QQ号会自动生成qq邮箱。</li>
</ol>
<h2 id="侧面显示目录">侧面显示目录<a hidden class="anchor" aria-hidden="true" href="#侧面显示目录">#</a></h2>
<p>参考资料： <a href="https://www.zhouxin.space/logs/introduce-side-toc-and-reading-percentage-to-papermod/">https://www.zhouxin.space/logs/introduce-side-toc-and-reading-percentage-to-papermod/</a></p>
<ol>
<li>创建文件 <code>layouts/partials/toc.html</code> 输入以下代码（代码全是抄的，别问我为什么这么写）</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>{{- $headers := findRE &#34;&lt;<span style="color:#f92672">h</span><span style="color:#960050;background-color:#1e0010">[</span><span style="color:#a6e22e">1-6</span><span style="color:#960050;background-color:#1e0010">].*?</span>&gt;(.|\n])+?<span style="color:#960050;background-color:#1e0010">&lt;</span>/h[1-6]&gt;&#34; .Content -}}
</span></span><span style="display:flex;"><span>{{- $has_headers := ge (len $headers) 1 -}}
</span></span><span style="display:flex;"><span>{{- if $has_headers -}}
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">aside</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;toc-container&#34;</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;toc-container wide&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;toc&#34;</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">details</span> <span style="color:#960050;background-color:#1e0010">{{</span><span style="color:#a6e22e">if</span> <span style="color:#960050;background-color:#1e0010">(.</span><span style="color:#a6e22e">Param</span> <span style="color:#960050;background-color:#1e0010">&#34;</span><span style="color:#a6e22e">TocOpen</span><span style="color:#960050;background-color:#1e0010">&#34;)</span> <span style="color:#960050;background-color:#1e0010">}}</span> <span style="color:#a6e22e">open</span><span style="color:#960050;background-color:#1e0010">{{</span> <span style="color:#a6e22e">end</span> <span style="color:#960050;background-color:#1e0010">}}</span>&gt;
</span></span><span style="display:flex;"><span>            &lt;<span style="color:#f92672">summary</span> <span style="color:#a6e22e">accesskey</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;c&#34;</span> <span style="color:#a6e22e">title</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;(Alt + C)&#34;</span>&gt;
</span></span><span style="display:flex;"><span>                &lt;<span style="color:#f92672">span</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;details&#34;</span>&gt;{{- i18n &#34;toc&#34; | default &#34;Table of Contents&#34; }}&lt;/<span style="color:#f92672">span</span>&gt;
</span></span><span style="display:flex;"><span>            &lt;/<span style="color:#f92672">summary</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;inner&#34;</span>&gt;
</span></span><span style="display:flex;"><span>                {{- $largest := 6 -}}
</span></span><span style="display:flex;"><span>                {{- range $headers -}}
</span></span><span style="display:flex;"><span>                {{- $headerLevel := index (findRE &#34;[1-6]&#34; . 1) 0 -}}
</span></span><span style="display:flex;"><span>                {{- $headerLevel := len (seq $headerLevel) -}}
</span></span><span style="display:flex;"><span>                {{- if lt $headerLevel $largest -}}
</span></span><span style="display:flex;"><span>                {{- $largest = $headerLevel -}}
</span></span><span style="display:flex;"><span>                {{- end -}}
</span></span><span style="display:flex;"><span>                {{- end -}}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                {{- $firstHeaderLevel := len (seq (index (findRE &#34;[1-6]&#34; (index $headers 0) 1) 0)) -}}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                {{- $.Scratch.Set &#34;bareul&#34; slice -}}
</span></span><span style="display:flex;"><span>                &lt;<span style="color:#f92672">ul</span>&gt;
</span></span><span style="display:flex;"><span>                    {{- range seq (sub $firstHeaderLevel $largest) -}}
</span></span><span style="display:flex;"><span>                    &lt;<span style="color:#f92672">ul</span>&gt;
</span></span><span style="display:flex;"><span>                        {{- $.Scratch.Add &#34;bareul&#34; (sub (add $largest .) 1) -}}
</span></span><span style="display:flex;"><span>                        {{- end -}}
</span></span><span style="display:flex;"><span>                        {{- range $i, $header := $headers -}}
</span></span><span style="display:flex;"><span>                        {{- $headerLevel := index (findRE &#34;[1-6]&#34; . 1) 0 -}}
</span></span><span style="display:flex;"><span>                        {{- $headerLevel := len (seq $headerLevel) -}}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                        {{/* get id=&#34;xyz&#34; */}}
</span></span><span style="display:flex;"><span>                        {{- $id := index (findRE &#34;(id=\&#34;(.*?)\&#34;)&#34; $header 9) 0 }}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                        {{- /* strip id=&#34;&#34; to leave xyz, no way to get regex capturing groups in hugo */ -}}
</span></span><span style="display:flex;"><span>                        {{- $cleanedID := replace (replace $id &#34;id=\&#34;&#34; &#34;&#34;) &#34;\&#34;&#34; &#34;&#34; }}
</span></span><span style="display:flex;"><span>                        {{- $header := replaceRE &#34;&lt;<span style="color:#f92672">h</span><span style="color:#960050;background-color:#1e0010">[</span><span style="color:#a6e22e">1-6</span><span style="color:#960050;background-color:#1e0010">].*?</span>&gt;((.|\n])+?)<span style="color:#960050;background-color:#1e0010">&lt;</span>/h[1-6]&gt;&#34; &#34;$1&#34; $header -}}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                        {{- if ne $i 0 -}}
</span></span><span style="display:flex;"><span>                        {{- $prevHeaderLevel := index (findRE &#34;[1-6]&#34; (index $headers (sub $i 1)) 1) 0 -}}
</span></span><span style="display:flex;"><span>                        {{- $prevHeaderLevel := len (seq $prevHeaderLevel) -}}
</span></span><span style="display:flex;"><span>                        {{- if gt $headerLevel $prevHeaderLevel -}}
</span></span><span style="display:flex;"><span>                        {{- range seq $prevHeaderLevel (sub $headerLevel 1) -}}
</span></span><span style="display:flex;"><span>                        &lt;<span style="color:#f92672">ul</span>&gt;
</span></span><span style="display:flex;"><span>                            {{/* the first should not be recorded */}}
</span></span><span style="display:flex;"><span>                            {{- if ne $prevHeaderLevel . -}}
</span></span><span style="display:flex;"><span>                            {{- $.Scratch.Add &#34;bareul&#34; . -}}
</span></span><span style="display:flex;"><span>                            {{- end -}}
</span></span><span style="display:flex;"><span>                            {{- end -}}
</span></span><span style="display:flex;"><span>                            {{- else -}}
</span></span><span style="display:flex;"><span>                            &lt;/<span style="color:#f92672">li</span>&gt;
</span></span><span style="display:flex;"><span>                            {{- if lt $headerLevel $prevHeaderLevel -}}
</span></span><span style="display:flex;"><span>                            {{- range seq (sub $prevHeaderLevel 1) -1 $headerLevel -}}
</span></span><span style="display:flex;"><span>                            {{- if in ($.Scratch.Get &#34;bareul&#34;) . -}}
</span></span><span style="display:flex;"><span>                        &lt;/<span style="color:#f92672">ul</span>&gt;
</span></span><span style="display:flex;"><span>                        {{/* manually do pop item */}}
</span></span><span style="display:flex;"><span>                        {{- $tmp := $.Scratch.Get &#34;bareul&#34; -}}
</span></span><span style="display:flex;"><span>                        {{- $.Scratch.Delete &#34;bareul&#34; -}}
</span></span><span style="display:flex;"><span>                        {{- $.Scratch.Set &#34;bareul&#34; slice}}
</span></span><span style="display:flex;"><span>                        {{- range seq (sub (len $tmp) 1) -}}
</span></span><span style="display:flex;"><span>                        {{- $.Scratch.Add &#34;bareul&#34; (index $tmp (sub . 1)) -}}
</span></span><span style="display:flex;"><span>                        {{- end -}}
</span></span><span style="display:flex;"><span>                        {{- else -}}
</span></span><span style="display:flex;"><span>                    &lt;/<span style="color:#f92672">ul</span>&gt;
</span></span><span style="display:flex;"><span>                    &lt;/<span style="color:#f92672">li</span>&gt;
</span></span><span style="display:flex;"><span>                    {{- end -}}
</span></span><span style="display:flex;"><span>                    {{- end -}}
</span></span><span style="display:flex;"><span>                    {{- end -}}
</span></span><span style="display:flex;"><span>                    {{- end }}
</span></span><span style="display:flex;"><span>                    &lt;<span style="color:#f92672">li</span>&gt;
</span></span><span style="display:flex;"><span>                        &lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;#{{- $cleanedID -}}&#34;</span> <span style="color:#a6e22e">aria-label</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;{{- $header | plainify -}}&#34;</span>&gt;{{- $header | safeHTML -}}&lt;/<span style="color:#f92672">a</span>&gt;
</span></span><span style="display:flex;"><span>                        {{- else }}
</span></span><span style="display:flex;"><span>                    &lt;<span style="color:#f92672">li</span>&gt;
</span></span><span style="display:flex;"><span>                        &lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;#{{- $cleanedID -}}&#34;</span> <span style="color:#a6e22e">aria-label</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;{{- $header | plainify -}}&#34;</span>&gt;{{- $header | safeHTML -}}&lt;/<span style="color:#f92672">a</span>&gt;
</span></span><span style="display:flex;"><span>                        {{- end -}}
</span></span><span style="display:flex;"><span>                        {{- end -}}
</span></span><span style="display:flex;"><span>                        <span style="color:#75715e">&lt;!-- {{- $firstHeaderLevel := len (seq (index (findRE &#34;[1-6]&#34; (index $headers 0) 1) 0)) -}} --&gt;</span>
</span></span><span style="display:flex;"><span>                        {{- $firstHeaderLevel := $largest }}
</span></span><span style="display:flex;"><span>                        {{- $lastHeaderLevel := len (seq (index (findRE &#34;[1-6]&#34; (index $headers (sub (len $headers) 1)) 1) 0)) }}
</span></span><span style="display:flex;"><span>                    &lt;/<span style="color:#f92672">li</span>&gt;
</span></span><span style="display:flex;"><span>                    {{- range seq (sub $lastHeaderLevel $firstHeaderLevel) -}}
</span></span><span style="display:flex;"><span>                    {{- if in ($.Scratch.Get &#34;bareul&#34;) (add . $firstHeaderLevel) }}
</span></span><span style="display:flex;"><span>                &lt;/<span style="color:#f92672">ul</span>&gt;
</span></span><span style="display:flex;"><span>                {{- else }}
</span></span><span style="display:flex;"><span>                &lt;/<span style="color:#f92672">ul</span>&gt;
</span></span><span style="display:flex;"><span>                &lt;/<span style="color:#f92672">li</span>&gt;
</span></span><span style="display:flex;"><span>                {{- end -}}
</span></span><span style="display:flex;"><span>                {{- end }}
</span></span><span style="display:flex;"><span>                &lt;/<span style="color:#f92672">ul</span>&gt;
</span></span><span style="display:flex;"><span>            &lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;/<span style="color:#f92672">details</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">aside</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">activeElement</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">elements</span>;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    document.<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#39;DOMContentLoaded&#39;</span>, <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">event</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">checkTocPosition</span>();
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">elements</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">querySelectorAll</span>(<span style="color:#e6db74">&#39;h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]&#39;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">elements</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// Make the first header active
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#a6e22e">activeElement</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">elements</span>[<span style="color:#ae81ff">0</span>];
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">id</span> <span style="color:#f92672">=</span> encodeURI(<span style="color:#a6e22e">activeElement</span>.<span style="color:#a6e22e">getAttribute</span>(<span style="color:#e6db74">&#39;id&#39;</span>)).<span style="color:#a6e22e">toLowerCase</span>();
</span></span><span style="display:flex;"><span>            document.<span style="color:#a6e22e">querySelector</span>(<span style="color:#e6db74">`.inner ul li a[href=&#34;#</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">id</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;]`</span>).<span style="color:#a6e22e">classList</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">&#39;active&#39;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Add event listener for the &#34;back to top&#34; link
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">topLink</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#39;top-link&#39;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">topLink</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">topLink</span>.<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#39;click&#39;</span>, (<span style="color:#a6e22e">event</span>) =&gt; {
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// Prevent the default action
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#a6e22e">event</span>.<span style="color:#a6e22e">preventDefault</span>();
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>                <span style="color:#75715e">// Smooth scroll to the top
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                window.<span style="color:#a6e22e">scrollTo</span>({ <span style="color:#a6e22e">top</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">behavior</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;smooth&#39;</span> });
</span></span><span style="display:flex;"><span>            });
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }, <span style="color:#66d9ef">false</span>);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    window.<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#39;resize&#39;</span>, <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">event</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">checkTocPosition</span>();
</span></span><span style="display:flex;"><span>    }, <span style="color:#66d9ef">false</span>);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    window.<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#39;scroll&#39;</span>, () =&gt; {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Get the current scroll position
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">scrollPosition</span> <span style="color:#f92672">=</span> window.<span style="color:#a6e22e">pageYOffset</span> <span style="color:#f92672">||</span> document.<span style="color:#a6e22e">documentElement</span>.<span style="color:#a6e22e">scrollTop</span>;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Check if the scroll position is at the top of the page
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">scrollPosition</span> <span style="color:#f92672">===</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Ensure elements is a valid NodeList
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">elements</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">elements</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// Check if there is an object in the top half of the screen or keep the last item active
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#a6e22e">activeElement</span> <span style="color:#f92672">=</span> Array.<span style="color:#a6e22e">from</span>(<span style="color:#a6e22e">elements</span>).<span style="color:#a6e22e">find</span>((<span style="color:#a6e22e">element</span>) =&gt; {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> ((<span style="color:#a6e22e">getOffsetTop</span>(<span style="color:#a6e22e">element</span>) <span style="color:#f92672">-</span> <span style="color:#a6e22e">scrollPosition</span>) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span> 
</span></span><span style="display:flex;"><span>                    (<span style="color:#a6e22e">getOffsetTop</span>(<span style="color:#a6e22e">element</span>) <span style="color:#f92672">-</span> <span style="color:#a6e22e">scrollPosition</span>) <span style="color:#f92672">&lt;</span> window.<span style="color:#a6e22e">innerHeight</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>) {
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">element</span>;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }) <span style="color:#f92672">||</span> <span style="color:#a6e22e">activeElement</span>;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">elements</span>.<span style="color:#a6e22e">forEach</span>(<span style="color:#a6e22e">element</span> =&gt; {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">id</span> <span style="color:#f92672">=</span> encodeURI(<span style="color:#a6e22e">element</span>.<span style="color:#a6e22e">getAttribute</span>(<span style="color:#e6db74">&#39;id&#39;</span>)).<span style="color:#a6e22e">toLowerCase</span>();
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">tocLink</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">querySelector</span>(<span style="color:#e6db74">`.inner ul li a[href=&#34;#</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">id</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;]`</span>);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">element</span> <span style="color:#f92672">===</span> <span style="color:#a6e22e">activeElement</span>){
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">tocLink</span>.<span style="color:#a6e22e">classList</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">&#39;active&#39;</span>);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// Ensure the active element is in view within the .inner container
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">tocContainer</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">querySelector</span>(<span style="color:#e6db74">&#39;.toc .inner&#39;</span>);
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">linkOffsetTop</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">tocLink</span>.<span style="color:#a6e22e">offsetTop</span>;
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">containerHeight</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">tocContainer</span>.<span style="color:#a6e22e">clientHeight</span>;
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">linkHeight</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">tocLink</span>.<span style="color:#a6e22e">clientHeight</span>;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// Calculate the scroll position to center the active link
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">scrollPosition</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">linkOffsetTop</span> <span style="color:#f92672">-</span> (<span style="color:#a6e22e">containerHeight</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>) <span style="color:#f92672">+</span> (<span style="color:#a6e22e">linkHeight</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>);
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">tocContainer</span>.<span style="color:#a6e22e">scrollTo</span>({ <span style="color:#a6e22e">top</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">scrollPosition</span>, <span style="color:#a6e22e">behavior</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;smooth&#39;</span> });
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">tocLink</span>.<span style="color:#a6e22e">classList</span>.<span style="color:#a6e22e">remove</span>(<span style="color:#e6db74">&#39;active&#39;</span>);
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            });
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }, <span style="color:#66d9ef">false</span>);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">main</span> <span style="color:#f92672">=</span> parseInt(<span style="color:#a6e22e">getComputedStyle</span>(document.<span style="color:#a6e22e">body</span>).<span style="color:#a6e22e">getPropertyValue</span>(<span style="color:#e6db74">&#39;--article-width&#39;</span>), <span style="color:#ae81ff">10</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">toc</span> <span style="color:#f92672">=</span> parseInt(<span style="color:#a6e22e">getComputedStyle</span>(document.<span style="color:#a6e22e">body</span>).<span style="color:#a6e22e">getPropertyValue</span>(<span style="color:#e6db74">&#39;--toc-width&#39;</span>), <span style="color:#ae81ff">10</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">gap</span> <span style="color:#f92672">=</span> parseInt(<span style="color:#a6e22e">getComputedStyle</span>(document.<span style="color:#a6e22e">body</span>).<span style="color:#a6e22e">getPropertyValue</span>(<span style="color:#e6db74">&#39;--gap&#39;</span>), <span style="color:#ae81ff">10</span>);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">checkTocPosition</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">width</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">body</span>.<span style="color:#a6e22e">scrollWidth</span>;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">width</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">main</span> <span style="color:#f92672">-</span> (<span style="color:#a6e22e">toc</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>) <span style="color:#f92672">-</span> (<span style="color:#a6e22e">gap</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">4</span>) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>            document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#34;toc-container&#34;</span>).<span style="color:#a6e22e">classList</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">&#34;wide&#34;</span>);
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>            document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#34;toc-container&#34;</span>).<span style="color:#a6e22e">classList</span>.<span style="color:#a6e22e">remove</span>(<span style="color:#e6db74">&#34;wide&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getOffsetTop</span>(<span style="color:#a6e22e">element</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">element</span>.<span style="color:#a6e22e">getClientRects</span>().<span style="color:#a6e22e">length</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">rect</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">element</span>.<span style="color:#a6e22e">getBoundingClientRect</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">win</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">element</span>.<span style="color:#a6e22e">ownerDocument</span>.<span style="color:#a6e22e">defaultView</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">rect</span>.<span style="color:#a6e22e">top</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">win</span>.<span style="color:#a6e22e">pageYOffset</span>;   
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>{{- end }}
</span></span></code></pre></div><ol start="2">
<li>创建 <code>assets/css/extended/toc.css</code> 文件，并输入以下内容（也是抄的，感谢大佬，赞美大佬）</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-css" data-lang="css"><span style="display:flex;"><span>:<span style="color:#a6e22e">root</span> {
</span></span><span style="display:flex;"><span>    --nav-width: <span style="color:#ae81ff">1380</span><span style="color:#66d9ef">px</span>;
</span></span><span style="display:flex;"><span>    --article-width: <span style="color:#ae81ff">650</span><span style="color:#66d9ef">px</span>;
</span></span><span style="display:flex;"><span>    --toc-width: <span style="color:#ae81ff">300</span><span style="color:#66d9ef">px</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>.<span style="color:#a6e22e">toc</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">margin</span>: <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">2</span><span style="color:#66d9ef">px</span> <span style="color:#ae81ff">40</span><span style="color:#66d9ef">px</span> <span style="color:#ae81ff">2</span><span style="color:#66d9ef">px</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">border</span>: <span style="color:#ae81ff">1</span><span style="color:#66d9ef">px</span> <span style="color:#66d9ef">solid</span> <span style="color:#a6e22e">var</span>(<span style="color:#f92672">--</span>border);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">background</span>: <span style="color:#a6e22e">var</span>(<span style="color:#f92672">--</span>entry);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">border-radius</span>: <span style="color:#a6e22e">var</span>(<span style="color:#f92672">--</span>radius);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">padding</span>: <span style="color:#ae81ff">0.4</span><span style="color:#66d9ef">em</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>.<span style="color:#a6e22e">toc-container</span>.<span style="color:#a6e22e">wide</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">position</span>: <span style="color:#66d9ef">absolute</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">height</span>: <span style="color:#ae81ff">100</span><span style="color:#66d9ef">%</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">border-right</span>: <span style="color:#ae81ff">1</span><span style="color:#66d9ef">px</span> <span style="color:#66d9ef">solid</span> <span style="color:#a6e22e">var</span>(<span style="color:#f92672">--</span>border);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">left</span>: calc((<span style="color:#a6e22e">var</span>(<span style="color:#f92672">--</span>toc<span style="color:#f92672">-</span>width) <span style="color:#f92672">+</span> <span style="color:#a6e22e">var</span>(<span style="color:#f92672">--</span>gap)) <span style="color:#f92672">*</span> <span style="color:#ae81ff">-1</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">top</span>: calc(<span style="color:#a6e22e">var</span>(<span style="color:#f92672">--</span>gap) <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">width</span>: <span style="color:#a6e22e">var</span>(<span style="color:#f92672">--</span>toc<span style="color:#f92672">-</span>width);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>.<span style="color:#a6e22e">wide</span> .<span style="color:#a6e22e">toc</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">position</span>: <span style="color:#66d9ef">sticky</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">top</span>: <span style="color:#a6e22e">var</span>(<span style="color:#f92672">--</span>gap);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">border</span>: <span style="color:#66d9ef">unset</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">background</span>: <span style="color:#66d9ef">unset</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">border-radius</span>: <span style="color:#66d9ef">unset</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">width</span>: <span style="color:#ae81ff">100</span><span style="color:#66d9ef">%</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">margin</span>: <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">2</span><span style="color:#66d9ef">px</span> <span style="color:#ae81ff">40</span><span style="color:#66d9ef">px</span> <span style="color:#ae81ff">2</span><span style="color:#66d9ef">px</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>.<span style="color:#a6e22e">toc</span> <span style="color:#f92672">details</span> <span style="color:#f92672">summary</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">cursor</span>: <span style="color:#66d9ef">zoom-in</span>;
</span></span><span style="display:flex;"><span>    margin-inline-start: <span style="color:#ae81ff">20</span><span style="color:#66d9ef">px</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">padding</span>: <span style="color:#ae81ff">12</span><span style="color:#66d9ef">px</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>.<span style="color:#a6e22e">toc</span> <span style="color:#f92672">details</span><span style="color:#f92672">[</span><span style="color:#f92672">open</span><span style="color:#f92672">]</span> <span style="color:#f92672">summary</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">font-weight</span>: <span style="color:#ae81ff">500</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>.<span style="color:#a6e22e">toc-container</span>.<span style="color:#a6e22e">wide</span> .<span style="color:#a6e22e">toc</span> .<span style="color:#a6e22e">inner</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">margin</span>: <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>.<span style="color:#a6e22e">active</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">font-size</span>: <span style="color:#ae81ff">110</span><span style="color:#66d9ef">%</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">font-weight</span>: <span style="color:#ae81ff">600</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>.<span style="color:#a6e22e">toc</span> <span style="color:#f92672">ul</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">list-style-type</span>: <span style="color:#66d9ef">circle</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>.<span style="color:#a6e22e">toc</span> .<span style="color:#a6e22e">inner</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">margin</span>: <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">20</span><span style="color:#66d9ef">px</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">padding</span>: <span style="color:#ae81ff">0</span><span style="color:#66d9ef">px</span> <span style="color:#ae81ff">15</span><span style="color:#66d9ef">px</span> <span style="color:#ae81ff">15</span><span style="color:#66d9ef">px</span> <span style="color:#ae81ff">20</span><span style="color:#66d9ef">px</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">font-size</span>: <span style="color:#ae81ff">16</span><span style="color:#66d9ef">px</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/*目录显示高度*/</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">max-height</span>: <span style="color:#ae81ff">83</span><span style="color:#66d9ef">vh</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">overflow-y</span>: <span style="color:#66d9ef">auto</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>.<span style="color:#a6e22e">toc</span> .<span style="color:#a6e22e">inner</span>::<span style="color:#a6e22e">-webkit-scrollbar-thumb</span> {  <span style="color:#75715e">/*滚动条*/</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">background</span>: <span style="color:#a6e22e">var</span>(<span style="color:#f92672">--</span>border);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">border</span>: <span style="color:#ae81ff">7</span><span style="color:#66d9ef">px</span> <span style="color:#66d9ef">solid</span> <span style="color:#a6e22e">var</span>(<span style="color:#f92672">--</span>theme);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">border-radius</span>: <span style="color:#a6e22e">var</span>(<span style="color:#f92672">--</span>radius);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>.<span style="color:#a6e22e">toc</span> <span style="color:#f92672">li</span> <span style="color:#f92672">ul</span> {
</span></span><span style="display:flex;"><span>    margin-inline-start: calc(<span style="color:#a6e22e">var</span>(<span style="color:#f92672">--</span>gap) <span style="color:#f92672">*</span> <span style="color:#ae81ff">0.5</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">list-style-type</span>: <span style="color:#66d9ef">none</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>.<span style="color:#a6e22e">toc</span> <span style="color:#f92672">li</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">list-style</span>: <span style="color:#66d9ef">none</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">font-size</span>: <span style="color:#ae81ff">0.95</span><span style="color:#66d9ef">rem</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">padding-bottom</span>: <span style="color:#ae81ff">5</span><span style="color:#66d9ef">px</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>.<span style="color:#a6e22e">toc</span> <span style="color:#f92672">li</span> <span style="color:#f92672">a</span>:<span style="color:#a6e22e">hover</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">color</span>: <span style="color:#a6e22e">var</span>(<span style="color:#f92672">--</span>secondary);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ol start="3">
<li>同时在<code>archetypes\default.yml</code>中添加参数</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">showToc</span>: <span style="color:#66d9ef">true</span> <span style="color:#75715e"># 显示目录</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">TocOpen</span>: <span style="color:#66d9ef">true</span> <span style="color:#75715e"># 打开目录</span>
</span></span></code></pre></div><h2 id="pvuv">PV/UV<a hidden class="anchor" aria-hidden="true" href="#pvuv">#</a></h2>
<h3 id="不蒜子busuanzi">不蒜子Busuanzi<a hidden class="anchor" aria-hidden="true" href="#不蒜子busuanzi">#</a></h3>
<p>使用不蒜子Busuanzi进行站点访问统计。
参考链接： <a href="https://blog.kanikig.xyz/hugo-busuanzi/">https://blog.kanikig.xyz/hugo-busuanzi/</a></p>
<ol>
<li>添加文件 <code>layouts\parials\head.html</code> 从主题文件夹 <code>themes\layouts\parials\head.html</code> 中拷贝内容并修改，在Styles上方添加一个if块</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>{{- if site.Params.analytics.naver.SiteVerificationTag }}
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">meta</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;naver-site-verification&#34;</span> <span style="color:#a6e22e">content</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;{{ site.Params.analytics.naver.SiteVerificationTag }}&#34;</span>&gt;
</span></span><span style="display:flex;"><span>{{- end }}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;!-- 以下If块为新增内容 --&gt;</span>
</span></span><span style="display:flex;"><span>{{- if .Site.Params.busuanzi.enable -}}
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">script</span> <span style="color:#a6e22e">async</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js&#34;</span>&gt;&lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">meta</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;referrer&#34;</span> <span style="color:#a6e22e">content</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;no-referrer-when-downgrade&#34;</span>&gt;
</span></span><span style="display:flex;"><span>{{- end -}}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{{- /* Styles */}}
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><ol start="2">
<li>添加文件 <code>layouts\parials\footer.html</code> 从主题文件夹 <code>themes\layouts\parials\footer.html</code> 中拷贝内容并修改，在footer标签内添加一个if块</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>{{- if not (.Param &#34;hideFooter&#34;) }}
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">footer</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;footer&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    {{- if not site.Params.footer.hideCopyright }}
</span></span><span style="display:flex;"><span>    {{- if site.Copyright }}
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">span</span>&gt;{{ site.Copyright | markdownify }}&lt;/<span style="color:#f92672">span</span>&gt;
</span></span><span style="display:flex;"><span>    {{- else }}
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">span</span>&gt;&amp;copy; {{ now.Year }} &lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;{{ &#34;</span><span style="color:#960050;background-color:#1e0010">&#34;</span> <span style="color:#960050;background-color:#1e0010">|</span> <span style="color:#a6e22e">absLangURL</span> <span style="color:#960050;background-color:#1e0010">}}&#34;</span>&gt;{{ site.Title }}&lt;/<span style="color:#f92672">a</span>&gt;&lt;/<span style="color:#f92672">span</span>&gt;
</span></span><span style="display:flex;"><span>    {{- end }}
</span></span><span style="display:flex;"><span>    {{- print &#34; · &#34;}}
</span></span><span style="display:flex;"><span>    {{- end }}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    {{- with site.Params.footer.text }}
</span></span><span style="display:flex;"><span>    {{ . | markdownify }}
</span></span><span style="display:flex;"><span>    {{- print &#34; · &#34;}}
</span></span><span style="display:flex;"><span>    {{- end }}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">&lt;!-- 以下IF块为新增内容 --&gt;</span>
</span></span><span style="display:flex;"><span>    {{ if .Site.Params.busuanzi.enable -}}
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;busuanzi-footer&#34;</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">span</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;busuanzi_container_site_pv&#34;</span>&gt;
</span></span><span style="display:flex;"><span>            本站总访问量&lt;<span style="color:#f92672">span</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;busuanzi_value_site_pv&#34;</span>&gt;&lt;/<span style="color:#f92672">span</span>&gt;次
</span></span><span style="display:flex;"><span>        &lt;/<span style="color:#f92672">span</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">span</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;busuanzi_container_site_uv&#34;</span>&gt;
</span></span><span style="display:flex;"><span>            本站访客数&lt;<span style="color:#f92672">span</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;busuanzi_value_site_uv&#34;</span>&gt;&lt;/<span style="color:#f92672">span</span>&gt;人次
</span></span><span style="display:flex;"><span>        &lt;/<span style="color:#f92672">span</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>    {{- end -}}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">span</span>&gt;
</span></span><span style="display:flex;"><span>        Powered by
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://gohugo.io/&#34;</span> <span style="color:#a6e22e">rel</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;noopener noreferrer&#34;</span> <span style="color:#a6e22e">target</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;_blank&#34;</span>&gt;Hugo&lt;/<span style="color:#f92672">a</span>&gt; <span style="color:#960050;background-color:#1e0010">&amp;</span>
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">a</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://github.com/adityatelange/hugo-PaperMod/&#34;</span> <span style="color:#a6e22e">rel</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;noopener&#34;</span> <span style="color:#a6e22e">target</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;_blank&#34;</span>&gt;PaperMod&lt;/<span style="color:#f92672">a</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">span</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">footer</span>&gt;
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>{{- end }}
</span></span></code></pre></div><ol start="3">
<li>添加文件 <code>layouts\_defaults\single.html</code> 从主题文件夹 <code>themes\layouts\_defaults\single.html</code> 中拷贝内容并修改，在post-meta内添加一个if块</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;post-meta&#34;</span>&gt;
</span></span><span style="display:flex;"><span>      {{- partial &#34;post_meta.html&#34; . -}}
</span></span><span style="display:flex;"><span>      {{- partial &#34;translation_list.html&#34; . -}}
</span></span><span style="display:flex;"><span>      {{- partial &#34;edit_post.html&#34; . -}}
</span></span><span style="display:flex;"><span>      {{- partial &#34;post_canonical.html&#34; . -}}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">&lt;!-- 以下If块为新增内容 --&gt;</span>
</span></span><span style="display:flex;"><span>      {{ if .Site.Params.busuanzi.enable -}}
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;meta-item&#34;</span>&gt;<span style="color:#960050;background-color:#1e0010">&amp;</span>nbsp·<span style="color:#960050;background-color:#1e0010">&amp;</span>nbsp
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">span</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;busuanzi_container_page_pv&#34;</span>&gt;本文阅读量&lt;<span style="color:#f92672">span</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;busuanzi_value_page_pv&#34;</span>&gt;&lt;/<span style="color:#f92672">span</span>&gt;次&lt;/<span style="color:#f92672">span</span>&gt;
</span></span><span style="display:flex;"><span>      &lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>      {{- end }}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><ol start="4">
<li>在<code>hugo.html</code>文件中的param节点中添加开关</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">params</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">busuanzi</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">enable</span>: <span style="color:#66d9ef">true</span>
</span></span></code></pre></div><h3 id="google-analyze">Google Analyze<a hidden class="anchor" aria-hidden="true" href="#google-analyze">#</a></h3>
<p>只需要在 <code>hugo.yaml</code> 中添加以下代码即可，id更换为自己在Google Analytic中申请的跟踪ID</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">services</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">googleAnalytics</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">id</span>: <span style="color:#e6db74">&#34;G-XXXXXXXXXX&#34;</span>
</span></span></code></pre></div><h2 id="时间线">时间线<a hidden class="anchor" aria-hidden="true" href="#时间线">#</a></h2>
<p>添加一个根据时间线排列的归档页面，写的多写的久才有质感。多写写吧！</p>
<ol>
<li>添加 <code>content\archive.md</code> 文件，输入以下内容</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>title: &#34;&#34;
</span></span><span style="display:flex;"><span>layout: &#34;archives&#34;
</span></span><span style="display:flex;"><span>url: &#34;/archives/&#34;
</span></span><span style="display:flex;"><span>summary: archives
</span></span><span style="display:flex;"><span>---
</span></span></code></pre></div><ol start="2">
<li>在 <code>hugo.html</code> 中添加按钮，在 <code>menu.main</code> 节点下新增以下内容</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span>    - <span style="color:#f92672">identifier</span>: <span style="color:#ae81ff">archive</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">时间轴</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">url</span>: <span style="color:#ae81ff">/archives/</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">weight</span>: <span style="color:#ae81ff">11</span>
</span></span></code></pre></div><h2 id="留言板">留言板<a hidden class="anchor" aria-hidden="true" href="#留言板">#</a></h2>
<p>利用评论系统，新增一个Layout来构建一个留言板页面。</p>
<ol>
<li>创建 <code>layouts\message.html</code> 文件输入一下代码（代码从 <code>single.html</code> 中删除了很多东西，简化得到，顺便做了一下标题居中，这回是自己写的了）：</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>{{- define &#34;main&#34; }}
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">article</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;post-single&#34;</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">header</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;post-header&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">h1</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;post-title entry-hint-parent&#34;</span>&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">style</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;margin-left: auto;margin-right: auto;&#34;</span>&gt;
</span></span><span style="display:flex;"><span>        {{ .Title }}
</span></span><span style="display:flex;"><span>      &lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">h1</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#f92672">header</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  {{- if .Content }}
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;post-content&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    {{ .Content }}
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>  {{- end }}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">footer</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;post-footer&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;tcomment&#34;</span>&gt;&lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">script</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://cdn.jsdelivr.net/npm/twikoo@1.6.40/dist/twikoo.all.min.js&#34;</span>&gt;&lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">twikoo</span>.<span style="color:#a6e22e">init</span>({
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">envId</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;xxx&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">el</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;#tcomment&#39;</span>,
</span></span><span style="display:flex;"><span>      })
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#f92672">footer</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">article</span>&gt;
</span></span><span style="display:flex;"><span>{{- end }}
</span></span></code></pre></div><ol start="2">
<li>在命令行中创建一个新的md文件(不要直接新建文件，我试了，编译的时候不会生成文件，会导致404)，输入 <code>hugo new message.md</code>，并在其中输入以下代码</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>title: &#34;💬 留言板&#34;
</span></span><span style="display:flex;"><span>date: &#39;2024-12-13T21:14:22+08:00&#39;
</span></span><span style="display:flex;"><span>draft: false # 默认为草稿模式
</span></span><span style="display:flex;"><span>layout: &#34;message&#34;
</span></span><span style="display:flex;"><span>comments: true # 评论
</span></span><span style="display:flex;"><span>---
</span></span></code></pre></div><ol start="3">
<li>在 <code>hugo.yaml</code> 中新增首页目录，添加以下代码</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>    - <span style="color:#f92672">identifier</span>: <span style="color:#ae81ff">message</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">💬 留言板</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">url</span>: <span style="color:#ae81ff">/message/</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">weight</span>: <span style="color:#ae81ff">21</span>
</span></span></code></pre></div><h2 id="添加最近修改时间">添加最近修改时间<a hidden class="anchor" aria-hidden="true" href="#添加最近修改时间">#</a></h2>
<p>复制主题中的 <code>post_meta.html</code> 到 <code>layout/post_meta.html</code> 新增最近修改时间的内容，并修改发布时间的内容和国际化，</p>
<ol>
<li>在 <code>layout/post_meta.html</code> 输入以下代码</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>{{- $scratch := newScratch }}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{{- if not .Date.IsZero -}}
</span></span><span style="display:flex;"><span>  {{- $dateStr := .Date.Format (default &#34;January 2, 2006&#34; site.Params.DateFormat) -}}
</span></span><span style="display:flex;"><span>  {{- $translatedPublished := i18n &#34;published&#34; -}}
</span></span><span style="display:flex;"><span>  {{- $dateHTML := printf &#34;&lt;<span style="color:#f92672">span</span> <span style="color:#a6e22e">title</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;%s&#39;</span>&gt;%s&lt;/<span style="color:#f92672">span</span>&gt;&#34; (.Date) $dateStr -}}
</span></span><span style="display:flex;"><span>  {{- $scratch.Add &#34;meta&#34; (slice (printf &#34;%s %s&#34; $translatedPublished $dateHTML)) }}
</span></span><span style="display:flex;"><span>{{- end }}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{{- if not .Lastmod.IsZero -}}
</span></span><span style="display:flex;"><span>  {{- $lastmodStr := .Lastmod.Format (default &#34;January 2, 2006&#34; site.Params.DateFormat) -}}
</span></span><span style="display:flex;"><span>  {{- $translatedLastModified := i18n &#34;last_modified&#34; -}}
</span></span><span style="display:flex;"><span>  {{- $lastmodHTML := printf &#34;&lt;<span style="color:#f92672">span</span> <span style="color:#a6e22e">title</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;%s&#39;</span>&gt;%s&lt;/<span style="color:#f92672">span</span>&gt;&#34; (.Lastmod) $lastmodStr -}}
</span></span><span style="display:flex;"><span>  {{- $scratch.Add &#34;meta&#34; (slice (printf &#34;%s %s&#34; $translatedLastModified $lastmodHTML)) }}
</span></span><span style="display:flex;"><span>{{- end }}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{{- if (.Param &#34;ShowReadingTime&#34;) -}}
</span></span><span style="display:flex;"><span>{{- $scratch.Add &#34;meta&#34; (slice (i18n &#34;read_time&#34; .ReadingTime | default (printf &#34;%d min&#34; .ReadingTime))) }}
</span></span><span style="display:flex;"><span>{{- end }}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{{- if (.Param &#34;ShowWordCount&#34;) -}}
</span></span><span style="display:flex;"><span>{{- $scratch.Add &#34;meta&#34; (slice (i18n &#34;words&#34; .WordCount | default (printf &#34;%d words&#34; .WordCount))) }}
</span></span><span style="display:flex;"><span>{{- end }}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{{- if not (.Param &#34;hideAuthor&#34;) -}}
</span></span><span style="display:flex;"><span>{{- with (partial &#34;author.html&#34; .) }}
</span></span><span style="display:flex;"><span>{{- $scratch.Add &#34;meta&#34; (slice .) }}
</span></span><span style="display:flex;"><span>{{- end }}
</span></span><span style="display:flex;"><span>{{- end }}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{{- with ($scratch.Get &#34;meta&#34;) }}
</span></span><span style="display:flex;"><span>{{- delimit . &#34;&amp;nbsp;·&amp;nbsp;&#34; | safeHTML -}}
</span></span><span style="display:flex;"><span>{{- end -}}
</span></span></code></pre></div><ol start="2">
<li>在i18n文件夹的对应目录添加翻译</li>
<li>在 <code>hugo.yaml</code> 中新增配置 <code>frontmatte.lastmod: ['lastmod', ':git', 'date', 'publishDate']</code> 用于指定lastmod变量的赋值顺序</li>
</ol>
<h2 id="自定义域名">自定义域名<a hidden class="anchor" aria-hidden="true" href="#自定义域名">#</a></h2>
<p>首先需要有一个域名，在对应的域名服务商添加一条解析记录，解析类型：CNAME，解析值为 xxx.github.io (xxx替换为自己的Github用户名)</p>
<p>再添加文件 <code>static\CNAME</code> ,文件的内容为自定义的域名。没有这个文件，访问域名会出现404。</p>
<h1 id="界面显示优化">界面显示优化<a hidden class="anchor" aria-hidden="true" href="#界面显示优化">#</a></h1>
<h2 id="配置默认语言为中文">配置默认语言为中文<a hidden class="anchor" aria-hidden="true" href="#配置默认语言为中文">#</a></h2>
<p>在 <code>hugo.html</code> 文件中添加配置 <code>defaultContentLanguage: zh</code> 可以汉化大部分主题的内容</p>
<h2 id="日期格式显示优化">日期格式显示优化<a hidden class="anchor" aria-hidden="true" href="#日期格式显示优化">#</a></h2>
<p>在 <code>hugo.html</code> 文件中的Param节点下添加配置 <code>DateFormat: &quot;2006-01-02&quot;</code> (go的时间配置必须要用这个日期，yyyy-MM-dd不行)</p>
<h2 id="标签页添加词云">标签页添加词云<a hidden class="anchor" aria-hidden="true" href="#标签页添加词云">#</a></h2>
<p>参考资料： <a href="https://blog.xlap.top/post/tech/wordcloud4hugo/#%E9%A1%B9%E7%9B%AE%E5%9C%B0%E5%9D%80">https://blog.xlap.top/post/tech/wordcloud4hugo/#%E9%A1%B9%E7%9B%AE%E5%9C%B0%E5%9D%80</a>
感谢开源作者和大佬代码，我直接抄了</p>
<ol>
<li>下载 <code>wordcloud2.js</code> 拷贝到 <code>static/js/</code> 目录下，<a href="https://github.com/timdream/wordcloud2.js/blob/v1.1.1/src/wordcloud2.js">下载地址 </a></li>
<li>修改 <code>head.html</code> 引入js文件，新增以下代码：</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>{{- if eq .Section &#34;tags&#34;}}
</span></span><span style="display:flex;"><span>{{/* 标签云 */}}
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">link</span> <span style="color:#a6e22e">rel</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;stylesheet&#34;</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/css/word-cloud.css&#34;</span><span style="color:#960050;background-color:#1e0010">\</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">script</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/js/wordcloud2.js&#34;</span>&gt;&lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>{{- end }}
</span></span></code></pre></div><ol start="3">
<li>创建 <code>staic/css/word-cloud.css</code> 文件输入以下代码：</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-css" data-lang="css"><span style="display:flex;"><span>.<span style="color:#a6e22e">word-color</span>:<span style="color:#a6e22e">nth-child</span><span style="color:#f92672">(</span><span style="color:#f92672">7n</span> <span style="color:#f92672">+</span> <span style="color:#f92672">1</span><span style="color:#f92672">)</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">color</span>: rgb(<span style="color:#ae81ff">202</span>, <span style="color:#ae81ff">110</span>, <span style="color:#ae81ff">255</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">word-color</span>:<span style="color:#a6e22e">nth-child</span><span style="color:#f92672">(</span><span style="color:#f92672">7n</span> <span style="color:#f92672">+</span> <span style="color:#f92672">2</span><span style="color:#f92672">)</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">color</span>: rgb(<span style="color:#ae81ff">83</span>, <span style="color:#ae81ff">110</span>, <span style="color:#ae81ff">255</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">word-color</span>:<span style="color:#a6e22e">nth-child</span><span style="color:#f92672">(</span><span style="color:#f92672">7n</span> <span style="color:#f92672">+</span> <span style="color:#f92672">3</span><span style="color:#f92672">)</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">color</span>: rgb(<span style="color:#ae81ff">143</span>, <span style="color:#ae81ff">253</span>, <span style="color:#ae81ff">241</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">word-color</span>:<span style="color:#a6e22e">nth-child</span><span style="color:#f92672">(</span><span style="color:#f92672">7n</span> <span style="color:#f92672">+</span> <span style="color:#f92672">4</span><span style="color:#f92672">)</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">color</span>: rgb(<span style="color:#ae81ff">183</span>, <span style="color:#ae81ff">255</span>, <span style="color:#ae81ff">112</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">word-color</span>:<span style="color:#a6e22e">nth-child</span><span style="color:#f92672">(</span><span style="color:#f92672">7n</span> <span style="color:#f92672">+</span> <span style="color:#f92672">5</span><span style="color:#f92672">)</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">color</span>: rgb(<span style="color:#ae81ff">255</span>, <span style="color:#ae81ff">212</span>, <span style="color:#ae81ff">126</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">word-color</span>:<span style="color:#a6e22e">nth-child</span><span style="color:#f92672">(</span><span style="color:#f92672">7n</span> <span style="color:#f92672">+</span> <span style="color:#f92672">6</span><span style="color:#f92672">)</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">color</span>: rgb(<span style="color:#ae81ff">248</span>, <span style="color:#ae81ff">140</span>, <span style="color:#ae81ff">131</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">word-color</span>:<span style="color:#a6e22e">nth-child</span><span style="color:#f92672">(</span><span style="color:#f92672">7n</span> <span style="color:#f92672">+</span> <span style="color:#f92672">7</span><span style="color:#f92672">)</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">color</span>: rgb(<span style="color:#ae81ff">104</span>, <span style="color:#ae81ff">160</span>, <span style="color:#ae81ff">255</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  @<span style="color:#66d9ef">keyframes</span> <span style="color:#f92672">word</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">0</span><span style="color:#f92672">%</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">opacity</span>: <span style="color:#ae81ff">0.5</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">3</span><span style="color:#f92672">%</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">opacity</span>: <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">9</span><span style="color:#f92672">%</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">opacity</span>: <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">12</span><span style="color:#f92672">%</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">opacity</span>: <span style="color:#ae81ff">0.5</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">100</span><span style="color:#f92672">%</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">opacity</span>: <span style="color:#ae81ff">0.5</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">word-animate</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">animation-name</span>: word;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">animation-duration</span>: <span style="color:#ae81ff">20</span><span style="color:#66d9ef">s</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">animation-iteration-count</span>: <span style="color:#66d9ef">infinite</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">will-change</span>: <span style="color:#66d9ef">opacity</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">opacity</span>: <span style="color:#ae81ff">0.5</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">word-animate</span>:<span style="color:#a6e22e">nth-child</span><span style="color:#f92672">(</span><span style="color:#f92672">7n</span> <span style="color:#f92672">+</span> <span style="color:#f92672">1</span><span style="color:#f92672">)</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">animation-delay</span>: <span style="color:#ae81ff">0</span><span style="color:#66d9ef">s</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">word-animate</span>:<span style="color:#a6e22e">nth-child</span><span style="color:#f92672">(</span><span style="color:#f92672">7n</span> <span style="color:#f92672">+</span> <span style="color:#f92672">2</span><span style="color:#f92672">)</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">animation-delay</span>: <span style="color:#ae81ff">3</span><span style="color:#66d9ef">s</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">word-animate</span>:<span style="color:#a6e22e">nth-child</span><span style="color:#f92672">(</span><span style="color:#f92672">7n</span> <span style="color:#f92672">+</span> <span style="color:#f92672">3</span><span style="color:#f92672">)</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">animation-delay</span>: <span style="color:#ae81ff">6</span><span style="color:#66d9ef">s</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">word-animate</span>:<span style="color:#a6e22e">nth-child</span><span style="color:#f92672">(</span><span style="color:#f92672">7n</span> <span style="color:#f92672">+</span> <span style="color:#f92672">4</span><span style="color:#f92672">)</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">animation-delay</span>: <span style="color:#ae81ff">9</span><span style="color:#66d9ef">s</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">word-animate</span>:<span style="color:#a6e22e">nth-child</span><span style="color:#f92672">(</span><span style="color:#f92672">7n</span> <span style="color:#f92672">+</span> <span style="color:#f92672">5</span><span style="color:#f92672">)</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">animation-delay</span>: <span style="color:#ae81ff">12</span><span style="color:#66d9ef">s</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">word-animate</span>:<span style="color:#a6e22e">nth-child</span><span style="color:#f92672">(</span><span style="color:#f92672">7n</span> <span style="color:#f92672">+</span> <span style="color:#f92672">6</span><span style="color:#f92672">)</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">animation-delay</span>: <span style="color:#ae81ff">15</span><span style="color:#66d9ef">s</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">word-animate</span>:<span style="color:#a6e22e">nth-child</span><span style="color:#f92672">(</span><span style="color:#f92672">7n</span> <span style="color:#f92672">+</span> <span style="color:#f92672">7</span><span style="color:#f92672">)</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">animation-delay</span>: <span style="color:#ae81ff">18</span><span style="color:#66d9ef">s</span>;
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><ol start="4">
<li>创建 <code>layouts/_default/terms.html</code> 输入以下代码</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>{{- define &#34;main&#34; }}
</span></span><span style="display:flex;"><span>{{- if .Title }}
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">header</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;page-header&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">h1</span>&gt;{{ .Title }}&lt;/<span style="color:#f92672">h1</span>&gt;
</span></span><span style="display:flex;"><span>    {{- if .Description }}
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;post-description&#34;</span>&gt;
</span></span><span style="display:flex;"><span>        {{ .Description }}
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>    {{- end }}
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">header</span>&gt;
</span></span><span style="display:flex;"><span>{{- end }}
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">ul</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;terms-tags&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;sourrounding_div&#34;</span> <span style="color:#a6e22e">style</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;width:100%;height:100%;min-height: 500px;&#34;</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;tag-canvas&#34;</span>&gt;&lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">script</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/js/wordcloud2.js&#34;</span>&gt;&lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>    {{- range $key, $value := .Data.Terms.Alphabetical }}
</span></span><span style="display:flex;"><span>    {{ if eq &#34;&#34; ($.Scratch.Get &#34;tagsMap&#34;) }}
</span></span><span style="display:flex;"><span>    {{ $.Scratch.Set &#34;tagsMap&#34; (slice (dict .Name .Count)) }}
</span></span><span style="display:flex;"><span>    {{ else }}
</span></span><span style="display:flex;"><span>    {{ $.Scratch.Add &#34;tagsMap&#34; (slice (dict .Name .Count)) }}
</span></span><span style="display:flex;"><span>    {{ end }}
</span></span><span style="display:flex;"><span>    {{- end }}
</span></span><span style="display:flex;"><span>    {{ $result := ($.Scratch.Get &#34;tagsMap&#34;)}}
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">span</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;tag-temp&#34;</span> <span style="color:#a6e22e">style</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;display:none&#34;</span>&gt;{{$result | jsonify }}&lt;/<span style="color:#f92672">span</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//因为前期每个标签值比较小，帮X一个系数
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">XISHU</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">20</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//为了动态宽度
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">div</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">querySelector</span>(<span style="color:#e6db74">&#34;#sourrounding_div&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">canvas</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">querySelector</span>(<span style="color:#e6db74">&#34;#tag-canvas&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">canvas</span>.<span style="color:#a6e22e">style</span>.<span style="color:#a6e22e">width</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">div</span>.<span style="color:#a6e22e">offsetWidth</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;px&#39;</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">canvas</span>.<span style="color:#a6e22e">style</span>.<span style="color:#a6e22e">height</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">div</span>.<span style="color:#a6e22e">offsetHeight</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;px&#39;</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">wordFreqData</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">querySelector</span>(<span style="color:#e6db74">&#34;#tag-temp&#34;</span>).<span style="color:#a6e22e">innerHTML</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">jsonObj</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">parse</span>(<span style="color:#a6e22e">wordFreqData</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">arr</span> <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">jsonObj</span>.<span style="color:#a6e22e">forEach</span>(<span style="color:#a6e22e">element</span> =&gt; {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">key</span> <span style="color:#f92672">=</span> Object.<span style="color:#a6e22e">keys</span>(<span style="color:#a6e22e">element</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">itemArr</span> <span style="color:#f92672">=</span> [<span style="color:#a6e22e">key</span>[<span style="color:#ae81ff">0</span>], <span style="color:#a6e22e">element</span>[<span style="color:#a6e22e">key</span>] <span style="color:#f92672">*</span> <span style="color:#a6e22e">XISHU</span>];
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">arr</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">itemArr</span>);
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//获取当前是暗色还是浅色
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">isDark</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">body</span>.<span style="color:#a6e22e">className</span>.<span style="color:#a6e22e">includes</span>(<span style="color:#e6db74">&#34;dark&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">WordCloud</span>(<span style="color:#a6e22e">canvas</span>, {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;list&#34;</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">arr</span>,<span style="color:#75715e">//或者[[&#39;各位观众&#39;,45],[&#39;词云&#39;, 21],[&#39;来啦!!!&#39;,13]],只要格式满足这样都可以
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#e6db74">&#34;shape&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;cardioid&#34;</span>, <span style="color:#75715e">//形状 circle (default), cardioid (心型), diamond, square, triangle-forward, triangle, pentagon, and star.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#e6db74">&#34;gridSize&#34;</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">20</span>, <span style="color:#75715e">// 密集程度 数字越小越密集
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#e6db74">&#34;weightFactor&#34;</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>, <span style="color:#75715e">// 字体大小=原始大小*weightFactor
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#e6db74">&#34;fontWeight&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;normal&#39;</span>, <span style="color:#75715e">//字体粗细
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#e6db74">&#34;fontFamily&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Times, serif&#39;</span>, <span style="color:#75715e">// 字体
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#e6db74">&#34;color&#34;</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">isDark</span> <span style="color:#f92672">?</span> <span style="color:#e6db74">&#39;random-light&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;random-dark&#39;</span>, <span style="color:#75715e">// 字体颜色 &#39;random-dark&#39; 或者 &#39;random-light&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#e6db74">&#34;backgroundColor&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;none&#39;</span>, <span style="color:#75715e">// 背景颜色
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#e6db74">&#34;classes&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;tag-cloud-item word-color&#34;</span>, <span style="color:#75715e">//用于点击事件
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        });
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">canvas</span>.<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#39;wordcloudstop&#39;</span>, <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">e</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">//动画
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#a6e22e">setTimeout</span>(() =&gt; {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">els</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">querySelectorAll</span>(<span style="color:#e6db74">&#34;.word-color&#34;</span>);
</span></span><span style="display:flex;"><span>                Array.<span style="color:#a6e22e">from</span>(<span style="color:#a6e22e">els</span>).<span style="color:#a6e22e">forEach</span>((<span style="color:#a6e22e">el</span>) =&gt; {
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;动画&#39;</span>, <span style="color:#a6e22e">el</span>)
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">el</span>.<span style="color:#a6e22e">classList</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">&#34;word-animate&#34;</span>)
</span></span><span style="display:flex;"><span>                })
</span></span><span style="display:flex;"><span>            }, <span style="color:#ae81ff">2000</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">//点击
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            document.<span style="color:#a6e22e">querySelectorAll</span>(<span style="color:#e6db74">&#39;.tag-cloud-item&#39;</span>).<span style="color:#a6e22e">forEach</span>(<span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">element</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">text</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">element</span>.<span style="color:#a6e22e">innerHTML</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">element</span>.<span style="color:#a6e22e">innerHTML</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">`&lt;a href=&#34;/tags/</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">text</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34; style=&#34;color: inherit;&#34;&gt;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">text</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&lt;/a&gt;`</span>;
</span></span><span style="display:flex;"><span>            });
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">ul</span>&gt;
</span></span><span style="display:flex;"><span>{{- end }}{{/* end main */ -}}
</span></span></code></pre></div><p>参数可以自行修改，可以关注 <code>shape</code> 和 <code>gridSize</code> 等属性</p>
<h2 id="url管理">url管理<a hidden class="anchor" aria-hidden="true" href="#url管理">#</a></h2>
<p>在 <code>hugo.yaml</code> 中添加  <code>permalinks.posts: &quot;/:year/:month/:day/:slug/&quot;</code>
在 <code>archetypes/default.md</code> 中添加 <code>slug: </code>
在每一篇博文中，自己管理slug</p>
<h2 id="为文章添加过期提示">为文章添加过期提示<a hidden class="anchor" aria-hidden="true" href="#为文章添加过期提示">#</a></h2>
<ol>
<li>修改 <code>single.html</code> 文件中，在post-meta后面新增一个div块来展示该信息，代码如下：</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>    {{- if not (.Param &#34;hideMeta&#34;) }}
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;post-meta&#34;</span>&gt;
</span></span><span style="display:flex;"><span>      {{- partial &#34;post_meta.html&#34; . -}}
</span></span><span style="display:flex;"><span>      {{- partial &#34;translation_list.html&#34; . -}}
</span></span><span style="display:flex;"><span>      {{- partial &#34;edit_post.html&#34; . -}}
</span></span><span style="display:flex;"><span>      {{- partial &#34;post_canonical.html&#34; . -}}
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>    {{- end }}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">&lt;!-- 添加提示框逻辑 --&gt;</span>
</span></span><span style="display:flex;"><span>    {{- $lastmod := .Lastmod }}
</span></span><span style="display:flex;"><span>    {{- $now := now }}
</span></span><span style="display:flex;"><span>    {{- $duration := $now.Sub $lastmod }}
</span></span><span style="display:flex;"><span>    {{- $daysAgo := $duration.Hours }}
</span></span><span style="display:flex;"><span>    {{- if ge $daysAgo (math.Mul 180 24) }}
</span></span><span style="display:flex;"><span>    {{- if eq site.Params.defaultTheme `dark` -}}
</span></span><span style="display:flex;"><span>    {{- $isDark := &#34;.dark&#34; }}
</span></span><span style="display:flex;"><span>    {{- end -}}
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;post-age-hint&#34;</span>&gt;
</span></span><span style="display:flex;"><span>      这篇文章最后更新已经超过180天了，内容可能已经过时。
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">div</span>&gt;
</span></span></code></pre></div><ol start="2">
<li>为该div块定制样式，在 <code>assets/css/extended</code> 目录下新增 <code>custom.css</code> 文件，输入以下代码，颜色可以随自己喜欢调整</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-css" data-lang="css"><span style="display:flex;"><span>:<span style="color:#a6e22e">root</span> {
</span></span><span style="display:flex;"><span>    --post-age-hint-bg-color: <span style="color:#ae81ff">#d4d4d4</span>ac;
</span></span><span style="display:flex;"><span>    --post-age-hint-color: <span style="color:#ae81ff">#26b3fe</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>.<span style="color:#a6e22e">dark</span> {
</span></span><span style="display:flex;"><span>    --post-age-hint-bg-color: <span style="color:#ae81ff">#6d6c6c</span>ac;
</span></span><span style="display:flex;"><span>    --post-age-hint-color: <span style="color:#ae81ff">#ff7723</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>.<span style="color:#a6e22e">post-age-hint</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">background-color</span>: <span style="color:#a6e22e">var</span>(<span style="color:#f92672">--</span>post<span style="color:#f92672">-</span>age<span style="color:#f92672">-</span>hint<span style="color:#f92672">-</span>bg<span style="color:#f92672">-</span><span style="color:#66d9ef">color</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/* 深灰色背景 */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">color</span>: <span style="color:#a6e22e">var</span>(<span style="color:#f92672">--</span>post<span style="color:#f92672">-</span>age<span style="color:#f92672">-</span>hint<span style="color:#f92672">-</span><span style="color:#66d9ef">color</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/* 浅灰色文字 */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">padding</span>: <span style="color:#ae81ff">10</span><span style="color:#66d9ef">px</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">border-left</span>: <span style="color:#ae81ff">3</span><span style="color:#66d9ef">px</span> <span style="color:#66d9ef">solid</span> <span style="color:#ae81ff">#ff6666</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/* 红色边框，醒目但不刺眼 */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">margin</span>: <span style="color:#ae81ff">20</span><span style="color:#66d9ef">px</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">border-radius</span>: <span style="color:#ae81ff">5</span><span style="color:#66d9ef">px</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/* 圆角边框 */</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/* 添加一个过渡效果，鼠标悬停时改变边框颜色 */</span>
</span></span><span style="display:flex;"><span>.<span style="color:#a6e22e">post-age-hint</span>:<span style="color:#a6e22e">hover</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">border-color</span>: <span style="color:#ae81ff">#ff9999</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>这段代码中，定义了两个变量用于适配不同主题，默认的白色主题，会使用root中的两个颜色，当切换到dark时，会使用.dark中定义的颜色</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://zanksc.github.io/tags/hugo/">Hugo</a></li>
      <li><a href="https://zanksc.github.io/tags/papermod/">PaperMod</a></li>
      <li><a href="https://zanksc.github.io/tags/%E5%BB%BA%E7%AB%99/">建站</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://zanksc.github.io/2024/01/01/hugo-3/">
    <span class="title">« 上一页</span>
    <br>
    <span>【Hugo】体验篇：Obsidian写作</span>
  </a>
  <a class="next" href="https://zanksc.github.io/2024/01/01/hugo-1/">
    <span class="title">下一页 »</span>
    <br>
    <span>【Hugo】基础篇：个人博客搭建</span>
  </a>
</nav>

  </footer><div class="comments-title" id="tw-comment-title">
    <p class="x-comments-title">欢迎来到评论区</p>
    <p style="font-size: 1rem">感谢您的耐心阅读！如需交流，请留个评论吧！ </p>
</div>



<div>
    
    <div id="tcomment"></div>
    <script src="https://cdn.jsdelivr.net/npm/twikoo@1.6.40/dist/twikoo.all.min.js"></script>
    <script>
    twikoo.init({
      envId: 'https://zanks-twikoo.netlify.app/.netlify/functions/twikoo', 
      el: '#tcomment', 
      
      
      
    })
    </script>
</div>

</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2024 <a href="https://zanksc.github.io/">乱话三千</a></span> · 
    
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = '复制';

        function copyingDone() {
            copybutton.innerHTML = '已复制！';
            setTimeout(() => {
                copybutton.innerHTML = '复制';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script></body>

</html>
